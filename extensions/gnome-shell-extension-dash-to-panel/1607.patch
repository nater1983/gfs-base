From c802a62f340afe17765dbb54e3c8198f4687d1b7 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Tue, 5 Apr 2022 22:54:42 +0200
Subject: [PATCH 01/62] convert behavior tab to adw preferences page

---
 SettingsBehavior.ui | 189 ++++++++++++++++++++++++++++++++++++++++++++
 prefs.js            |  50 ++++++++----
 2 files changed, 225 insertions(+), 14 deletions(-)
 create mode 100644 SettingsBehavior.ui

diff --git a/SettingsBehavior.ui b/SettingsBehavior.ui
new file mode 100644
index 00000000..39c663a7
--- /dev/null
+++ b/SettingsBehavior.ui
@@ -0,0 +1,189 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+  <object class="AdwPreferencesPage" id="behavior">
+
+    <!-- group applications -->
+    <child>
+      <object class="AdwPreferencesGroup" id="behavior_group_applications">
+        <property name="title">Applications</property>
+        
+        <child>
+          <object class="AdwActionRow">
+            <property name="title">Show favorite applications</property>
+            <child>
+              <object class="GtkSwitch" id="show_favorite_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title">Show running applications</property>
+            <child>
+              <object class="GtkSwitch" id="show_runnning_apps_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title">Show favorite applications on secondary panels</property>
+            <child>
+              <object class="GtkSwitch" id="multimon_multi_show_favorites_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Show favorite applications</property>
+            <property name="subtitle">Top Bar &gt; Show App Menu must be enabled in Tweak Tool</property>
+            <child>
+              <object class="GtkSwitch" id="show_appmenu_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+        
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Ungroup applications</property>
+            <child>
+              <object class="GtkButton" id="show_group_apps_options_button">
+                <property name="receives_default">True</property>
+                <property name="valign">center</property>
+                <child>
+                  <object class="GtkImage" id="image_show_group_apps_options">
+                    <property name="icon_name">emblem-system-symbolic</property>
+                  </object>
+                </child>
+                <style>
+                  <class name="circular"/>
+                </style>
+              </object>
+            </child>
+            <child>
+              <object class="GtkSwitch" id="group_apps_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <!-- group hover -->
+    <child>
+      <object class="AdwPreferencesGroup" id="behavior_group_hover">
+        <property name="title">Hover</property>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Show window previews on hover</property>
+            <child>
+              <object class="GtkButton" id="show_window_previews_button">
+                <property name="receives_default">True</property>
+                <property name="valign">center</property>
+                <child>
+                  <object class="GtkImage" id="image_window_previews_options">
+                    <property name="icon_name">emblem-system-symbolic</property>
+                  </object>
+                </child>
+                <style>
+                  <class name="circular"/>
+                </style>
+              </object>
+            </child>
+            <child>
+              <object class="GtkSwitch" id="show_window_previews_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Show tooltip on hover</property>
+            <child>
+              <object class="GtkSwitch" id="show_tooltip_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <!-- group isolate -->
+    <child>
+      <object class="AdwPreferencesGroup" id="behavior_group_isolate">
+        <property name="title">Isolate</property>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Isolate Workspaces</property>
+            <child>
+              <object class="GtkSwitch" id="isolate_workspaces_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Isolate monitors</property>
+            <child>
+              <object class="GtkSwitch" id="multimon_multi_isolate_monitor_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <!-- group overview -->
+    <child>
+      <object class="AdwPreferencesGroup" id="behavior_group_overview">
+        <property name="title">Overview</property>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Click empty space to close overview</property>
+            <child>
+              <object class="GtkSwitch" id="clicktoexit_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Disable show overview on startup</property>
+            <child>
+              <object class="GtkSwitch" id="hide_overview_on_startup_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+  </object>
+</interface>
\ No newline at end of file
diff --git a/prefs.js b/prefs.js
index a250a4f5..aca185bc 100644
--- a/prefs.js
+++ b/prefs.js
@@ -25,6 +25,7 @@ const Gio = imports.gi.Gio;
 const GLib = imports.gi.GLib;
 const GObject = imports.gi.GObject;
 const Gtk = imports.gi.Gtk;
+const Adw = imports.gi.Adw;
 const Gdk = imports.gi.Gdk;
 const Mainloop = imports.mainloop;
 
@@ -2460,20 +2461,41 @@ function init() {
 
 function fillPreferencesWindow(window) {
     window.set_default_size(680, 740);
-
-    let preferences = new Preferences();
-    let box = new Gtk.Box({orientation: Gtk.Orientation.VERTICAL});
-
-    // dummy page to prevent 'Extension did not provide any UI'
-    // error until we migrate to Adw
-    let dummyPage = new imports.gi.Adw.PreferencesPage()
-
-    box.append(new imports.gi.Adw.HeaderBar);
-    window.add(dummyPage);
-    window.visible_page = dummyPage
-
-    box.append(preferences.notebook);
-    window.set_content(box);
+    
+    let pagePosition = new Adw.PreferencesPage();
+    pagePosition.set_title("Position");
+    pagePosition.set_icon_name("document-properties");
+    window.add(pagePosition);
+
+    let pageStyle = new Adw.PreferencesPage();
+    pageStyle.set_title("Style");
+    pageStyle.set_icon_name("document-properties");
+    window.add(pageStyle);
+
+    builder = new Gtk.Builder();
+    builder.set_scope(new BuilderScope());
+    builder.set_translation_domain(Me.metadata['gettext-domain']);
+    builder.add_from_file(Me.path + '/SettingsBehavior.ui');
+    let pageBehavior = builder.get_object('behavior');
+
+    pageBehavior.set_title("Behavior");
+    pageBehavior.set_icon_name("document-properties");
+    window.add(pageBehavior);
+
+    let pageAction = new Adw.PreferencesPage();
+    pageAction.set_title("Action");
+    pageAction.set_icon_name("document-properties");
+    window.add(pageAction);
+
+    let pageFineTune = new Adw.PreferencesPage();
+    pageFineTune.set_title("Fine-Tune");
+    pageFineTune.set_icon_name("document-properties");
+    window.add(pageFineTune);
+
+    let pageAbout = new Adw.PreferencesPage();
+    pageAbout.set_title("About");
+    pageAbout.set_icon_name("document-properties");
+    window.add(pageAbout);
 }
 
 function buildPrefsWidget() {

From 294bea9236aac9169caad5902ba721234d1403b3 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 00:46:48 +0200
Subject: [PATCH 02/62] convert style tab to adw preferences page

---
 SettingsBehavior.ui |  14 +-
 SettingsStyle.ui    | 353 ++++++++++++++++++++++++++++++++++++++++++++
 prefs.js            |  17 +--
 3 files changed, 368 insertions(+), 16 deletions(-)
 create mode 100644 SettingsStyle.ui

diff --git a/SettingsBehavior.ui b/SettingsBehavior.ui
index 39c663a7..d5dbf951 100644
--- a/SettingsBehavior.ui
+++ b/SettingsBehavior.ui
@@ -2,15 +2,17 @@
 <interface>
   <requires lib="gtk" version="4.0"/>
   <object class="AdwPreferencesPage" id="behavior">
+    <property name="title">Behavior</property>
+    <property name="icon_name">document-properties</property>
 
     <!-- group applications -->
     <child>
       <object class="AdwPreferencesGroup" id="behavior_group_applications">
-        <property name="title">Applications</property>
+        <property name="title" translatable="yes">Applications</property>
         
         <child>
           <object class="AdwActionRow">
-            <property name="title">Show favorite applications</property>
+            <property name="title" translatable="yes">Show favorite applications</property>
             <child>
               <object class="GtkSwitch" id="show_favorite_switch">
                 <property name="valign">center</property>
@@ -21,7 +23,7 @@
 
         <child>
           <object class="AdwActionRow">
-            <property name="title">Show running applications</property>
+            <property name="title" translatable="yes">Show running applications</property>
             <child>
               <object class="GtkSwitch" id="show_runnning_apps_switch">
                 <property name="valign">center</property>
@@ -32,7 +34,7 @@
 
         <child>
           <object class="AdwActionRow">
-            <property name="title">Show favorite applications on secondary panels</property>
+            <property name="title" translatable="yes">Show favorite applications on secondary panels</property>
             <child>
               <object class="GtkSwitch" id="multimon_multi_show_favorites_switch">
                 <property name="valign">center</property>
@@ -128,7 +130,7 @@
     <!-- group isolate -->
     <child>
       <object class="AdwPreferencesGroup" id="behavior_group_isolate">
-        <property name="title">Isolate</property>
+        <property name="title" translatable="yes">Isolate</property>
 
         <child>
           <object class="AdwActionRow">
@@ -158,7 +160,7 @@
     <!-- group overview -->
     <child>
       <object class="AdwPreferencesGroup" id="behavior_group_overview">
-        <property name="title">Overview</property>
+        <property name="title" translatable="yes">Overview</property>
 
         <child>
           <object class="AdwActionRow">
diff --git a/SettingsStyle.ui b/SettingsStyle.ui
new file mode 100644
index 00000000..5a27e3f4
--- /dev/null
+++ b/SettingsStyle.ui
@@ -0,0 +1,353 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="appicon_margin_adjustment">
+    <property name="lower">0.33</property>
+    <property name="upper">1</property>
+    <property name="step_increment">0.01</property>
+    <property name="page_increment">0.1</property>
+  </object>
+
+  <object class="GtkAdjustment" id="appicon_padding_adjustment">
+    <property name="lower">0.33</property>
+    <property name="upper">1</property>
+    <property name="step_increment">0.01</property>
+    <property name="page_increment">0.1</property>
+  </object>
+
+  <object class="GtkAdjustment" id="trans_opacity_adjustment">
+    <property name="upper">100</property>
+    <property name="step_increment">5</property>
+    <property name="page_increment">10</property>
+  </object>
+
+  <object class="GtkAdjustment" id="trans_gradient_opacity1_adjustment">
+    <property name="upper">100</property>
+    <property name="step_increment">5</property>
+    <property name="page_increment">10</property>
+  </object>
+
+  <object class="GtkAdjustment" id="trans_gradient_opacity2_adjustment">
+    <property name="upper">100</property>
+    <property name="step_increment">5</property>
+    <property name="page_increment">10</property>
+  </object>
+
+  <object class="AdwPreferencesPage" id="style">
+    <property name="title">Style</property>
+    <property name="icon_name">document-properties</property>
+
+    <!-- group app icon style -->
+    <child>
+      <object class="AdwPreferencesGroup" id="style_group_app_icon_style">
+        <property name="title" translatable="yes">AppIcon style</property>
+        
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">App Icon Margin</property>
+            <property name="subtitle" translatable="yes">(default is 8)</property>
+            <child>
+              <object class="GtkScale" id="appicon_margin_scale">
+                <property name="valign">baseline</property>
+                <property name="hexpand">True</property>
+                <property name="adjustment">appicon_margin_adjustment</property>
+                <property name="round_digits">0</property>
+                <property name="digits">0</property>
+                <property name="value_pos">right</property>
+                <property name="draw_value">True</property>
+                <signal name="value-changed" handler="appicon_margin_scale_value_changed_cb" swapped="no"/>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">App Icon Padding</property>
+            <property name="subtitle" translatable="yes">(default is 4)</property>
+            <child>
+              <object class="GtkScale" id="appicon_padding_scale">
+                <property name="valign">baseline</property>
+                <property name="hexpand">True</property>
+                <property name="adjustment">appicon_padding_adjustment</property>
+                <property name="round_digits">0</property>
+                <property name="digits">0</property>
+                <property name="value_pos">right</property>
+                <property name="draw_value">True</property>
+                <signal name="value-changed" handler="appicon_padding_scale_value_changed_cb" swapped="no"/>
+                <layout>
+                  <property name="row">0</property>
+                  <property name="column">1</property>
+                </layout>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Animate hovering app icons</property>
+            <child>
+              <object class="GtkButton" id="animate_appicon_hover_button">
+                <property name="receives_default">True</property>
+                <property name="valign">center</property>
+                <child>
+                  <object class="GtkImage" id="animate_appicon_hover_options_image">
+                    <property name="can_focus">False</property>
+                    <property name="icon_name">emblem-system-symbolic</property>
+                  </object>
+                </child>
+                <style>
+                  <class name="circular"/>
+                </style>
+              </object>
+            </child>
+            <child>
+              <object class="GtkSwitch" id="animate_appicon_hover_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <!-- group running indicator -->
+    <child>
+      <object class="AdwPreferencesGroup" id="style_group_running_indicator">
+        <property name="title" translatable="yes">Running indicator</property>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Running indicator position</property>
+            <child>
+              <object class="GtkToggleButton" id="dots_bottom_button">
+                <property name="label" translatable="yes">Bottom</property>
+                <property name="valign">center</property>
+                <signal name="toggled" handler="dots_bottom_button_toggled_cb" swapped="no"/>
+              </object>
+            </child>
+            <child>
+              <object class="GtkToggleButton" id="dots_top_button">
+                <property name="label" translatable="yes">Top</property>
+                <property name="valign">center</property>
+                <property name="group">dots_bottom_button</property>
+                <signal name="toggled" handler="dots_top_button_toggled_cb" swapped="no"/>
+              </object>
+            </child>
+            <child>
+              <object class="GtkToggleButton" id="dots_left_button">
+                <property name="label" translatable="yes">Left</property>
+                <property name="valign">center</property>
+                <property name="group">dots_bottom_button</property>
+                <signal name="toggled" handler="dots_left_button_toggled_cb" swapped="no"/>
+              </object>
+            </child>
+            <child>
+              <object class="GtkToggleButton" id="dots_right_button">
+                <property name="label" translatable="yes">Right</property>
+                <property name="valign">center</property>
+                <property name="group">dots_bottom_button</property>
+                <signal name="toggled" handler="dots_right_button_toggled_cb" swapped="no"/>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Running indicator style (Focused app)</property>
+            <child>
+              <object class="GtkButton" id="dot_style_options_button">
+                <property name="valign">center</property>
+                <child>
+                  <object class="GtkImage" id="dot_style_image">
+                    <property name="icon_name">emblem-system-symbolic</property>
+                  </object>
+                </child>
+                <style>
+                  <class name="circular"/>
+                </style>
+              </object>
+            </child>
+            <child>
+              <object class="GtkComboBoxText" id="dot_style_focused_combo">
+                <property name="valign">center</property>
+                <items>
+                  <item id="DOTS" translatable="yes">Dots</item>
+                  <item id="SQUARES" translatable="yes">Squares</item>
+                  <item id="DASHES" translatable="yes">Dashes</item>
+                  <item id="SEGMENTED" translatable="yes">Segmented</item>
+                  <item id="SOLID" translatable="yes">Solid</item>
+                  <item id="CILIORA" translatable="yes">Ciliora</item>
+                  <item id="METRO" translatable="yes">Metro</item>
+                </items>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Running indicator style (Unfocused apps)</property>
+            <child>
+              <object class="GtkComboBoxText" id="dot_style_unfocused_combo">
+                <property name="valign">center</property>
+                <items>
+                  <item id="DOTS" translatable="yes">Dots</item>
+                  <item id="SQUARES" translatable="yes">Squares</item>
+                  <item id="DASHES" translatable="yes">Dashes</item>
+                  <item id="SEGMENTED" translatable="yes">Segmented</item>
+                  <item id="SOLID" translatable="yes">Solid</item>
+                  <item id="CILIORA" translatable="yes">Ciliora</item>
+                  <item id="METRO" translatable="yes">Metro</item>
+                </items>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <!-- group dynamic trans -->
+    <child>
+      <object class="AdwPreferencesGroup" id="style_group_dynamic_trans">
+        <property name="title" translatable="yes">Panel style</property>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Override panel theme background color</property>
+            <child>
+              <object class="GtkColorButton" id="trans_bg_color_colorbutton">
+                <property name="valign">center</property>
+              </object>
+            </child>
+            <child>
+              <object class="GtkSwitch" id="trans_bg_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <!-- group dynamic trans2 -->
+    <child>
+      <object class="AdwPreferencesGroup" id="style_group_dynamic_trans2">
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Override panel theme background opacity</property>
+            <child>
+              <object class="GtkSwitch" id="trans_opacity_override_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Panel background opacity (%)</property>
+            <child>
+              <object class="GtkSpinButton" id="trans_opacity_spinbutton">
+                <property name="valign">center</property>
+                <property name="text" translatable="yes">0</property>
+                <property name="adjustment">trans_opacity_adjustment</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Dynamic background opacity</property>
+            <property name="subtitle" translatable="yes">Change opacity when a window gets close to the panel</property>
+            <child>
+              <object class="GtkButton" id="trans_dyn_options_button">
+                <property name="receives_default">True</property>
+                <property name="valign">center</property>
+                <child>
+                  <object class="GtkImage" id="image_trans_dyn_options">
+                    <property name="can_focus">False</property>
+                    <property name="icon_name">emblem-system-symbolic</property>
+                  </object>
+                </child>
+                <style>
+                  <class name="circular"/>
+                </style>
+              </object>
+            </child>
+            <child>
+              <object class="GtkSwitch" id="trans_dyn_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <!-- group dynamic trans3 -->
+    <child>
+      <object class="AdwPreferencesGroup" id="style_group_dynamic_trans3">
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Override panel theme gradient</property>
+            <child>
+              <object class="GtkSwitch" id="trans_gradient_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Gradient top color and opacity (%)</property>
+            <child>
+              <object class="GtkColorButton" id="trans_gradient_color1_colorbutton">
+                <property name="receives_default">True</property>
+                <property name="valign">center</property>
+              </object>
+            </child>
+            <child>
+              <object class="GtkSpinButton" id="trans_gradient_color1_spinbutton">
+                <property name="valign">center</property>
+                <property name="text" translatable="yes">0</property>
+                <property name="adjustment">trans_gradient_opacity1_adjustment</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Gradient bottom color and opacity (%)</property>
+            <child>
+              <object class="GtkColorButton" id="trans_gradient_color2_colorbutton">
+                <property name="receives_default">True</property>
+                <property name="valign">center</property>
+              </object>
+            </child>
+            <child>
+              <object class="GtkSpinButton" id="trans_gradient_color2_spinbutton">
+                <property name="valign">center</property>
+                <property name="text" translatable="yes">0</property>
+                <property name="adjustment">trans_gradient_opacity2_adjustment</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+  </object>
+</interface>
\ No newline at end of file
diff --git a/prefs.js b/prefs.js
index aca185bc..df95ccbb 100644
--- a/prefs.js
+++ b/prefs.js
@@ -2461,25 +2461,22 @@ function init() {
 
 function fillPreferencesWindow(window) {
     window.set_default_size(680, 740);
-    
+
+    builder = new Gtk.Builder();
+    builder.set_scope(new BuilderScope());
+    builder.set_translation_domain(Me.metadata['gettext-domain']);
+
     let pagePosition = new Adw.PreferencesPage();
     pagePosition.set_title("Position");
     pagePosition.set_icon_name("document-properties");
     window.add(pagePosition);
 
-    let pageStyle = new Adw.PreferencesPage();
-    pageStyle.set_title("Style");
-    pageStyle.set_icon_name("document-properties");
+    builder.add_from_file(Me.path + '/SettingsStyle.ui');
+    let pageStyle = builder.get_object('style');
     window.add(pageStyle);
 
-    builder = new Gtk.Builder();
-    builder.set_scope(new BuilderScope());
-    builder.set_translation_domain(Me.metadata['gettext-domain']);
     builder.add_from_file(Me.path + '/SettingsBehavior.ui');
     let pageBehavior = builder.get_object('behavior');
-
-    pageBehavior.set_title("Behavior");
-    pageBehavior.set_icon_name("document-properties");
     window.add(pageBehavior);
 
     let pageAction = new Adw.PreferencesPage();

From 35412af21613c3175f38cb9f7a794e0bddb70fba Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 01:10:33 +0200
Subject: [PATCH 03/62] convert action tab to adw preferences page

---
 SettingsAction.ui | 172 ++++++++++++++++++++++++++++++++++++++++++++++
 prefs.js          |   5 +-
 2 files changed, 174 insertions(+), 3 deletions(-)
 create mode 100644 SettingsAction.ui

diff --git a/SettingsAction.ui b/SettingsAction.ui
new file mode 100644
index 00000000..3b2ec4c6
--- /dev/null
+++ b/SettingsAction.ui
@@ -0,0 +1,172 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="AdwPreferencesPage" id="action">
+    <property name="title">Action</property>
+    <property name="icon_name">document-properties</property>
+
+    <!-- group click action -->
+    <child>
+      <object class="AdwPreferencesGroup" id="action_group_click_action">
+        <property name="title" translatable="yes">Click action</property>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Click action</property>
+            <property name="subtitle" translatable="yes">Behaviour when clicking on the icon of a running application.</property>
+            <child>
+              <object class="GtkButton" id="middle_click_options_button">
+                <property name="receives_default">True</property>
+                <property name="valign">center</property>
+                <child>
+                  <object class="GtkImage" id="middle_click_image">
+                    <property name="can_focus">False</property>
+                    <property name="icon_name">emblem-system-symbolic</property>
+                  </object>
+                </child>
+                <style>
+                  <class name="circular"/>
+                </style>
+              </object>
+            </child>
+            <child>
+              <object class="GtkComboBoxText" id="click_action_combo">
+                <property name="can_focus">False</property>
+                <property name="valign">center</property>
+                <items>
+                  <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
+                  <item id="CYCLE" translatable="yes">Cycle through windows</item>
+                  <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
+                  <item id="MINIMIZE" translatable="yes">Toggle windows</item>
+                  <item id="RAISE" translatable="yes">Raise windows</item>
+                  <item id="LAUNCH" translatable="yes">Launch new instance</item>
+                </items>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <!-- group scroll action -->
+    <child>
+      <object class="AdwPreferencesGroup" id="action_group_scroll_action">
+        <property name="title" translatable="yes">Scroll action</property>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Scroll panel action</property>
+            <property name="subtitle" translatable="yes">Behavior when mouse scrolling over the panel.</property>
+            <child>
+              <object class="GtkButton" id="scroll_panel_options_button">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="receives_default">True</property>
+                <property name="halign">end</property>
+                <property name="valign">center</property>
+                <child>
+                  <object class="GtkImage" id="scroll_panel_options_button_image">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="icon_name">emblem-system-symbolic</property>
+                  </object>
+                </child>
+                <style>
+                  <class name="circular"/>
+                </style>
+              </object>
+            </child>
+            <child>
+              <object class="GtkComboBoxText" id="scroll_panel_combo">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="valign">center</property>
+                <property name="hexpand">True</property>
+                <items>
+                  <item id="NOTHING" translatable="yes">Do nothing</item>
+                  <item id="SWITCH_WORKSPACE" translatable="yes">Switch workspace</item>
+                  <item id="CYCLE_WINDOWS" translatable="yes">Cycle windows</item>
+                  <item id="CHANGE_VOLUME" translatable="yes">Change volume</item>
+                </items>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Scroll icon action</property>
+            <property name="subtitle" translatable="yes">Behavior when mouse scrolling over an application icon.</property>
+            <child>
+              <object class="GtkButton" id="scroll_icon_options_button">
+                <property name="receives_default">True</property>
+                <property name="valign">center</property>
+                <child>
+                  <object class="GtkImage" id="scroll_icon_options_button_image">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="icon_name">emblem-system-symbolic</property>
+                  </object>
+                </child>
+                <style>
+                  <class name="circular"/>
+                </style>
+              </object>
+            </child>
+            <child>
+              <object class="GtkComboBoxText" id="scroll_icon_combo">
+                <property name="can_focus">False</property>
+                <property name="valign">center</property>
+                <property name="hexpand">True</property>
+                <items>
+                  <item id="NOTHING" translatable="yes">Do nothing</item>
+                  <item id="CYCLE_WINDOWS" translatable="yes">Cycle windows</item>
+                  <item id="PASS_THROUGH" translatable="yes">Same as panel</item>
+                </items>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <!-- group hotkey -->
+    <child>
+      <object class="AdwPreferencesGroup" id="action_group_hotkry">
+        <property name="title" translatable="yes">Hotkey overlay</property>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Use hotkeys to activate apps</property>
+            <property name="subtitle" translatable="yes">Enable Super+(0-9) as shortcuts to activate apps. It can also be used together with Shift and Ctrl.</property>
+            <child>
+              <object class="GtkButton" id="overlay_button">
+                <property name="receives_default">True</property>
+                <property name="valign">center</property>
+                <child>
+                  <object class="GtkImage" id="image_overlay">
+                    <property name="can_focus">False</property>
+                    <property name="icon_name">emblem-system-symbolic</property>
+                  </object>
+                </child>
+                <style>
+                  <class name="circular"/>
+                </style>
+              </object>
+            </child>
+            <child>
+              <object class="GtkSwitch" id="hot_keys_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+  </object>
+</interface>
\ No newline at end of file
diff --git a/prefs.js b/prefs.js
index df95ccbb..8f3e963f 100644
--- a/prefs.js
+++ b/prefs.js
@@ -2479,9 +2479,8 @@ function fillPreferencesWindow(window) {
     let pageBehavior = builder.get_object('behavior');
     window.add(pageBehavior);
 
-    let pageAction = new Adw.PreferencesPage();
-    pageAction.set_title("Action");
-    pageAction.set_icon_name("document-properties");
+    builder.add_from_file(Me.path + '/SettingsAction.ui');
+    let pageAction = builder.get_object('action');
     window.add(pageAction);
 
     let pageFineTune = new Adw.PreferencesPage();

From e1459fbe570658283e2bd7650fe125be29c1ba4f Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 01:41:46 +0200
Subject: [PATCH 04/62] convert about tab to adw preferences page

---
 SettingsAbout.ui | 99 ++++++++++++++++++++++++++++++++++++++++++++++++
 prefs.js         |  5 +--
 2 files changed, 101 insertions(+), 3 deletions(-)
 create mode 100644 SettingsAbout.ui

diff --git a/SettingsAbout.ui b/SettingsAbout.ui
new file mode 100644
index 00000000..73c23bdb
--- /dev/null
+++ b/SettingsAbout.ui
@@ -0,0 +1,99 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="AdwPreferencesPage" id="about">
+    <property name="title">About</property>
+    <property name="icon_name">document-properties</property>
+
+      <!-- group info -->
+      <child>
+        <object class="AdwPreferencesGroup" id="about_group_info">
+          <property name="title" translatable="yes">Info</property>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Version</property>
+              <child>
+                <object class="GtkLabel" id="extension_version">
+                  <property name="label">...</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Source</property>
+              <child>
+                <object class="GtkLinkButton" id="homepage_link">
+                  <property name="label" translatable="yes">GitHub</property>
+                  <property name="receives_default">True</property>
+                  <property name="halign">center</property>
+                  <property name="uri">https://github.com/jderose9/dash-to-panel</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+        </object>
+      </child>
+
+      <!-- group export import -->
+      <child>
+        <object class="AdwPreferencesGroup" id="about_group_export_and_import">
+          <property name="title" translatable="yes">Export and Import</property>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Export and import settings</property>
+              <property name="subtitle" translatable="yes">Use the buttons below to create a settings file from your current preferences that can be imported on a different machine.</property>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwPreferencesRow">
+              <child>
+                <object class="GtkBox">
+                  <property name="margin_start">8</property>
+                  <property name="margin_end">8</property>
+                  <property name="margin_top">4</property>
+                  <property name="margin_bottom">4</property>
+                  <property name="spacing">8</property>
+                  <property name="halign">end</property>
+                  <child>
+                    <object class="GtkButton" id="importexport_export_button">
+                      <property name="label" translatable="yes">Export to file</property>
+                      <property name="receives_default">True</property>
+                    </object>
+                  </child>
+                  <child>
+                    <object class="GtkButton" id="importexport_import_button">
+                      <property name="label" translatable="yes">Import from file</property>
+                      <property name="receives_default">True</property>
+                    </object>
+                  </child>
+                </object>
+              </child>
+            </object>
+          </child>
+
+        </object>
+      </child>
+
+      <!-- group disclaimer -->
+      <child>
+        <object class="AdwPreferencesGroup" id="about_group_disclaimer">
+          <child>
+            <object class="GtkLabel" id="label1">
+              <property name="label" translatable="yes">&lt;span size="small"&gt;This program comes with ABSOLUTELY NO WARRANTY.&#10;See the &lt;a href="https://www.gnu.org/licenses/old-licenses/gpl-2.0.html"&gt;GNU General Public License, version 2 or later&lt;/a&gt; for details.&lt;/span&gt;</property>
+              <property name="use_markup">True</property>
+              <property name="justify">center</property>
+              <property name="wrap">True</property>
+            </object>
+          </child>
+        </object>
+      </child>
+
+  </object>
+</interface>
\ No newline at end of file
diff --git a/prefs.js b/prefs.js
index 8f3e963f..8e5b5ab0 100644
--- a/prefs.js
+++ b/prefs.js
@@ -2488,9 +2488,8 @@ function fillPreferencesWindow(window) {
     pageFineTune.set_icon_name("document-properties");
     window.add(pageFineTune);
 
-    let pageAbout = new Adw.PreferencesPage();
-    pageAbout.set_title("About");
-    pageAbout.set_icon_name("document-properties");
+    builder.add_from_file(Me.path + '/SettingsAbout.ui');
+    let pageAbout = builder.get_object('about');
     window.add(pageAbout);
 }
 

From ff5fc34106e02a8f9d3f23c34cbf58ccf36ea573 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 19:11:44 +0200
Subject: [PATCH 05/62] convert position tab to adw preferences page

---
 SettingsPosition.ui | 247 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 247 insertions(+)
 create mode 100644 SettingsPosition.ui

diff --git a/SettingsPosition.ui b/SettingsPosition.ui
new file mode 100644
index 00000000..5fd631ef
--- /dev/null
+++ b/SettingsPosition.ui
@@ -0,0 +1,247 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="panel_size_adjustment">
+    <property name="lower">0.33</property>
+    <property name="upper">1</property>
+    <property name="step_increment">0.01</property>
+    <property name="page_increment">0.1</property>
+  </object>
+
+  <object class="GtkAdjustment" id="panel_length_adjustment">
+    <property name="upper">100</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">10</property>
+  </object>
+
+  <object class="AdwPreferencesPage" id="position">
+    <property name="title">Position</property>
+    <property name="icon_name">document-properties</property>
+
+      <!-- group panel -->
+      <child>
+        <object class="AdwPreferencesGroup" id="position_group_panel">
+          <property name="title" translatable="yes">Panel</property>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Display the main panel on</property>
+              <child>
+                <object class="GtkSwitch" id="multimon_multi_switch">
+                  <property name="valign">center</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Display panels on all monitors</property>
+              <child>
+                <object class="GtkComboBoxText" id="multimon_primary_combo">
+                  <property name="can_focus">False</property>
+                  <property name="valign">center</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+        </object>
+      </child>
+      <child>
+        <object class="AdwPreferencesGroup" id="position_group_panel2">
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Panel Intellihide</property>
+              <property name="subtitle" translatable="yes">Hide and reveal the panel according to preferences</property>
+              <child>
+                <object class="GtkButton" id="intellihide_options_button">
+                  <property name="receives_default">True</property>
+                  <property name="valign">center</property>
+                  <child>
+                    <object class="GtkImage" id="image_intellihide_options">
+                      <property name="can_focus">False</property>
+                      <property name="icon_name">emblem-system-symbolic</property>
+                    </object>
+                  </child>
+                  <style>
+                    <class name="circular"/>
+                  </style>
+                </object>
+              </child>
+              <child>
+                <object class="GtkSwitch" id="intellihide_switch">
+                  <property name="valign">center</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+        </object>
+      </child>
+
+      <!-- group order and positions -->
+      <child>
+        <object class="AdwPreferencesGroup" id="position_group_on_monitor">
+          <property name="title" translatable="yes">Order and Position on monitors</property>
+          
+
+          <child>
+            <object class="AdwPreferencesRow">
+              <property name="title" translatable="yes">Monitor</property>
+              <child>
+                <object class="GtkBox">
+                  <property name="margin-start">6</property>
+                  <property name="margin-end">6</property>
+                  <property name="margin-top">6</property>
+                  <property name="margin-bottom">6</property>
+                  <child>
+                    <object class="GtkCheckButton" id="taskbar_position_sync_button">
+                      <property name="label" translatable="yes">Apply changes to all monitors</property>
+                      <property name="receives_default">False</property>
+                      <property name="halign">start</property>
+                      <property name="hexpand">True</property>
+                    </object>
+                  </child>
+                  <child>
+                    <object class="GtkComboBoxText" id="taskbar_position_monitor_combo">
+                      <property name="can_focus">False</property>
+                      <property name="halign">end</property>
+                      <property name="valign">center</property>
+                      <property name="hexpand">True</property>
+                    </object>
+                  </child>
+                </object>
+              </child>
+            </object>
+          </child>
+
+        </object>
+      </child>
+
+      <!-- group order and positions 2 -->
+      <child>
+        <object class="AdwPreferencesGroup" id="position_group_on_monitor2">
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Panel screen position</property>
+              <child>
+                <object class="GtkToggleButton" id="position_bottom_button">
+                  <property name="label" translatable="yes">Bottom</property>
+                  <property name="receives_default">False</property>
+                  <property name="valign">center</property>
+                  <property name="active">True</property>
+                  <signal name="clicked" handler="position_bottom_button_clicked_cb" swapped="no"/>
+                </object>
+              </child>
+              <child>
+                <object class="GtkToggleButton" id="position_top_button">
+                  <property name="label" translatable="yes">Top</property>
+                  <property name="receives_default">False</property>
+                  <property name="valign">center</property>
+                  <property name="group">position_bottom_button</property>
+                  <signal name="clicked" handler="position_top_button_clicked_cb" swapped="no"/>
+                </object>
+              </child>
+              <child>
+                <object class="GtkToggleButton" id="position_left_button">
+                  <property name="label" translatable="yes">Left</property>
+                  <property name="receives_default">False</property>
+                  <property name="valign">center</property>
+                  <property name="group">position_bottom_button</property>
+                  <signal name="clicked" handler="position_left_button_clicked_cb" swapped="no"/>
+                </object>
+              </child>
+              <child>
+                <object class="GtkToggleButton" id="position_right_button">
+                  <property name="label" translatable="yes">Right</property>
+                  <property name="receives_default">False</property>
+                  <property name="valign">center</property>
+                  <property name="group">position_bottom_button</property>
+                  <signal name="clicked" handler="position_right_button_clicked_cb" swapped="no"/>
+                </object>
+              </child>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Panel thickness</property>
+              <property name="subtitle" translatable="yes">(default is 48)</property>
+              <child>
+                <object class="GtkScale" id="panel_size_scale">
+                  <property name="hexpand">True</property>
+                  <property name="adjustment">panel_size_adjustment</property>
+                  <property name="round_digits">0</property>
+                  <property name="digits">0</property>
+                  <property name="value_pos">right</property>
+                  <property name="draw_value">True</property>
+                  <signal name="value-changed" handler="panel_size_scale_value_changed_cb" swapped="no"/>
+                </object>
+              </child>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Panel length (%)</property>
+              <property name="subtitle" translatable="yes">(default is 100)</property>
+              <child>
+                <object class="GtkScale" id="panel_length_scale">
+                  <property name="hexpand">True</property>
+                  <property name="adjustment">panel_length_adjustment</property>
+                  <property name="round_digits">0</property>
+                  <property name="digits">0</property>
+                  <property name="value_pos">right</property>
+                  <property name="draw_value">True</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Anchor</property>
+              <child>
+                <object class="GtkComboBoxText" id="panel_anchor_combo">
+                  <property name="can_focus">False</property>
+                  <property name="valign">center</property>
+                  <items>
+                    <item id="START" translatable="yes">Start</item>
+                    <item id="MIDDLE" translatable="yes">Middle</item>
+                    <item id="END" translatable="yes">End</item>
+                  </items>
+                </object>
+              </child>
+            </object>
+          </child>
+
+        </object>
+      </child>
+
+      <!-- group order and positions 3 -->
+      <child>
+        <object class="AdwPreferencesGroup" id="position_group_on_monitor3">
+
+          <child>
+            <object class="AdwPreferencesRow">
+              <property name="title" translatable="yes">Taskbar Display</property>
+              <child>
+                <object class="GtkListBox" id="taskbar_display_listbox">
+                  <property name="visible">True</property>
+                  <property name="can_focus">False</property>
+                  <property name="margin_bottom">6</property>
+                  <property name="selection_mode">none</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+        </object>
+      </child>
+
+  </object>
+</interface>
\ No newline at end of file

From b347d275ced30f403e93d09df4fa3db154db9d97 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 19:12:04 +0200
Subject: [PATCH 06/62] convert fine-tune tab to adw preferences page

---
 SettingsFineTune.ui | 273 ++++++++++++++++++++++++++++++++++++++++++++
 prefs.js            |  10 +-
 2 files changed, 277 insertions(+), 6 deletions(-)
 create mode 100644 SettingsFineTune.ui

diff --git a/SettingsFineTune.ui b/SettingsFineTune.ui
new file mode 100644
index 00000000..1b7ed5ed
--- /dev/null
+++ b/SettingsFineTune.ui
@@ -0,0 +1,273 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="tray_size_adjustment">
+    <property name="lower">0.33</property>
+    <property name="upper">1</property>
+    <property name="step_increment">0.01</property>
+    <property name="page_increment">0.1</property>
+  </object>
+
+  <object class="GtkAdjustment" id="leftbox_size_adjustment">
+    <property name="lower">0.33</property>
+    <property name="upper">1</property>
+    <property name="step_increment">0.01</property>
+    <property name="page_increment">0.1</property>
+  </object>
+
+  <object class="GtkAdjustment" id="tray_padding_adjustment">
+    <property name="lower">0.33</property>
+    <property name="upper">1</property>
+    <property name="step_increment">0.01</property>
+    <property name="page_increment">0.1</property>
+  </object>
+
+  <object class="GtkAdjustment" id="statusicon_padding_adjustment">
+    <property name="lower">0.33</property>
+    <property name="upper">1</property>
+    <property name="step_increment">0.01</property>
+    <property name="page_increment">0.1</property>
+  </object>
+
+  <object class="GtkAdjustment" id="leftbox_padding_adjustment">
+    <property name="lower">0.33</property>
+    <property name="upper">1</property>
+    <property name="step_increment">0.01</property>
+    <property name="page_increment">0.1</property>
+  </object>
+
+  <object class="AdwPreferencesPage" id="finetune">
+    <property name="title">Fine-Tune</property>
+    <property name="icon_name">document-properties</property>
+
+      <!-- group font -->
+      <child>
+        <object class="AdwPreferencesGroup" id="finetune_group_font">
+          <property name="title" translatable="yes">Font size</property>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Tray Font Size</property>
+              <property name="subtitle" translatable="yes">(0 = theme default)</property>
+              <child>
+                <object class="GtkScale" id="tray_size_scale">
+                  <property name="visible">True</property>
+                  <property name="can_focus">True</property>
+                  <property name="valign">baseline</property>
+                  <property name="hexpand">True</property>
+                  <property name="adjustment">tray_size_adjustment</property>
+                  <property name="round_digits">0</property>
+                  <property name="digits">0</property>
+                  <property name="value_pos">right</property>
+                  <property name="draw_value">True</property>
+                  <signal name="value-changed" handler="tray_size_scale_value_changed_cb" swapped="no"/>
+                </object>
+              </child>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">LeftBox Font Size</property>
+              <property name="subtitle" translatable="yes">(0 = theme default)</property>
+              <child>
+                <object class="GtkScale" id="leftbox_size_scale">
+                  <property name="visible">True</property>
+                  <property name="can_focus">True</property>
+                  <property name="valign">baseline</property>
+                  <property name="hexpand">True</property>
+                  <property name="adjustment">leftbox_size_adjustment</property>
+                  <property name="round_digits">0</property>
+                  <property name="digits">0</property>
+                  <property name="value_pos">right</property>
+                  <property name="draw_value">True</property>
+                  <signal name="value-changed" handler="leftbox_size_scale_value_changed_cb" swapped="no"/>
+                </object>
+              </child>
+            </object>
+          </child>
+
+        </object>
+      </child>
+
+      <!-- group panel -->
+      <child>
+        <object class="AdwPreferencesGroup" id="finetune_group_padding">
+          <property name="title" translatable="yes">Padding</property>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Tray Item Padding</property>
+              <property name="subtitle" translatable="yes">(-1 = theme default)</property>
+              <child>
+                <object class="GtkScale" id="tray_padding_scale">
+                  <property name="valign">baseline</property>
+                  <property name="hexpand">True</property>
+                  <property name="adjustment">tray_padding_adjustment</property>
+                  <property name="round_digits">0</property>
+                  <property name="digits">0</property>
+                  <property name="value_pos">right</property>
+                  <property name="draw_value">True</property>
+                  <signal name="value-changed" handler="tray_padding_scale_value_changed_cb" swapped="no"/>
+                </object>
+              </child>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Status Icon Padding</property>
+              <property name="subtitle" translatable="yes">(-1 = theme default)</property>
+              <child>
+                <object class="GtkScale" id="statusicon_padding_scale">
+                  <property name="valign">baseline</property>
+                  <property name="hexpand">True</property>
+                  <property name="adjustment">statusicon_padding_adjustment</property>
+                  <property name="round_digits">0</property>
+                  <property name="digits">0</property>
+                  <property name="value_pos">right</property>
+                  <property name="draw_value">True</property>
+                  <signal name="value-changed" handler="statusicon_padding_scale_value_changed_cb" swapped="no"/>
+                </object>
+              </child>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">LeftBox Padding</property>
+              <property name="subtitle" translatable="yes">(-1 = theme default)</property>
+              <child>
+                <object class="GtkScale" id="leftbox_padding_scale">
+                  <property name="valign">baseline</property>
+                  <property name="hexpand">True</property>
+                  <property name="adjustment">leftbox_padding_adjustment</property>
+                  <property name="round_digits">0</property>
+                  <property name="digits">0</property>
+                  <property name="value_pos">right</property>
+                  <property name="draw_value">True</property>
+                  <signal name="value-changed" handler="leftbox_padding_scale_value_changed_cb" swapped="no"/>
+                </object>
+              </child>
+            </object>
+          </child>
+
+        </object>
+      </child>
+
+      <!-- group animate -->
+      <child>
+        <object class="AdwPreferencesGroup" id="finetune_group_animate">
+          <property name="title" translatable="yes">Animate</property>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Animate switching applications</property>
+              <child>
+                <object class="GtkSwitch" id="animate_app_switch_switch">
+                  <property name="valign">center</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Animate launching new windows</property>
+              <child>
+                <object class="GtkSwitch" id="animate_window_launch_switch">
+                  <property name="valign">center</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+        </object>
+      </child>
+
+      <!-- group gnome -->
+      <child>
+        <object class="AdwPreferencesGroup" id="finetune_group_gnome">
+          <property name="title" translatable="yes">Gnome functionality</property>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Keep original gnome-shell dash</property>
+              <property name="subtitle" translatable="yes">(overview)</property>
+              <child>
+                <object class="GtkSwitch" id="stockgs_dash_switch">
+                  <property name="valign">center</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Keep original gnome-shell top panel</property>
+              <child>
+                <object class="GtkSwitch" id="stockgs_top_panel_switch">
+                  <property name="valign">center</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Activate panel menu buttons on click only</property>
+              <property name="subtitle" translatable="yes">(e.g. date menu)</property>
+              <child>
+                <object class="GtkSwitch" id="stockgs_panelbtn_switch">
+                  <property name="valign">center</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">Force Activities hot corner on primary monitor</property>
+              <child>
+                <object class="GtkSwitch" id="stockgs_hotcorner_switch">
+                  <property name="valign">center</property>
+                </object>
+              </child>
+            </object>
+          </child>
+
+        </object>
+      </child>
+
+      <!-- group panel -->
+      <child>
+        <object class="AdwPreferencesGroup" id="finetune_group_">
+
+          <child>
+            <object class="AdwActionRow">
+              <property name="title" translatable="yes">App icon secondary menu</property>
+              <property name="subtitle" translatable="yes">(right-click menu)</property>
+              <child>
+                <object class="GtkButton" id="secondarymenu_options_button">
+                  <property name="receives_default">True</property>
+                  <property name="valign">center</property>
+                  <child>
+                    <object class="GtkImage" id="secondarymenu_options_button_image">
+                      <property name="can_focus">False</property>
+                      <property name="icon_name">emblem-system-symbolic</property>
+                    </object>
+                  </child>
+                  <style>
+                    <class name="circular"/>
+                  </style>
+                </object>
+              </child>
+            </object>
+          </child>
+
+        </object>
+      </child>
+
+  </object>
+</interface>
\ No newline at end of file
diff --git a/prefs.js b/prefs.js
index 8e5b5ab0..13ff1190 100644
--- a/prefs.js
+++ b/prefs.js
@@ -2466,9 +2466,8 @@ function fillPreferencesWindow(window) {
     builder.set_scope(new BuilderScope());
     builder.set_translation_domain(Me.metadata['gettext-domain']);
 
-    let pagePosition = new Adw.PreferencesPage();
-    pagePosition.set_title("Position");
-    pagePosition.set_icon_name("document-properties");
+    builder.add_from_file(Me.path + '/SettingsPosition.ui');
+    let pagePosition = builder.get_object('position');
     window.add(pagePosition);
 
     builder.add_from_file(Me.path + '/SettingsStyle.ui');
@@ -2483,9 +2482,8 @@ function fillPreferencesWindow(window) {
     let pageAction = builder.get_object('action');
     window.add(pageAction);
 
-    let pageFineTune = new Adw.PreferencesPage();
-    pageFineTune.set_title("Fine-Tune");
-    pageFineTune.set_icon_name("document-properties");
+    builder.add_from_file(Me.path + '/SettingsFineTune.ui');
+    let pageFineTune = builder.get_object('finetune');
     window.add(pageFineTune);
 
     builder.add_from_file(Me.path + '/SettingsAbout.ui');

From 8e815e63aca3a7147b8553d9146045fe8d2ca9aa Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 19:56:18 +0200
Subject: [PATCH 07/62] move Settings*.ui files into ui folder

---
 prefs.js                                      | 66 +++++++++++--------
 SettingsAbout.ui => ui/SettingsAbout.ui       |  0
 SettingsAction.ui => ui/SettingsAction.ui     |  0
 SettingsBehavior.ui => ui/SettingsBehavior.ui |  0
 SettingsFineTune.ui => ui/SettingsFineTune.ui |  0
 SettingsPosition.ui => ui/SettingsPosition.ui |  0
 SettingsStyle.ui => ui/SettingsStyle.ui       |  0
 7 files changed, 37 insertions(+), 29 deletions(-)
 rename SettingsAbout.ui => ui/SettingsAbout.ui (100%)
 rename SettingsAction.ui => ui/SettingsAction.ui (100%)
 rename SettingsBehavior.ui => ui/SettingsBehavior.ui (100%)
 rename SettingsFineTune.ui => ui/SettingsFineTune.ui (100%)
 rename SettingsPosition.ui => ui/SettingsPosition.ui (100%)
 rename SettingsStyle.ui => ui/SettingsStyle.ui (100%)

diff --git a/prefs.js b/prefs.js
index 13ff1190..45a5b952 100644
--- a/prefs.js
+++ b/prefs.js
@@ -164,8 +164,42 @@ const Preferences = class {
         this._builder = new Gtk.Builder();
         this._builder.set_scope(new BuilderScope(this));
         this._builder.set_translation_domain(Me.metadata['gettext-domain']);
-        this._builder.add_from_file(Me.path + '/Settings.ui');
-        this.notebook = this._builder.get_object('settings_notebook');
+
+        if (window) {
+            this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
+            let pagePosition = this._builder.get_object('position');
+            window.add(pagePosition);
+
+            this._builder.add_from_file(Me.path + '/ui/SettingsStyle.ui');
+            let pageStyle = this._builder.get_object('style');
+            window.add(pageStyle);
+
+            this._builder.add_from_file(Me.path + '/ui/SettingsBehavior.ui');
+            let pageBehavior = this._builder.get_object('behavior');
+            window.add(pageBehavior);
+
+            this._builder.add_from_file(Me.path + '/ui/SettingsAction.ui');
+            let pageAction = this._builder.get_object('action');
+            window.add(pageAction);
+
+            this._builder.add_from_file(Me.path + '/ui/SettingsFineTune.ui');
+            let pageFineTune = this._builder.get_object('finetune');
+            window.add(pageFineTune);
+
+            this._builder.add_from_file(Me.path + '/ui/SettingsAbout.ui');
+            let pageAbout = this._builder.get_object('about');
+            window.add(pageAbout);
+
+            // set the window as notebook, it is being used as parent for dialogs
+            this.notebook = window;
+
+            // TODO return for now, many things are still missing
+            return;
+
+        } else {
+            this._builder.add_from_file(Me.path + '/Settings.ui');
+            this.notebook = this._builder.get_object('settings_notebook');
+        }
 
         // Timeout to delay the update of the settings
         this._panel_size_timeout = 0;
@@ -2462,33 +2496,7 @@ function init() {
 function fillPreferencesWindow(window) {
     window.set_default_size(680, 740);
 
-    builder = new Gtk.Builder();
-    builder.set_scope(new BuilderScope());
-    builder.set_translation_domain(Me.metadata['gettext-domain']);
-
-    builder.add_from_file(Me.path + '/SettingsPosition.ui');
-    let pagePosition = builder.get_object('position');
-    window.add(pagePosition);
-
-    builder.add_from_file(Me.path + '/SettingsStyle.ui');
-    let pageStyle = builder.get_object('style');
-    window.add(pageStyle);
-
-    builder.add_from_file(Me.path + '/SettingsBehavior.ui');
-    let pageBehavior = builder.get_object('behavior');
-    window.add(pageBehavior);
-
-    builder.add_from_file(Me.path + '/SettingsAction.ui');
-    let pageAction = builder.get_object('action');
-    window.add(pageAction);
-
-    builder.add_from_file(Me.path + '/SettingsFineTune.ui');
-    let pageFineTune = builder.get_object('finetune');
-    window.add(pageFineTune);
-
-    builder.add_from_file(Me.path + '/SettingsAbout.ui');
-    let pageAbout = builder.get_object('about');
-    window.add(pageAbout);
+    let preferences = new Preferences(window);
 }
 
 function buildPrefsWidget() {
diff --git a/SettingsAbout.ui b/ui/SettingsAbout.ui
similarity index 100%
rename from SettingsAbout.ui
rename to ui/SettingsAbout.ui
diff --git a/SettingsAction.ui b/ui/SettingsAction.ui
similarity index 100%
rename from SettingsAction.ui
rename to ui/SettingsAction.ui
diff --git a/SettingsBehavior.ui b/ui/SettingsBehavior.ui
similarity index 100%
rename from SettingsBehavior.ui
rename to ui/SettingsBehavior.ui
diff --git a/SettingsFineTune.ui b/ui/SettingsFineTune.ui
similarity index 100%
rename from SettingsFineTune.ui
rename to ui/SettingsFineTune.ui
diff --git a/SettingsPosition.ui b/ui/SettingsPosition.ui
similarity index 100%
rename from SettingsPosition.ui
rename to ui/SettingsPosition.ui
diff --git a/SettingsStyle.ui b/ui/SettingsStyle.ui
similarity index 100%
rename from SettingsStyle.ui
rename to ui/SettingsStyle.ui

From 7cf677a61837bec1b242e2d4825a3d96b84383d1 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 20:33:01 +0200
Subject: [PATCH 08/62] migrate animate appicon hover options dialog

---
 prefs.js                         |   3 +
 ui/AnimateAppIconHoverOptions.ui | 296 +++++++++++++++++++++++++++++++
 2 files changed, 299 insertions(+)
 create mode 100644 ui/AnimateAppIconHoverOptions.ui

diff --git a/prefs.js b/prefs.js
index 45a5b952..6bf5565d 100644
--- a/prefs.js
+++ b/prefs.js
@@ -166,6 +166,9 @@ const Preferences = class {
         this._builder.set_translation_domain(Me.metadata['gettext-domain']);
 
         if (window) {
+            // dialogs
+            this._builder.add_from_file(Me.path + '/ui/AnimateAppIconHoverOptions.ui');
+
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
             let pagePosition = this._builder.get_object('position');
             window.add(pagePosition);
diff --git a/ui/AnimateAppIconHoverOptions.ui b/ui/AnimateAppIconHoverOptions.ui
new file mode 100644
index 00000000..28f7ad14
--- /dev/null
+++ b/ui/AnimateAppIconHoverOptions.ui
@@ -0,0 +1,296 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <!-- adjustments -->
+  <object class="GtkAdjustment" id="animate_appicon_hover_options_duration_adjustment">
+    <property name="lower">0</property>
+    <property name="upper">300</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">5</property>
+  </object>
+
+  <object class="GtkAdjustment" id="animate_appicon_hover_options_rotation_adjustment">
+    <property name="lower">-30</property>
+    <property name="upper">30</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">5</property>
+  </object>
+
+  <object class="GtkAdjustment" id="animate_appicon_hover_options_travel_adjustment">
+    <property name="lower">0</property>
+    <property name="upper">100</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">5</property>
+  </object>
+
+  <object class="GtkAdjustment" id="animate_appicon_hover_options_zoom_adjustment">
+    <property name="lower">100</property>
+    <property name="upper">250</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">5</property>
+  </object>
+
+  <object class="GtkAdjustment" id="animate_appicon_hover_options_convexity_adjustment">
+    <property name="lower">0</property>
+    <property name="upper">3</property>
+    <property name="step_increment">0.1</property>
+    <property name="page_increment">1</property>
+  </object>
+
+  <object class="GtkAdjustment" id="animate_appicon_hover_options_extent_adjustment">
+    <property name="lower">1</property>
+    <property name="upper">10</property>
+    <property name="step_increment">0.1</property>
+    <property name="page_increment">1</property>
+  </object>
+
+  <object class="GtkBox" id="animate_appicon_hover_options">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="orientation">vertical</property>
+    <property name="hexpand">1</property>
+    <property name="vexpand">1</property>
+    <child>
+      <object class="GtkListBoxRow" id="animate_appicon_hover_options_type_listboxrow">
+        <property name="visible">True</property>
+        <property name="can_focus">True</property>
+        <property name="activatable">False</property>
+        <child>
+          <object class="GtkBox" id="animate_appicon_hover_options_type_box">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="margin_start">12</property>
+            <property name="margin_end">12</property>
+            <property name="margin_top">12</property>
+            <property name="margin_bottom">12</property>
+            <property name="spacing">32</property>
+            <child>
+              <object class="GtkLabel" id="animate_appicon_hover_options_type_label">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="hexpand">True</property>
+                <property name="label" translatable="yes">Animation type</property>
+                <property name="xalign">0</property>
+              </object>
+            </child>
+            <child>
+              <object class="GtkComboBoxText" id="animate_appicon_hover_options_type_combo">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="valign">center</property>
+                <items>
+                  <item id="SIMPLE" translatable="yes">Simple</item>
+                  <item id="RIPPLE" translatable="yes">Ripple</item>
+                  <item id="PLANK" translatable="yes">Plank</item>
+                </items>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+    <child>
+      <object class="GtkListBoxRow" id="animate_appicon_hover_options_params_listboxrow">
+        <property name="visible">True</property>
+        <property name="can_focus">True</property>
+        <property name="activatable">False</property>
+        <child>
+          <object class="GtkGrid" id="animate_appicon_hover_options_params_grid">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="margin_start">12</property>
+            <property name="margin_end">12</property>
+            <property name="margin_top">12</property>
+            <property name="margin_bottom">12</property>
+            <property name="row_spacing">24</property>
+            <property name="column_spacing">32</property>
+            <child>
+              <object class="GtkLabel" id="animate_appicon_hover_options_duration_label">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="margin_end">12</property>
+                <property name="label" translatable="yes">Duration</property>
+                <property name="use_markup">True</property>
+                <property name="xalign">0</property>
+                <property name="valign">end</property>
+                <layout>
+                  <property name="row">0</property>
+                  <property name="column">0</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkScale" id="animate_appicon_hover_options_duration_scale">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="valign">end</property>
+                <property name="hexpand">True</property>
+                <property name="adjustment">animate_appicon_hover_options_duration_adjustment</property>
+                <property name="round_digits">0</property>
+                <property name="digits">0</property>
+                <property name="value_pos">right</property>
+                <property name="draw_value">True</property>
+                <layout>
+                  <property name="row">0</property>
+                  <property name="column">1</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkLabel" id="animate_appicon_hover_options_extent_rotation">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="label" translatable="yes">Rotation</property>
+                <property name="xalign">0</property>
+                <property name="valign">end</property>
+                <layout>
+                  <property name="row">1</property>
+                  <property name="column">0</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkScale" id="animate_appicon_hover_options_rotation_scale">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="valign">end</property>
+                <property name="hexpand">True</property>
+                <property name="adjustment">animate_appicon_hover_options_rotation_adjustment</property>
+                <property name="round_digits">0</property>
+                <property name="digits">0</property>
+                <property name="value_pos">right</property>
+                <property name="draw_value">True</property>
+                <layout>
+                  <property name="row">1</property>
+                  <property name="column">1</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkLabel" id="animate_appicon_hover_options_travel_label">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="label" translatable="yes">Travel</property>
+                <property name="xalign">0</property>
+                <property name="valign">end</property>
+                <layout>
+                  <property name="row">2</property>
+                  <property name="column">0</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkScale" id="animate_appicon_hover_options_travel_scale">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="valign">end</property>
+                <property name="hexpand">True</property>
+                <property name="adjustment">animate_appicon_hover_options_travel_adjustment</property>
+                <property name="round_digits">0</property>
+                <property name="digits">0</property>
+                <property name="value_pos">right</property>
+                <property name="draw_value">True</property>
+                <layout>
+                  <property name="row">2</property>
+                  <property name="column">1</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkLabel" id="animate_appicon_hover_options_zoom_label">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="label" translatable="yes">Zoom</property>
+                <property name="xalign">0</property>
+                <property name="valign">end</property>
+                <layout>
+                  <property name="row">3</property>
+                  <property name="column">0</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkScale" id="animate_appicon_hover_options_zoom_scale">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="valign">end</property>
+                <property name="hexpand">True</property>
+                <property name="adjustment">animate_appicon_hover_options_zoom_adjustment</property>
+                <property name="round_digits">0</property>
+                <property name="digits">0</property>
+                <property name="value_pos">right</property>
+                <property name="draw_value">True</property>
+                <layout>
+                  <property name="row">3</property>
+                  <property name="column">1</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkLabel" id="animate_appicon_hover_options_convexity_label">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="label" translatable="yes">Convexity</property>
+                <property name="xalign">0</property>
+                <property name="valign">end</property>
+                <layout>
+                  <property name="row">4</property>
+                  <property name="column">0</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkScale" id="animate_appicon_hover_options_convexity_scale">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="valign">end</property>
+                <property name="hexpand">True</property>
+                <property name="adjustment">animate_appicon_hover_options_convexity_adjustment</property>
+                <property name="round_digits">1</property>
+                <property name="digits">1</property>
+                <property name="value_pos">right</property>
+                <property name="draw_value">True</property>
+                <layout>
+                  <property name="row">4</property>
+                  <property name="column">1</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkLabel" id="animate_appicon_hover_options_extent_label">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="label" translatable="yes">Extent</property>
+                <property name="xalign">0</property>
+                <property name="valign">end</property>
+                <layout>
+                  <property name="row">5</property>
+                  <property name="column">0</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkScale" id="animate_appicon_hover_options_extent_scale">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="valign">end</property>
+                <property name="hexpand">True</property>
+                <property name="adjustment">animate_appicon_hover_options_extent_adjustment</property>
+                <property name="round_digits">0</property>
+                <property name="digits">0</property>
+                <property name="value_pos">right</property>
+                <property name="draw_value">True</property>
+                <layout>
+                  <property name="row">5</property>
+                  <property name="column">1</property>
+                </layout>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From c3afaec504eba7f1ac9aa6c5a542f5e9f5cdd8fa Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 20:37:21 +0200
Subject: [PATCH 09/62] migrate box options dialog

---
 prefs.js            |   1 +
 ui/BoxDotOptions.ui | 586 ++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 587 insertions(+)
 create mode 100644 ui/BoxDotOptions.ui

diff --git a/prefs.js b/prefs.js
index 6bf5565d..3496a35b 100644
--- a/prefs.js
+++ b/prefs.js
@@ -168,6 +168,7 @@ const Preferences = class {
         if (window) {
             // dialogs
             this._builder.add_from_file(Me.path + '/ui/AnimateAppIconHoverOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxDotOptions.ui');
 
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
             let pagePosition = this._builder.get_object('position');
diff --git a/ui/BoxDotOptions.ui b/ui/BoxDotOptions.ui
new file mode 100644
index 00000000..d75e3375
--- /dev/null
+++ b/ui/BoxDotOptions.ui
@@ -0,0 +1,586 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="focus_highlight_opacity_adjustment">
+    <property name="lower">5</property>
+    <property name="upper">100</property>
+    <property name="step_increment">5</property>
+    <property name="page_increment">5</property>
+  </object>
+
+  <object class="GtkAdjustment" id="dot_size_adjustment">
+    <property name="upper">5</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">5</property>
+  </object>
+
+  <object class="GtkBox" id="box_dots_options">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="margin_top">12</property>
+    <property name="margin_bottom">12</property>
+    <property name="orientation">vertical</property>
+    <property name="hexpand">1</property>
+    <property name="vexpand">1</property>
+    <child>
+      <object class="GtkFrame" id="frame_dots_options">
+        <property name="visible">True</property>
+        <property name="can_focus">False</property>
+        <property name="margin_start">12</property>
+        <property name="margin_end">12</property>
+        <property name="margin_top">12</property>
+        <property name="margin_bottom">12</property>
+        <property name="label_xalign">0</property>
+        <child>
+          <object class="GtkListBox" id="listbox_dots_options">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="selection_mode">none</property>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_focus_highlight">
+                <property name="width_request">100</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_focus_highlight">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="row_spacing">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="focus_highlight_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Highlight focused application</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="focus_highlight_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkGrid" id="grid_focus_highlight_options">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="margin_start">12</property>
+                        <property name="row_spacing">8</property>
+                        <child>
+                          <object class="GtkLabel" id="focus_highlight_dominant_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Icon dominant color</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkSwitch" id="focus_highlight_dominant_switch">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="halign">end</property>
+                            <property name="valign">center</property>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkLabel" id="focus_highlight_color_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Custom color</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">1</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkColorButton" id="focus_highlight_color_colorbutton">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="receives_default">True</property>
+                            <property name="halign">end</property>
+                            <layout>
+                              <property name="row">1</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkLabel" id="focus_highlight_opacity_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Highlight opacity</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">2</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkSpinButton" id="focus_highlight_opacity_spinbutton">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="halign">end</property>
+                            <property name="text">5</property>
+                            <property name="adjustment">focus_highlight_opacity_adjustment</property>
+                            <property name="value">5</property>
+                            <layout>
+                              <property name="row">2</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_dot_size">
+                <property name="width_request">100</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_dot_size">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="dot_size_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Indicator size (px)</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSpinButton" id="dot_size_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="text">0</property>
+                        <property name="adjustment">dot_size_adjustment</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_dot_dominant">
+                <property name="width_request">100</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_dot_dominant">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="dot_dominant_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Indicator color - Icon Dominant</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="dot_color_dominant_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_dot_color">
+                <property name="width_request">100</property>
+                <property name="height_request">80</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkBox" id="box_dot_color">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="orientation">vertical</property>
+                    <child>
+                      <object class="GtkBox" id="dot_color_override_box">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <child>
+                          <object class="GtkLabel" id="dot_color_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Indicator color - Override Theme</property>
+                            <property name="xalign">0</property>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkSwitch" id="dot_color_override_switch">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="halign">end</property>
+                            <property name="valign">center</property>
+                          </object>
+                        </child>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkGrid" id="grid_dot_color">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="margin_start">12</property>
+                        <property name="margin_top">12</property>
+                        <property name="margin_bottom">12</property>
+                        <property name="row_spacing">4</property>
+                        <property name="column_spacing">32</property>
+                        <child>
+                          <object class="GtkLabel" id="dot_color_1_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">1 window open (or ungrouped)</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkBox" id="dot_color_1_box">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="halign">end</property>
+                            <child>
+                              <object class="GtkButton" id="dot_color_apply_all_button">
+                                <property name="label" translatable="yes">Apply to all</property>
+                                <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="receives_default">True</property>
+                              </object>
+                            </child>
+                            <child>
+                              <object class="GtkColorButton" id="dot_color_1_colorbutton">
+                                <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="receives_default">True</property>
+                                <property name="halign">end</property>
+                              </object>
+                            </child>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkLabel" id="dot_color_2_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">2 windows open</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">1</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkLabel" id="dot_color_3_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">3 windows open</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">2</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkLabel" id="dot_color_4_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">4+ windows open</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">3</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkColorButton" id="dot_color_2_colorbutton">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="receives_default">True</property>
+                            <property name="halign">end</property>
+                            <layout>
+                              <property name="row">1</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkColorButton" id="dot_color_3_colorbutton">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="receives_default">True</property>
+                            <property name="halign">end</property>
+                            <layout>
+                              <property name="row">2</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkColorButton" id="dot_color_4_colorbutton">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="receives_default">True</property>
+                            <property name="halign">end</property>
+                            <layout>
+                              <property name="row">3</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkBox" id="dot_color_unfocused_box">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="orientation">vertical</property>
+                        <child>
+                          <object class="GtkBox" id="dot_color_unfocused_different_box">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="margin_start">12</property>
+                            <child>
+                              <object class="GtkLabel" id="dot_color_unfocused_label">
+                                <property name="visible">True</property>
+                                <property name="can_focus">False</property>
+                                <property name="hexpand">True</property>
+                                <property name="label" translatable="yes">Use different for unfocused</property>
+                                <property name="xalign">0</property>
+                              </object>
+                            </child>
+                            <child>
+                              <object class="GtkSwitch" id="dot_color_unfocused_different_switch">
+                                <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="halign">end</property>
+                                <property name="valign">center</property>
+                              </object>
+                            </child>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkGrid" id="grid_dot_color_unfocused">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="margin_start">12</property>
+                            <property name="margin_top">12</property>
+                            <property name="margin_bottom">12</property>
+                            <property name="row_spacing">4</property>
+                            <property name="column_spacing">32</property>
+                            <child>
+                              <object class="GtkLabel" id="dot_color_unfocused_1_label">
+                                <property name="visible">True</property>
+                                <property name="can_focus">False</property>
+                                <property name="hexpand">True</property>
+                                <property name="label" translatable="yes">1 window open (or ungrouped)</property>
+                                <property name="xalign">0</property>
+                                <layout>
+                                  <property name="row">0</property>
+                                  <property name="column">0</property>
+                                </layout>
+                              </object>
+                            </child>
+                            <child>
+                              <object class="GtkBox" id="dot_color_unfocused_1_box">
+                                <property name="visible">True</property>
+                                <property name="can_focus">False</property>
+                                <property name="halign">end</property>
+                                <child>
+                                  <object class="GtkButton" id="dot_color_unfocused_apply_all_button">
+                                    <property name="label" translatable="yes">Apply to all</property>
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="receives_default">True</property>
+                                  </object>
+                                </child>
+                                <child>
+                                  <object class="GtkColorButton" id="dot_color_unfocused_1_colorbutton">
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="receives_default">True</property>
+                                    <property name="halign">end</property>
+                                  </object>
+                                </child>
+                                <layout>
+                                  <property name="row">0</property>
+                                  <property name="column">1</property>
+                                </layout>
+                              </object>
+                            </child>
+                            <child>
+                              <object class="GtkLabel" id="dot_color_unfocused_2_label">
+                                <property name="visible">True</property>
+                                <property name="can_focus">False</property>
+                                <property name="hexpand">True</property>
+                                <property name="label" translatable="yes">2 windows open</property>
+                                <property name="xalign">0</property>
+                                <layout>
+                                  <property name="row">1</property>
+                                  <property name="column">0</property>
+                                </layout>
+                              </object>
+                            </child>
+                            <child>
+                              <object class="GtkColorButton" id="dot_color_unfocused_2_colorbutton">
+                                <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="receives_default">True</property>
+                                <property name="halign">end</property>
+                                <layout>
+                                  <property name="row">1</property>
+                                  <property name="column">1</property>
+                                </layout>
+                              </object>
+                            </child>
+                            <child>
+                              <object class="GtkLabel" id="dot_color_unfocused_3_label">
+                                <property name="visible">True</property>
+                                <property name="can_focus">False</property>
+                                <property name="hexpand">True</property>
+                                <property name="label" translatable="yes">3 windows open</property>
+                                <property name="xalign">0</property>
+                                <layout>
+                                  <property name="row">2</property>
+                                  <property name="column">0</property>
+                                </layout>
+                              </object>
+                            </child>
+                            <child>
+                              <object class="GtkColorButton" id="dot_color_unfocused_3_colorbutton">
+                                <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="receives_default">True</property>
+                                <property name="halign">end</property>
+                                <layout>
+                                  <property name="row">2</property>
+                                  <property name="column">1</property>
+                                </layout>
+                              </object>
+                            </child>
+                            <child>
+                              <object class="GtkLabel" id="dot_color_unfocused_4_label">
+                                <property name="visible">True</property>
+                                <property name="can_focus">False</property>
+                                <property name="hexpand">True</property>
+                                <property name="label" translatable="yes">4+ windows open</property>
+                                <property name="xalign">0</property>
+                                <layout>
+                                  <property name="row">3</property>
+                                  <property name="column">0</property>
+                                </layout>
+                              </object>
+                            </child>
+                            <child>
+                              <object class="GtkColorButton" id="dot_color_unfocused_4_colorbutton">
+                                <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="receives_default">True</property>
+                                <property name="halign">end</property>
+                                <layout>
+                                  <property name="row">3</property>
+                                  <property name="column">1</property>
+                                </layout>
+                              </object>
+                            </child>
+                          </object>
+                        </child>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From 85501a943c0026723a403135a3f26c05c1d460c3 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 20:44:28 +0200
Subject: [PATCH 10/62] migrate box show desktop  dialog

---
 prefs.js                    |   1 +
 ui/BoxShowDesktopOptions.ui | 243 ++++++++++++++++++++++++++++++++++++
 2 files changed, 244 insertions(+)
 create mode 100644 ui/BoxShowDesktopOptions.ui

diff --git a/prefs.js b/prefs.js
index 3496a35b..283e1c17 100644
--- a/prefs.js
+++ b/prefs.js
@@ -169,6 +169,7 @@ const Preferences = class {
             // dialogs
             this._builder.add_from_file(Me.path + '/ui/AnimateAppIconHoverOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxDotOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxShowDesktopOptions.ui');
 
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
             let pagePosition = this._builder.get_object('position');
diff --git a/ui/BoxShowDesktopOptions.ui b/ui/BoxShowDesktopOptions.ui
new file mode 100644
index 00000000..8b976db5
--- /dev/null
+++ b/ui/BoxShowDesktopOptions.ui
@@ -0,0 +1,243 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="show_showdesktop_width_adjustment">
+    <property name="lower">1</property>
+    <property name="upper">40</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">10</property>
+  </object>
+
+  <object class="GtkAdjustment" id="show_showdesktop_delay_adjustment">
+    <property name="upper">5000</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkAdjustment" id="show_showdesktop_time_adjustment">
+    <property name="upper">5000</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkBox" id="box_show_showdesktop_options">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="orientation">vertical</property>
+    <child>
+      <object class="GtkListBox" id="listbox_show_showdesktop_options">
+        <property name="visible">True</property>
+        <property name="can_focus">False</property>
+        <property name="selection_mode">none</property>
+        <property name="hexpand">1</property>
+        <property name="vexpand">1</property>
+        <child>
+          <object class="GtkListBoxRow" id="listboxrow_show_showdesktop_width">
+            <property name="visible">True</property>
+            <property name="can_focus">True</property>
+            <child>
+              <object class="GtkGrid" id="grid_show_showdesktop_width">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="margin_start">12</property>
+                <property name="margin_end">12</property>
+                <property name="margin_top">12</property>
+                <property name="margin_bottom">12</property>
+                <property name="row_spacing">4</property>
+                <property name="column_spacing">32</property>
+                <child>
+                  <object class="GtkLabel" id="show_showdesktop_width_label">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="xalign">0</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">0</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkSpinButton" id="show_showdesktop_width_spinbutton">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="halign">end</property>
+                    <property name="width_chars">4</property>
+                    <property name="text">1</property>
+                    <property name="adjustment">show_showdesktop_width_adjustment</property>
+                    <property name="numeric">True</property>
+                    <property name="value">1</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">1</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkLabel" id="override_show_desktop_line_color_label">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="label" translatable="yes">Override Show Desktop line color</property>
+                    <property name="xalign">0</property>
+                    <layout>
+                      <property name="row">1</property>
+                      <property name="column">0</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkBox" id="override_show_desktop_line_color_box">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="spacing">12</property>
+                    <property name="halign">end</property>
+                    <child>
+                      <object class="GtkColorButton" id="override_show_desktop_line_color_colorbutton">
+                         <property name="visible">True</property>
+                         <property name="can_focus">True</property>
+                         <property name="receives_default">True</property>
+                         <property name="halign">end</property>
+                         <property name="use_alpha">True</property>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="override_show_desktop_line_color_switch">
+                         <property name="visible">True</property>
+                         <property name="can_focus">True</property>
+                         <property name="halign">end</property>
+                         <property name="valign">center</property>
+                      </object>
+                    </child>
+                    <layout>
+                      <property name="row">1</property>
+                      <property name="column">1</property>
+                    </layout>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+        <child>
+          <object class="GtkListBoxRow" id="listboxrow_show_showdesktop_hide">
+            <property name="visible">True</property>
+            <property name="can_focus">True</property>
+            <child>
+              <object class="GtkGrid" id="grid_show_showdesktop_hide">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="margin_start">12</property>
+                <property name="margin_end">12</property>
+                <property name="margin_top">12</property>
+                <property name="margin_bottom">12</property>
+                <property name="row_spacing">12</property>
+                <property name="column_spacing">32</property>
+                <child>
+                  <object class="GtkLabel" id="show_showdesktop_hide_label">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="label" translatable="yes">Reveal the desktop when hovering the Show Desktop button</property>
+                    <property name="use_markup">True</property>
+                    <property name="xalign">0</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">0</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkSwitch" id="show_showdesktop_hide_switch">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="halign">end</property>
+                    <property name="valign">center</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">1</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkGrid" id="grid_show_showdesktop_hide_options">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="row_spacing">4</property>
+                    <child>
+                      <object class="GtkLabel" id="show_showdesktop_delay_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Delay before revealing the desktop (ms)</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSpinButton" id="show_showdesktop_delay_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="width_chars">4</property>
+                        <property name="text">1</property>
+                        <property name="adjustment">show_showdesktop_delay_adjustment</property>
+                        <property name="numeric">True</property>
+                        <property name="value">1</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="show_showdesktop_time_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Fade duration (ms)</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSpinButton" id="show_showdesktop_time_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="width_chars">4</property>
+                        <property name="text">1</property>
+                        <property name="adjustment">show_showdesktop_time_adjustment</property>
+                        <property name="numeric">True</property>
+                        <property name="value">1</property>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <layout>
+                      <property name="row">1</property>
+                      <property name="column">0</property>
+                      <property name="column-span">2</property>
+                    </layout>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From cb15f065b4f2789933b5c483f4ee84364ce1f617 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 20:50:04 +0200
Subject: [PATCH 11/62] set missing ids

---
 ui/SettingsPosition.ui | 2 +-
 ui/SettingsStyle.ui    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/ui/SettingsPosition.ui b/ui/SettingsPosition.ui
index 5fd631ef..fd01180d 100644
--- a/ui/SettingsPosition.ui
+++ b/ui/SettingsPosition.ui
@@ -203,7 +203,7 @@
           </child>
 
           <child>
-            <object class="AdwActionRow">
+            <object class="AdwActionRow" id="panel_anchor_label">
               <property name="title" translatable="yes">Anchor</property>
               <child>
                 <object class="GtkComboBoxText" id="panel_anchor_combo">
diff --git a/ui/SettingsStyle.ui b/ui/SettingsStyle.ui
index 5a27e3f4..a31c1f1c 100644
--- a/ui/SettingsStyle.ui
+++ b/ui/SettingsStyle.ui
@@ -264,7 +264,7 @@
         </child>
 
         <child>
-          <object class="AdwActionRow">
+          <object class="AdwActionRow" id="trans_opacity_box">
             <property name="title" translatable="yes">Dynamic background opacity</property>
             <property name="subtitle" translatable="yes">Change opacity when a window gets close to the panel</property>
             <child>

From 8d0621cc54a3e6a8ea1d7c422c82ca8354ca9052 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 20:53:32 +0200
Subject: [PATCH 12/62] migrate box dynamic opacity options dialog

---
 prefs.js                       |   1 +
 ui/BoxDynamicOpacityOptions.ui | 213 +++++++++++++++++++++++++++++++++
 2 files changed, 214 insertions(+)
 create mode 100644 ui/BoxDynamicOpacityOptions.ui

diff --git a/prefs.js b/prefs.js
index 283e1c17..c32de1bb 100644
--- a/prefs.js
+++ b/prefs.js
@@ -170,6 +170,7 @@ const Preferences = class {
             this._builder.add_from_file(Me.path + '/ui/AnimateAppIconHoverOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxDotOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxShowDesktopOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxDynamicOpacityOptions.ui');
 
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
             let pagePosition = this._builder.get_object('position');
diff --git a/ui/BoxDynamicOpacityOptions.ui b/ui/BoxDynamicOpacityOptions.ui
new file mode 100644
index 00000000..bc2e935d
--- /dev/null
+++ b/ui/BoxDynamicOpacityOptions.ui
@@ -0,0 +1,213 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="trans_distance_adjustment">
+    <property name="upper">200</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">10</property>
+  </object>
+
+  <object class="GtkAdjustment" id="trans_opacity_min_adjustment">
+    <property name="upper">100</property>
+    <property name="step_increment">5</property>
+    <property name="page_increment">10</property>
+  </object>
+
+  <object class="GtkAdjustment" id="trans_anim_time_adjustment">
+    <property name="upper">2000</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">10</property>
+  </object>
+
+  <object class="GtkBox" id="box_dynamic_opacity_options">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="orientation">vertical</property>
+    <property name="hexpand">1</property>
+    <property name="vexpand">1</property>
+    <child>
+      <object class="GtkListBox" id="trans_options_listbox">
+        <property name="visible">True</property>
+        <property name="can_focus">False</property>
+        <property name="selection_mode">none</property>
+        <child>
+          <object class="GtkListBoxRow" id="listboxrow_trans_options_window_type">
+            <property name="visible">True</property>
+            <property name="can_focus">True</property>
+            <child>
+              <object class="GtkGrid" id="trans_options_window_type_box">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="margin_start">12</property>
+                <property name="margin_end">12</property>
+                <property name="margin_top">12</property>
+                <property name="margin_bottom">12</property>
+                <property name="row_spacing">4</property>
+                <child>
+                  <object class="GtkLabel" id="trans_options_window_type_label">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="label" translatable="yes">The panel background opacity is affected by</property>
+                    <property name="xalign">0</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">0</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkComboBoxText" id="trans_options_window_type_combo">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="valign">center</property>
+                    <items>
+                      <item id="ALL_WINDOWS" translatable="yes">All windows</item>
+                      <item id="FOCUSED_WINDOWS" translatable="yes">Focused windows</item>
+                      <item id="MAXIMIZED_WINDOWS" translatable="yes">Maximized windows</item>
+                    </items>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">1</property>
+                    </layout>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+        <child>
+          <object class="GtkListBoxRow" id="listboxrow_trans_options_distance">
+            <property name="visible">True</property>
+            <property name="can_focus">True</property>
+            <child>
+              <object class="GtkGrid" id="grid_trans_options_distance">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="margin_start">12</property>
+                <property name="margin_end">12</property>
+                <property name="margin_top">12</property>
+                <property name="margin_bottom">12</property>
+                <property name="column_spacing">32</property>
+                <child>
+                  <object class="GtkSpinButton" id="trans_options_distance_spinbutton">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="halign">end</property>
+                    <property name="width_chars">4</property>
+                    <property name="text">50</property>
+                    <property name="adjustment">trans_distance_adjustment</property>
+                    <property name="numeric">True</property>
+                    <property name="value">50</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">1</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkLabel" id="trans_options_distance_label">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="label" translatable="yes">Change opacity when a window gets closer than (px)</property>
+                    <property name="use_markup">True</property>
+                    <property name="xalign">0</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">0</property>
+                    </layout>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+        <child>
+          <object class="GtkListBoxRow" id="listboxrow_trans_options_min_opacity">
+            <property name="visible">True</property>
+            <property name="can_focus">True</property>
+            <child>
+              <object class="GtkBox" id="trans_options_min_opacity_box">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="margin_start">12</property>
+                <property name="margin_end">12</property>
+                <property name="margin_top">12</property>
+                <property name="margin_bottom">12</property>
+                <child>
+                  <object class="GtkLabel" id="trans_options_min_opacity_label">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_end">12</property>
+                    <property name="label" translatable="yes">Change opacity to (%)</property>
+                    <property name="use_markup">True</property>
+                    <property name="xalign">0</property>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkSpinButton" id="trans_options_min_opacity_spinbutton">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="halign">end</property>
+                    <property name="text" translatable="yes">0</property>
+                    <property name="adjustment">trans_opacity_min_adjustment</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+        <child>
+          <object class="GtkListBoxRow" id="listboxrow_trans_options_anim_time">
+            <property name="visible">True</property>
+            <property name="can_focus">True</property>
+            <child>
+              <object class="GtkGrid" id="grid_trans_options_anim_time">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="margin_start">12</property>
+                <property name="margin_end">12</property>
+                <property name="margin_top">12</property>
+                <property name="margin_bottom">12</property>
+                <property name="column_spacing">32</property>
+                <child>
+                  <object class="GtkSpinButton" id="trans_options_anim_time_spinbutton">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="halign">end</property>
+                    <property name="width_chars">4</property>
+                    <property name="text">50</property>
+                    <property name="adjustment">trans_anim_time_adjustment</property>
+                    <property name="numeric">True</property>
+                    <property name="value">50</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">1</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkLabel" id="trans_options_anim_time_label">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="label" translatable="yes">Opacity change animation duration (ms)</property>
+                    <property name="use_markup">True</property>
+                    <property name="xalign">0</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">0</property>
+                    </layout>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From b9f73a11cd90ceb01d3657cd350f2366033c2e79 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 20:55:40 +0200
Subject: [PATCH 13/62] add missing id

---
 ui/SettingsStyle.ui | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ui/SettingsStyle.ui b/ui/SettingsStyle.ui
index a31c1f1c..a97a936f 100644
--- a/ui/SettingsStyle.ui
+++ b/ui/SettingsStyle.ui
@@ -309,7 +309,7 @@
         </child>
 
         <child>
-          <object class="AdwActionRow">
+          <object class="AdwActionRow" id="trans_gradient_box"> <!-- TODO this id should be the entire box-->
             <property name="title" translatable="yes">Gradient top color and opacity (%)</property>
             <child>
               <object class="GtkColorButton" id="trans_gradient_color1_colorbutton">

From 868807ea392c26a96897487b6a00e787fdded0ee Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 21:00:27 +0200
Subject: [PATCH 14/62] migrate box intellihide  options dialog

---
 prefs.js                    |   1 +
 ui/BoxIntellihideOptions.ui | 552 ++++++++++++++++++++++++++++++++++++
 2 files changed, 553 insertions(+)
 create mode 100644 ui/BoxIntellihideOptions.ui

diff --git a/prefs.js b/prefs.js
index c32de1bb..450fbf44 100644
--- a/prefs.js
+++ b/prefs.js
@@ -171,6 +171,7 @@ const Preferences = class {
             this._builder.add_from_file(Me.path + '/ui/BoxDotOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxShowDesktopOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxDynamicOpacityOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxIntellihideOptions.ui');
 
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
             let pagePosition = this._builder.get_object('position');
diff --git a/ui/BoxIntellihideOptions.ui b/ui/BoxIntellihideOptions.ui
new file mode 100644
index 00000000..92125bdb
--- /dev/null
+++ b/ui/BoxIntellihideOptions.ui
@@ -0,0 +1,552 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="intellihide_pressure_threshold_adjustment">
+    <property name="lower">1</property>
+    <property name="upper">9990</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkAdjustment" id="intellihide_pressure_time_adjustment">
+    <property name="lower">1</property>
+    <property name="upper">5000</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkAdjustment" id="intellihide_animation_time_adjustment">
+    <property name="lower">10</property>
+    <property name="upper">2000</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkAdjustment" id="intellihide_close_delay_adjustment">
+    <property name="lower">10</property>
+    <property name="upper">4000</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkAdjustment" id="intellihide_enable_hide_delay_adjustment">
+    <property name="upper">10000</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkBox" id="box_intellihide_options">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="orientation">vertical</property>
+    <property name="hexpand">1</property>
+    <property name="vexpand">1</property>
+    <child>
+      <object class="GtkFrame" id="frame_intellihide_options">
+        <property name="visible">True</property>
+        <property name="can_focus">False</property>
+        <property name="label_xalign">0</property>
+        <child>
+          <object class="GtkListBox" id="listbox_intellihide_options">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="selection_mode">none</property>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_intellihide_mode">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_intellihide_behaviour">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="row_spacing">12</property>
+                    <property name="column_spacing">32</property>
+                    <property name="row_homogeneous">True</property>
+                    <child>
+                      <object class="GtkLabel" id="intellihide_window_hide_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Only hide the panel when it is obstructed by windows </property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="intellihide_window_hide_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkGrid" id="intellihide_behaviour_options">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="margin_start">12</property>
+                        <property name="row_spacing">4</property>
+                        <child>
+                          <object class="GtkLabel" id="intellihide_behaviour_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">The panel hides from</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkComboBoxText" id="intellihide_behaviour_combo">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="valign">center</property>
+                            <items>
+                              <item id="ALL_WINDOWS" translatable="yes">All windows</item>
+                              <item id="FOCUSED_WINDOWS" translatable="yes">Focused windows</item>
+                              <item id="MAXIMIZED_WINDOWS" translatable="yes">Maximized windows</item>
+                            </items>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_intellihide_pressure">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_intellihide_pressure">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="row_spacing">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="intellihide_use_pressure_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Require pressure at the edge of the screen to reveal the panel</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="intellihide_use_pressure_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkGrid" id="intellihide_use_pressure_options">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="margin_start">12</property>
+                        <property name="row_spacing">4</property>
+                        <child>
+                          <object class="GtkLabel" id="intellihide_pressure_threshold_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Required pressure threshold (px)</property>
+                            <property name="use_markup">True</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkSpinButton" id="intellihide_pressure_threshold_spinbutton">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="halign">end</property>
+                            <property name="width_chars">4</property>
+                            <property name="text">0</property>
+                            <property name="adjustment">intellihide_pressure_threshold_adjustment</property>
+                            <property name="numeric">True</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkLabel" id="intellihide_pressure_time_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Required pressure timeout (ms)</property>
+                            <property name="use_markup">True</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">1</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkSpinButton" id="intellihide_pressure_time_spinbutton">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="halign">end</property>
+                            <property name="width_chars">4</property>
+                            <property name="text">0</property>
+                            <property name="adjustment">intellihide_pressure_time_adjustment</property>
+                            <property name="numeric">True</property>
+                            <layout>
+                              <property name="row">1</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_intellihide_show_in_fullscreen">
+                <property name="width_request">100</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_intellihide_show_in_fullscreen">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="row_spacing">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="intellihide_show_in_fullscreen_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Allow the panel to be revealed while in fullscreen mode</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="intellihide_show_in_fullscreen_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_intellihide_only_secondary">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_intellihide_only_secondary">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="row_spacing">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="intellihide_only_secondary_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Only hide secondary panels (requires multi-monitors option)</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="intellihide_only_secondary_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_intellihide_toggle">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_intellihide_toggle">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkEntry" id="intellihide_toggle_entry">
+                        <property name="can_focus">True</property>
+                        <property name="valign">center</property>
+                        <property name="width_chars">12</property>
+                        <property name="placeholder_text" translatable="yes">e.g. &lt;Super&gt;i</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                          <property name="row-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="intellihide_toggle_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Keyboard shortcut to reveal and hold the panel</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="intellihide_toggle_description">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="label" translatable="yes">Syntax: &lt;Shift&gt;, &lt;Ctrl&gt;, &lt;Alt&gt;, &lt;Super&gt;</property>
+                        <property name="wrap">True</property>
+                        <property name="max_width_chars">40</property>
+                        <property name="xalign">0</property>
+                        <style>
+                          <class name="dim-label"/>
+                        </style>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_intellihide_animation_time">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_intellihide_animation_time">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="intellihide_animation_time_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Hide and reveal animation duration (ms)</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSpinButton" id="intellihide_animation_time_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="width_chars">4</property>
+                        <property name="text">0</property>
+                        <property name="adjustment">intellihide_animation_time_adjustment</property>
+                        <property name="numeric">True</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_intellihide_close_delay">
+                <property name="width_request">100</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_intellihide_close_delay">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="intellihide_close_delay_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Delay before hiding the panel (ms)</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSpinButton" id="intellihide_close_delay_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="width_chars">4</property>
+                        <property name="text">10</property>
+                        <property name="adjustment">intellihide_close_delay_adjustment</property>
+                        <property name="numeric">True</property>
+                        <property name="value">10</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_intellihide_enable_start_delay">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_intellihide_enable_start_delay">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="row_spacing">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="intellihide_enable_start_delay_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Delay before enabling intellihide on start (ms)</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSpinButton" id="intellihide_enable_start_delay_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="width_chars">4</property>
+                        <property name="text">10</property>
+                        <property name="adjustment">intellihide_enable_hide_delay_adjustment</property>
+                        <property name="numeric">True</property>
+                        <property name="value">10</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From b0df870721f7ad499a8f7b355facf8503478b113 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 21:07:55 +0200
Subject: [PATCH 15/62] migrate show applications options dialog

---
 prefs.js                      |   1 +
 ui/ShowApplicationsOptions.ui | 178 ++++++++++++++++++++++++++++++++++
 2 files changed, 179 insertions(+)
 create mode 100644 ui/ShowApplicationsOptions.ui

diff --git a/prefs.js b/prefs.js
index 450fbf44..a1a41809 100644
--- a/prefs.js
+++ b/prefs.js
@@ -172,6 +172,7 @@ const Preferences = class {
             this._builder.add_from_file(Me.path + '/ui/BoxShowDesktopOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxDynamicOpacityOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxIntellihideOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/ShowApplicationsOptions.ui');
 
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
             let pagePosition = this._builder.get_object('position');
diff --git a/ui/ShowApplicationsOptions.ui b/ui/ShowApplicationsOptions.ui
new file mode 100644
index 00000000..dd2e605d
--- /dev/null
+++ b/ui/ShowApplicationsOptions.ui
@@ -0,0 +1,178 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="show_applications_side_padding_adjustment">
+    <property name="upper">100</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">10</property>
+  </object>
+
+  <object class="GtkBox" id="show_applications_options">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="orientation">vertical</property>
+    <property name="hexpand">1</property>
+    <property name="vexpand">1</property>
+    <child>
+      <object class="GtkListBoxRow" id="listbox_show_applications_icon_file">
+        <property name="visible">True</property>
+        <property name="can_focus">True</property>
+        <child>
+          <object class="GtkGrid" id="show_applications_icon_file_grid">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="margin_start">12</property>
+            <property name="margin_end">12</property>
+            <property name="margin_top">12</property>
+            <property name="margin_bottom">12</property>
+            <property name="row_spacing">12</property>
+            <property name="column_spacing">32</property>
+            <child>
+              <object class="GtkLabel" id="show_applications_icon_file_label">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="hexpand">True</property>
+                <property name="label" translatable="yes">Current Show Applications icon</property>
+                <property name="use_markup">True</property>
+                <property name="xalign">0</property>
+                <layout>
+                  <property name="row">0</property>
+                  <property name="column">0</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkImage" id="show_applications_current_icon_image">
+                <property name="width_request">32</property>
+                <property name="height_request">32</property>
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="halign">end</property>
+                <property name="icon_name">gtk-missing-image</property>
+                <property name="pixel_size">32</property>
+                <layout>
+                  <property name="row">0</property>
+                  <property name="column">1</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkButton" id="show_applications_icon_file_filebutton">
+                <property name="width_request">140</property>
+                <property name="visible">True</property>
+                <layout>
+                  <property name="row">1</property>
+                  <property name="column">1</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkLabel" id="show_applications_custom_icon_file_label">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="hexpand">True</property>
+                <property name="label" translatable="yes">Custom Show Applications image icon</property>
+                <property name="use_markup">True</property>
+                <property name="xalign">0</property>
+                <layout>
+                  <property name="row">1</property>
+                  <property name="column">0</property>
+                </layout>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+    <child>
+      <object class="GtkListBoxRow" id="listboxrow_show_applications_side_padding">
+        <property name="visible">True</property>
+        <property name="can_focus">True</property>
+        <child>
+          <object class="GtkGrid" id="grid_show_applications_side_padding">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="margin_start">12</property>
+            <property name="margin_end">12</property>
+            <property name="margin_top">12</property>
+            <property name="margin_bottom">12</property>
+            <property name="hexpand">True</property>
+            <property name="row_spacing">6</property>
+            <property name="column_spacing">32</property>
+            <child>
+              <object class="GtkSpinButton" id="show_applications_side_padding_spinbutton">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="halign">end</property>
+                <property name="text" translatable="yes">0</property>
+                <property name="adjustment">show_applications_side_padding_adjustment</property>
+                <layout>
+                  <property name="row">0</property>
+                  <property name="column">1</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkLabel" id="show_applications_side_padding_label">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="hexpand">True</property>
+                <property name="label" translatable="yes">Show Applications icon side padding (px)</property>
+                <property name="xalign">0</property>
+                <layout>
+                  <property name="row">0</property>
+                  <property name="column">0</property>
+                </layout>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+    <child>
+      <object class="GtkListBoxRow" id="listboxrow_show_applications_esc_key">
+        <property name="visible">True</property>
+        <property name="can_focus">True</property>
+        <child>
+          <object class="GtkGrid" id="grid_show_applications_esc_key">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="margin_start">12</property>
+            <property name="margin_end">12</property>
+            <property name="margin_top">12</property>
+            <property name="margin_bottom">12</property>
+            <property name="column_spacing">32</property>
+            <child>
+              <object class="GtkSwitch" id="show_applications_esc_key_switch">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="halign">end</property>
+                <property name="valign">center</property>
+                <layout>
+                  <property name="row">0</property>
+                  <property name="column">1</property>
+                </layout>
+              </object>
+            </child>
+            <child>
+              <object class="GtkLabel" id="show_applications_esc_key_label">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="hexpand">True</property>
+                <property name="label" translatable="yes">Override escape key and return to desktop</property>
+                <property name="use_markup">True</property>
+                <property name="xalign">0</property>
+                <layout>
+                  <property name="row">0</property>
+                  <property name="column">0</property>
+                </layout>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From 10a6e2738ebeccf1c663f8ff72e06cd826fe30f0 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 21:12:26 +0200
Subject: [PATCH 16/62] migrate box window preview options dialog

---
 prefs.js                      |    1 +
 ui/BoxWindowPreviewOptions.ui | 1046 +++++++++++++++++++++++++++++++++
 2 files changed, 1047 insertions(+)
 create mode 100644 ui/BoxWindowPreviewOptions.ui

diff --git a/prefs.js b/prefs.js
index a1a41809..8b2420d1 100644
--- a/prefs.js
+++ b/prefs.js
@@ -173,6 +173,7 @@ const Preferences = class {
             this._builder.add_from_file(Me.path + '/ui/BoxDynamicOpacityOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxIntellihideOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/ShowApplicationsOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxWindowPreviewOptions.ui');
 
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
             let pagePosition = this._builder.get_object('position');
diff --git a/ui/BoxWindowPreviewOptions.ui b/ui/BoxWindowPreviewOptions.ui
new file mode 100644
index 00000000..bb9358b2
--- /dev/null
+++ b/ui/BoxWindowPreviewOptions.ui
@@ -0,0 +1,1046 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="preview_timeout_adjustment">
+    <property name="upper">9999</property>
+    <property name="step_increment">25</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkAdjustment" id="preview_animation_time_adjustment">
+    <property name="upper">1000</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">50</property>
+  </object>
+
+  <object class="GtkAdjustment" id="leave_timeout_adjustment">
+    <property name="upper">9999</property>
+    <property name="step_increment">25</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkAdjustment" id="preview_size_adjustment">
+    <property name="lower">100</property>
+    <property name="upper">800</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">50</property>
+  </object>
+
+  <object class="GtkAdjustment" id="preview_padding_adjustment">
+    <property name="upper">50</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">5</property>
+  </object>
+
+  <object class="GtkAdjustment" id="preview_opacity_adjustment">
+    <property name="upper">100</property>
+    <property name="step_increment">5</property>
+    <property name="page_increment">10</property>
+  </object>
+
+  <object class="GtkAdjustment" id="preview_custom_icon_size_adjustment">
+    <property name="lower">8</property>
+    <property name="upper">48</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkAdjustment" id="preview_title_font_size_adjustment">
+    <property name="lower">6</property>
+    <property name="upper">24</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkAdjustment" id="enter_peek_mode_timeout_adjustment">
+    <property name="lower">50</property>
+    <property name="upper">9999</property>
+    <property name="step_increment">25</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkAdjustment" id="peek_mode_opacity_adjustment">
+    <property name="upper">255</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">25</property>
+  </object>
+
+  <object class="GtkScrolledWindow" id="box_window_preview_options">
+    <property name="visible">True</property>
+    <property name="can_focus">True</property>
+    <property name="min_content_width">460</property>
+    <property name="min_content_height">480</property>
+    <child>
+      <object class="GtkViewport" id="viewport_window_preview_options">
+        <property name="visible">True</property>
+        <property name="can_focus">False</property>
+        <property name="hexpand">True</property>
+        <property name="vexpand">True</property>
+        <property name="hscroll_policy">natural</property>
+        <property name="vscroll_policy">natural</property>
+        <child>
+          <object class="GtkListBox" id="listbox_window_preview_options">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="selection_mode">none</property>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_times">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_times">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="row_spacing">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkSpinButton" id="preview_timeout_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="width_chars">4</property>
+                        <property name="text">0</property>
+                        <property name="adjustment">preview_timeout_adjustment</property>
+                        <property name="numeric">True</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="preview_timeout_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Time (ms) before showing (400 is default)</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="animation_time_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Animation time (ms)</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">2</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSpinButton" id="animation_time_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="width_chars">4</property>
+                        <property name="text">0</property>
+                        <property name="adjustment">preview_animation_time_adjustment</property>
+                        <property name="numeric">True</property>
+                        <layout>
+                          <property name="row">2</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkBox" id="preview_hide_box">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="orientation">vertical</property>
+                        <child>
+                          <object class="GtkLabel" id="leave_timeout_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Time (ms) before hiding (100 is default)</property>
+                            <property name="xalign">0</property>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkCheckButton" id="preview_immediate_click_button">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="receives_default">False</property>
+                            <property name="margin_start">12</property>
+                            <property name="margin_top">4</property>
+                            <child>
+                              <object class="GtkLabel" id="preview_immediate_click_label">
+                                <property name="name">4</property>
+                                <property name="visible">True</property>
+                                <property name="can_focus">False</property>
+                                <property name="halign">start</property>
+                                <property name="margin_start">4</property>
+                                <property name="label" translatable="yes">Immediate on application icon click</property>
+                                <property name="use_markup">True</property>
+                              </object>
+                            </child>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSpinButton" id="leave_timeout_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <property name="width_chars">4</property>
+                        <property name="text">25</property>
+                        <property name="adjustment">leave_timeout_adjustment</property>
+                        <property name="numeric">True</property>
+                        <property name="value">25</property>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_preview_middle_click_close">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_preview_middle_click_close">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="preview_middle_click_close_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Middle click on the preview to close the window</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="preview_middle_click_close_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_sizes">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_sizes">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="row_spacing">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="preview_size_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Window previews preferred size (px)</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSpinButton" id="preview_size_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="width_chars">4</property>
+                        <property name="text">100</property>
+                        <property name="adjustment">preview_size_adjustment</property>
+                        <property name="numeric">True</property>
+                        <property name="value">100</property>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="preview_aspect_ratio_y_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Window previews aspect ratio Y (height)</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">2</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="preview_padding_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Window previews padding (px)</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">3</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSpinButton" id="preview_padding_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="width_chars">4</property>
+                        <property name="text">50</property>
+                        <property name="adjustment">preview_padding_adjustment</property>
+                        <property name="numeric">True</property>
+                        <property name="value">50</property>
+                        <layout>
+                          <property name="row">3</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkBox">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="halign">end</property>
+                        <property name="spacing">2</property>
+                        <property name="homogeneous">True</property>
+                        <child>
+                          <object class="GtkComboBoxText" id="preview_aspect_ratio_x_combo">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="halign">end</property>
+                            <property name="valign">center</property>
+                            <items>
+                              <item id="1" translatable="yes">1</item>
+                              <item id="2" translatable="yes">2</item>
+                              <item id="3" translatable="yes">3</item>
+                              <item id="4" translatable="yes">4</item>
+                              <item id="5" translatable="yes">5</item>
+                              <item id="6" translatable="yes">6</item>
+                              <item id="7" translatable="yes">7</item>
+                              <item id="8" translatable="yes">8</item>
+                              <item id="9" translatable="yes">9</item>
+                              <item id="10" translatable="yes">10</item>
+                              <item id="11" translatable="yes">11</item>
+                              <item id="12" translatable="yes">12</item>
+                              <item id="13" translatable="yes">13</item>
+                              <item id="14" translatable="yes">14</item>
+                              <item id="15" translatable="yes">15</item>
+                              <item id="16" translatable="yes">16</item>
+                              <item id="17" translatable="yes">17</item>
+                              <item id="18" translatable="yes">18</item>
+                              <item id="19" translatable="yes">19</item>
+                              <item id="20" translatable="yes">20</item>
+                              <item id="21" translatable="yes">21</item>
+                            </items>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkToggleButton" id="preview_aspect_ratio_x_fixed_togglebutton">
+                            <property name="label" translatable="yes">Fixed</property>
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="receives_default">True</property>
+                            <property name="halign">end</property>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="preview_aspect_ratio_x_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Window previews aspect ratio X (width)</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkBox">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="halign">end</property>
+                        <property name="spacing">2</property>
+                        <property name="homogeneous">True</property>
+                        <child>
+                          <object class="GtkComboBoxText" id="preview_aspect_ratio_y_combo">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="halign">end</property>
+                            <property name="valign">center</property>
+                            <items>
+                              <item id="1" translatable="yes">1</item>
+                              <item id="2" translatable="yes">2</item>
+                              <item id="3" translatable="yes">3</item>
+                              <item id="4" translatable="yes">4</item>
+                              <item id="5" translatable="yes">5</item>
+                              <item id="6" translatable="yes">6</item>
+                              <item id="7" translatable="yes">7</item>
+                              <item id="8" translatable="yes">8</item>
+                              <item id="9" translatable="yes">9</item>
+                              <item id="10" translatable="yes">10</item>
+                              <item id="11" translatable="yes">11</item>
+                              <item id="12" translatable="yes">12</item>
+                              <item id="13" translatable="yes">13</item>
+                              <item id="14" translatable="yes">14</item>
+                              <item id="15" translatable="yes">15</item>
+                              <item id="16" translatable="yes">16</item>
+                              <item id="17" translatable="yes">17</item>
+                              <item id="18" translatable="yes">18</item>
+                              <item id="19" translatable="yes">19</item>
+                              <item id="20" translatable="yes">20</item>
+                              <item id="21" translatable="yes">21</item>
+                            </items>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkToggleButton" id="preview_aspect_ratio_y_fixed_togglebutton">
+                            <property name="label" translatable="yes">Fixed</property>
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="receives_default">True</property>
+                            <property name="halign">end</property>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">2</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_preview_custom_opacity">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_preview_custom_opacity">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="preview_custom_opacity_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Use custom opacity for the previews background</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="preview_custom_opacity_description">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">If disabled, the previews background have the same opacity as the panel</property>
+                        <property name="wrap">True</property>
+                        <property name="max_width_chars">40</property>
+                        <property name="xalign">0</property>
+                        <style>
+                          <class name="dim-label"/>
+                        </style>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkBox">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="spacing">8</property>
+                        <child>
+                          <object class="GtkSwitch" id="preview_custom_opacity_switch">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="halign">end</property>
+                            <property name="valign">center</property>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkSpinButton" id="preview_custom_opacity_spinbutton">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="halign">end</property>
+                            <property name="valign">center</property>
+                            <property name="text" translatable="yes">5</property>
+                            <property name="adjustment">preview_opacity_adjustment</property>
+                            <property name="value">5</property>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_preview_title_position">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkBox" id="preview_title_position_box">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="preview_title_position_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Close button and header position</property>
+                        <property name="xalign">0</property>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkBox" id="preview_title_position_butttons_box">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="halign">end</property>
+                        <property name="spacing">32</property>
+                        <child>
+                          <object class="GtkToggleButton" id="preview_title_position_bottom_button">
+                            <property name="label" translatable="yes">Bottom</property>
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="receives_default">False</property>
+                            <property name="halign">center</property>
+                            <property name="valign">center</property>
+                            <property name="active">True</property>
+                            <signal name="toggled" handler="preview_title_position_bottom_button_toggled_cb" swapped="no"/>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkToggleButton" id="preview_title_position_top_button">
+                            <property name="label" translatable="yes">Top</property>
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="receives_default">False</property>
+                            <property name="halign">center</property>
+                            <property name="valign">center</property>
+                            <property name="group">preview_title_position_bottom_button</property>
+                            <signal name="toggled" handler="preview_title_position_top_button_toggled_cb" swapped="no"/>
+                          </object>
+                        </child>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_preview_show_title">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_preview_show_title">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="preview_show_title_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Display window preview headers</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="preview_show_title_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkGrid" id="grid_preview_custom_icon_size">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="margin_top">12</property>
+                        <property name="column_spacing">32</property>
+                        <child>
+                          <object class="GtkBox">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="spacing">8</property>
+                            <child>
+                              <object class="GtkSwitch" id="preview_custom_icon_size_switch">
+                                <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="halign">end</property>
+                                <property name="valign">center</property>
+                              </object>
+                            </child>
+                            <child>
+                              <object class="GtkSpinButton" id="preview_custom_icon_size_spinbutton">
+                                <property name="visible">True</property>
+                                <property name="can_focus">True</property>
+                                <property name="halign">end</property>
+                                <property name="width_chars">4</property>
+                                <property name="text">6</property>
+                                <property name="adjustment">preview_custom_icon_size_adjustment</property>
+                                <property name="numeric">True</property>
+                                <property name="value">6</property>
+                              </object>
+                            </child>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkLabel" id="preview_custom_icon_size_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Icon size (px) of the window preview</property>
+                            <property name="use_markup">True</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">1</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkLabel" id="preview_custom_icon_size_description">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">If disabled, the previews icon size will be based on headerbar size</property>
+                            <property name="wrap">True</property>
+                            <property name="max_width_chars">40</property>
+                            <property name="xalign">0</property>
+                            <style>
+                              <class name="dim-label"/>
+                            </style>
+                            <layout>
+                              <property name="row">1</property>
+                              <property name="column">0</property>
+                              <property name="column-span">2</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkGrid" id="grid_preview_title_size">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="margin_top">12</property>
+                        <property name="column_spacing">32</property>
+                        <child>
+                          <object class="GtkSpinButton" id="preview_title_size_spinbutton">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="halign">end</property>
+                            <property name="width_chars">4</property>
+                            <property name="text">6</property>
+                            <property name="adjustment">preview_title_font_size_adjustment</property>
+                            <property name="numeric">True</property>
+                            <property name="value">6</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkLabel" id="preview_title_size_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Font size (px) of the preview titles</property>
+                            <property name="use_markup">True</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">2</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkGrid" id="grid_preview_title_weight">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="margin_top">12</property>
+                        <property name="column_spacing">32</property>
+                        <child>
+                          <object class="GtkLabel" id="grid_preview_title_weight_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Font weight of the preview titles</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkComboBoxText" id="grid_preview_title_weight_combo">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="halign">end</property>
+                            <property name="valign">center</property>
+                            <items>
+                              <item id="inherit" translatable="yes">inherit from theme</item>
+                              <item id="normal" translatable="yes">normal</item>
+                              <item id="lighter" translatable="yes">lighter</item>
+                              <item id="bold" translatable="yes">bold</item>
+                              <item id="bolder" translatable="yes">bolder</item>
+                            </items>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">3</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkGrid" id="grid_preview_title_font_color">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="margin_top">12</property>
+                        <property name="column_spacing">32</property>
+                        <child>
+                          <object class="GtkLabel" id="grid_preview_title_font_color_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Font color of the preview titles</property>
+                            <property name="use_markup">True</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkColorButton" id="grid_preview_title_font_color_colorbutton">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="receives_default">True</property>
+                            <property name="halign">end</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">4</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_peek_mode">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <property name="margin_bottom">6</property>
+                <child>
+                  <object class="GtkGrid" id="grid_peek_mode">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="peek_mode_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Enable window peeking</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="peek_mode_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="peek_mode_description">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">When hovering over a window preview for some time, the window gets distinguished.</property>
+                        <property name="wrap">True</property>
+                        <property name="max_width_chars">40</property>
+                        <property name="xalign">0</property>
+                        <style>
+                          <class name="dim-label"/>
+                        </style>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkGrid" id="grid_enter_peek_mode_timeout">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="margin_top">12</property>
+                        <property name="column_spacing">32</property>
+                        <child>
+                          <object class="GtkLabel" id="enter_peek_mode_timeout_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Enter window peeking mode timeout (ms)</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkSpinButton" id="enter_peek_mode_timeout_spinbutton">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="halign">end</property>
+                            <property name="width_chars">4</property>
+                            <property name="text" translatable="yes">50</property>
+                            <property name="adjustment">enter_peek_mode_timeout_adjustment</property>
+                            <property name="numeric">True</property>
+                            <property name="value">50</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkLabel" id="enter_peek_mode_timeout_description">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Time of inactivity while hovering over a window preview needed to enter the window peeking mode.</property>
+                            <property name="wrap">True</property>
+                            <property name="max_width_chars">40</property>
+                            <property name="xalign">0</property>
+                            <style>
+                              <class name="dim-label"/>
+                            </style>
+                            <layout>
+                              <property name="row">1</property>
+                              <property name="column">0</property>
+                              <property name="column-span">2</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">2</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkGrid" id="grid_peek_mode_opacity">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="margin_top">12</property>
+                        <property name="column_spacing">32</property>
+                        <child>
+                          <object class="GtkLabel" id="peek_mode_opacity_label">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">Window peeking mode opacity</property>
+                            <property name="xalign">0</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">0</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkSpinButton" id="peek_mode_opacity_spinbutton">
+                            <property name="visible">True</property>
+                            <property name="can_focus">True</property>
+                            <property name="halign">end</property>
+                            <property name="width_chars">4</property>
+                            <property name="text" translatable="yes">0</property>
+                            <property name="adjustment">peek_mode_opacity_adjustment</property>
+                            <property name="numeric">True</property>
+                            <layout>
+                              <property name="row">0</property>
+                              <property name="column">1</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <child>
+                          <object class="GtkLabel" id="peek_mode_opacity_description">
+                            <property name="visible">True</property>
+                            <property name="can_focus">False</property>
+                            <property name="hexpand">True</property>
+                            <property name="label" translatable="yes">All windows except for the peeked one have their opacity set to the same value.</property>
+                            <property name="wrap">True</property>
+                            <property name="max_width_chars">40</property>
+                            <property name="xalign">0</property>
+                            <style>
+                              <class name="dim-label"/>
+                            </style>
+                            <layout>
+                              <property name="row">1</property>
+                              <property name="column">0</property>
+                              <property name="column-span">2</property>
+                            </layout>
+                          </object>
+                        </child>
+                        <layout>
+                          <property name="row">3</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From 3732c9ed2acf725b8abd954f08640694aa7d38da Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 21:15:17 +0200
Subject: [PATCH 17/62] migrate box group apps options dialog

---
 prefs.js                  |   2 +
 ui/BoxGroupAppsOptions.ui | 410 ++++++++++++++++++++++++++++++++++++++
 2 files changed, 412 insertions(+)
 create mode 100644 ui/BoxGroupAppsOptions.ui

diff --git a/prefs.js b/prefs.js
index 8b2420d1..6d42e963 100644
--- a/prefs.js
+++ b/prefs.js
@@ -174,7 +174,9 @@ const Preferences = class {
             this._builder.add_from_file(Me.path + '/ui/BoxIntellihideOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/ShowApplicationsOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxWindowPreviewOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxGroupAppsOptions.ui');
 
+            // pages
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
             let pagePosition = this._builder.get_object('position');
             window.add(pagePosition);
diff --git a/ui/BoxGroupAppsOptions.ui b/ui/BoxGroupAppsOptions.ui
new file mode 100644
index 00000000..07cff47f
--- /dev/null
+++ b/ui/BoxGroupAppsOptions.ui
@@ -0,0 +1,410 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="group_apps_label_font_size_adjustment">
+    <property name="lower">6</property>
+    <property name="upper">24</property>
+    <property name="step_increment">1</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkAdjustment" id="group_apps_label_max_width_adjustment">
+    <property name="upper">1000</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">100</property>
+  </object>
+
+  <object class="GtkBox" id="box_group_apps_options">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="orientation">vertical</property>
+    <property name="hexpand">1</property>
+    <property name="vexpand">1</property>
+    <child>
+      <object class="GtkFrame" id="frame_group_apps_options">
+        <property name="visible">True</property>
+        <property name="can_focus">False</property>
+        <property name="label_xalign">0</property>
+        <child>
+          <object class="GtkListBox" id="listbox_group_apps_options">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="selection_mode">none</property>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_group_apps_label_font_size">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_group_apps_label_font_size">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkSpinButton" id="group_apps_label_font_size_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="width_chars">4</property>
+                        <property name="text">0</property>
+                        <property name="adjustment">group_apps_label_font_size_adjustment</property>
+                        <property name="numeric">True</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="group_apps_label_font_size_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Font size (px) of the application titles (default is 14)</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_group_apps_label_font_weight">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_group_apps_label_font_weight">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="group_apps_label_font_weight_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Font weight of application titles</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkComboBoxText" id="group_apps_label_font_weight_combo">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="valign">center</property>
+                        <items>
+                          <item id="inherit" translatable="yes">inherit from theme</item>
+                          <item id="normal" translatable="yes">normal</item>
+                          <item id="lighter" translatable="yes">lighter</item>
+                          <item id="bold" translatable="yes">bold</item>
+                          <item id="bolder" translatable="yes">bolder</item>
+                        </items>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_group_apps_label_font_color">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_group_apps_label_font_color">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="group_apps_label_font_color_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Font color of the application titles</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkColorButton" id="group_apps_label_font_color_colorbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="receives_default">True</property>
+                        <property name="halign">end</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_group_apps_label_font_color_minimized">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_group_apps_label_font_color_minimized">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="group_apps_label_font_color_minimized_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Font color of the minimized application titles</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkColorButton" id="group_apps_label_font_color_minimized_colorbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="receives_default">True</property>
+                        <property name="halign">end</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_group_apps_label_max_width">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_group_apps_label_max_width">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="group_apps_label_max_width_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Maximum width (px) of the application titles (default is 160)</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSpinButton" id="group_apps_label_max_width_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="width_chars">4</property>
+                        <property name="text">0</property>
+                        <property name="adjustment">group_apps_label_max_width_adjustment</property>
+                        <property name="numeric">True</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_group_apps_use_fixed_width">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_group_apps_use_fixed_width">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="group_apps_use_fixed_width_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Use a fixed width for the application titles</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="group_apps_use_fixed_width_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="group_apps_use_fixed_width_description">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">The application titles all have the same width, even if their texts are shorter than the maximum width. The maximum width value is used as the fixed width.</property>
+                        <property name="wrap">True</property>
+                        <property name="max_width_chars">40</property>
+                        <property name="xalign">0</property>
+                        <style>
+                          <class name="dim-label"/>
+                        </style>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                          <property name="column-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_group_apps_underline_unfocused">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_group_apps_underline_unfocused">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="group_apps_underline_unfocused_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Display running indicators on unfocused applications</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="group_apps_underline_unfocused_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_group_apps_use_launchers">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_group_apps_use_launchers">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="group_apps_use_launchers_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Use the favorite icons as application launchers</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="group_apps_use_launchers_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From 94315f6aecb24aede921ec4235827da57cd17acb Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 21:17:27 +0200
Subject: [PATCH 18/62] migrate box middle click options

---
 prefs.js                    |   1 +
 ui/BoxMiddleClickOptions.ui | 245 ++++++++++++++++++++++++++++++++++++
 2 files changed, 246 insertions(+)
 create mode 100644 ui/BoxMiddleClickOptions.ui

diff --git a/prefs.js b/prefs.js
index 6d42e963..55f0d4b9 100644
--- a/prefs.js
+++ b/prefs.js
@@ -175,6 +175,7 @@ const Preferences = class {
             this._builder.add_from_file(Me.path + '/ui/ShowApplicationsOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxWindowPreviewOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxGroupAppsOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxMiddleClickOptions.ui');
 
             // pages
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
diff --git a/ui/BoxMiddleClickOptions.ui b/ui/BoxMiddleClickOptions.ui
new file mode 100644
index 00000000..1f0c8125
--- /dev/null
+++ b/ui/BoxMiddleClickOptions.ui
@@ -0,0 +1,245 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkBox" id="box_middle_click_options">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="margin_start">12</property>
+    <property name="margin_end">12</property>
+    <property name="margin_top">12</property>
+    <property name="margin_bottom">12</property>
+    <property name="orientation">vertical</property>
+    <property name="hexpand">1</property>
+    <property name="vexpand">1</property>
+    <child>
+      <object class="GtkFrame" id="frame_middle_click_options">
+        <property name="visible">True</property>
+        <property name="can_focus">False</property>
+        <property name="label_xalign">0</property>
+        <child>
+          <object class="GtkListBox" id="listbox_middle_click_options">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="selection_mode">none</property>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow11">
+                <property name="width_request">100</property>
+                <property name="height_request">80</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="buitin_theme7">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="builtin_theme_description4">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">When set to minimize, double clicking minimizes all the windows of the application.</property>
+                        <property name="wrap">True</property>
+                        <property name="max_width_chars">40</property>
+                        <property name="xalign">0</property>
+                        <style>
+                          <class name="dim-label"/>
+                        </style>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="builtin_theme_label4">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Shift+Click action</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkComboBoxText" id="shift_click_action_combo">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="valign">center</property>
+                        <items>
+                          <item id="RAISE" translatable="yes">Raise windows</item>
+                          <item id="MINIMIZE" translatable="yes">Minimize window</item>
+                          <item id="LAUNCH" translatable="yes">Launch new instance</item>
+                          <item id="CYCLE" translatable="yes">Cycle through windows</item>
+                          <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
+                          <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
+                          <item id="TOGGLE-CYCLE" translatable="yes">Toggle single / Cycle multiple</item>
+                          <item id="QUIT" translatable="yes">Quit</item>
+                        </items>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                          <property name="row-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_middle_click">
+                <property name="width_request">100</property>
+                <property name="height_request">80</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_middle_click">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="description_middle_click">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Behavior for Middle-Click.</property>
+                        <property name="wrap">True</property>
+                        <property name="max_width_chars">40</property>
+                        <property name="xalign">0</property>
+                        <style>
+                          <class name="dim-label"/>
+                        </style>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="label_middle_click">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Middle-Click action</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkComboBoxText" id="middle_click_action_combo">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="valign">center</property>
+                        <items>
+                          <item id="RAISE" translatable="yes">Raise windows</item>
+                          <item id="MINIMIZE" translatable="yes">Minimize window</item>
+                          <item id="LAUNCH" translatable="yes">Launch new instance</item>
+                          <item id="CYCLE" translatable="yes">Cycle through windows</item>
+                          <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
+                          <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
+                          <item id="QUIT" translatable="yes">Quit</item>
+                        </items>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                          <property name="row-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_shift_middle_click">
+                <property name="width_request">100</property>
+                <property name="height_request">80</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_shift_middle_click">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="description_shift_middle_click">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Behavior for Shift+Middle-Click.</property>
+                        <property name="wrap">True</property>
+                        <property name="max_width_chars">40</property>
+                        <property name="xalign">0</property>
+                        <style>
+                          <class name="dim-label"/>
+                        </style>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="label_shift_middle_click">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Shift+Middle-Click action</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkComboBoxText" id="shift_middle_click_action_combo">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="valign">center</property>
+                        <items>
+                          <item id="RAISE" translatable="yes">Raise windows</item>
+                          <item id="MINIMIZE" translatable="yes">Minimize window</item>
+                          <item id="LAUNCH" translatable="yes">Launch new instance</item>
+                          <item id="CYCLE" translatable="yes">Cycle through windows</item>
+                          <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
+                          <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
+                          <item id="QUIT" translatable="yes">Quit</item>
+                        </items>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                          <property name="row-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From e5131668f05ffaf217970a4245dfdc1dbfad8eeb Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 21:30:47 +0200
Subject: [PATCH 19/62] migrate box overlay shortcut dialog

---
 prefs.js                 |   1 +
 ui/BoxOverlayShortcut.ui | 399 +++++++++++++++++++++++++++++++++++++++
 2 files changed, 400 insertions(+)
 create mode 100644 ui/BoxOverlayShortcut.ui

diff --git a/prefs.js b/prefs.js
index 55f0d4b9..82664f41 100644
--- a/prefs.js
+++ b/prefs.js
@@ -176,6 +176,7 @@ const Preferences = class {
             this._builder.add_from_file(Me.path + '/ui/BoxWindowPreviewOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxGroupAppsOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxMiddleClickOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxOverlayShortcut.ui');
 
             // pages
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
diff --git a/ui/BoxOverlayShortcut.ui b/ui/BoxOverlayShortcut.ui
new file mode 100644
index 00000000..85c678e1
--- /dev/null
+++ b/ui/BoxOverlayShortcut.ui
@@ -0,0 +1,399 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="shortcut_time_adjustment">
+    <property name="upper">10000</property>
+    <property name="step_increment">250</property>
+    <property name="page_increment">1000</property>
+  </object>
+
+  <object class="GtkBox" id="box_overlay_shortcut">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="margin_start">12</property>
+    <property name="margin_end">12</property>
+    <property name="margin_top">12</property>
+    <property name="margin_bottom">12</property>
+    <property name="orientation">vertical</property>
+    <property name="hexpand">1</property>
+    <property name="vexpand">1</property>
+    <child>
+      <object class="GtkFrame" id="frame_overlay_show_dock">
+        <property name="visible">True</property>
+        <property name="can_focus">False</property>
+        <property name="label_xalign">0</property>
+        <child>
+          <object class="GtkListBox" id="listbox_overlay_shortcut">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="selection_mode">none</property>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_hotkey_prefix">
+                <property name="width_request">100</property>
+                <property name="height_request">80</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_hotkey_prefix">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkComboBoxText" id="hotkey_prefix_combo">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="valign">center</property>
+                        <items>
+                          <item id="Super" translatable="yes">Super</item>
+                          <item id="SuperAlt" translatable="yes">Super + Alt</item>
+                        </items>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                          <property name="row-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="hotkey_prefix_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Hotkeys prefix</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="hotkey_prefix_description">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="label" translatable="yes">Hotkeys will either be Super+Number or Super+Alt+Num</property>
+                        <property name="wrap">True</property>
+                        <property name="max_width_chars">40</property>
+                        <property name="xalign">0</property>
+                        <style>
+                          <class name="dim-label"/>
+                        </style>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_overlay_shortcut">
+                <property name="width_request">100</property>
+                <property name="height_request">80</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_overlay">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkComboBoxText" id="overlay_combo">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="valign">center</property>
+                        <items>
+                          <item id="NEVER" translatable="yes">Never</item>
+                          <item id="TEMPORARILY" translatable="yes">Show temporarily</item>
+                          <item id="ALWAYS" translatable="yes">Always visible</item>
+                        </items>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                          <property name="row-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="overlay_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Number overlay</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="overlay_description">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="label" translatable="yes">Temporarily show the application numbers over the icons when using the hotkeys.</property>
+                        <property name="wrap">True</property>
+                        <property name="max_width_chars">40</property>
+                        <property name="xalign">0</property>
+                        <style>
+                          <class name="dim-label"/>
+                        </style>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_timeout">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_timeout">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="hexpand">True</property>
+                    <property name="row_spacing">6</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkSpinButton" id="timeout_spinbutton">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="adjustment">shortcut_time_adjustment</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="shortcut_timeout_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Hide timeout (ms)</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_extra_shortcut">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_shortcut">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkEntry" id="shortcut_entry">
+                        <property name="can_focus">True</property>
+                        <property name="valign">center</property>
+                        <property name="width_chars">12</property>
+                        <property name="placeholder_text" translatable="yes">e.g. &lt;Super&gt;q</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                          <property name="row-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="shortcut_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Shortcut to show the overlay for 2 seconds</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="shortcut_description">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="label" translatable="yes">Syntax: &lt;Shift&gt;, &lt;Ctrl&gt;, &lt;Alt&gt;, &lt;Super&gt;</property>
+                        <property name="wrap">True</property>
+                        <property name="max_width_chars">40</property>
+                        <property name="xalign">0</property>
+                        <style>
+                          <class name="dim-label"/>
+                        </style>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_shortcut_preview">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_shortcut_preview">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="shortcut_preview_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Show window previews on hotkey</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="shortcut_preview_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                          <property name="row-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="shortcut_preview_description">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Show previews when the application have multiple instances</property>
+                        <property name="wrap">True</property>
+                        <property name="max_width_chars">40</property>
+                        <property name="xalign">0</property>
+                        <style>
+                          <class name="dim-label"/>
+                        </style>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_shortcut_num_keys">
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_shortcut_num_keys">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkComboBoxText" id="shortcut_num_keys_combo">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <items>
+                          <item id="NUM_ROW" translatable="yes">Number row</item>
+                          <item id="NUM_KEYPAD" translatable="yes">Numeric keypad</item>
+                          <item id="BOTH" translatable="yes">Both</item>
+                        </items>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                          <property name="row-span">2</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="shortcut_num_keys_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Hotkeys are activated with</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkLabel" id="shortcut_num_keys_description">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="label" translatable="yes">Select which keyboard number keys are used to activate the hotkeys</property>
+                        <property name="wrap">True</property>
+                        <property name="max_width_chars">40</property>
+                        <property name="xalign">0</property>
+                        <style>
+                          <class name="dim-label"/>
+                        </style>
+                        <layout>
+                          <property name="row">1</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From de3a106bad9631784cd8925664d5fbf207c4ad7b Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 21:31:09 +0200
Subject: [PATCH 20/62] add advanced options button

---
 ui/SettingsFineTune.ui | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/ui/SettingsFineTune.ui b/ui/SettingsFineTune.ui
index 1b7ed5ed..29126ee5 100644
--- a/ui/SettingsFineTune.ui
+++ b/ui/SettingsFineTune.ui
@@ -269,5 +269,22 @@
         </object>
       </child>
 
+      <!-- group advanced-->
+      <child>
+        <object class="AdwPreferencesGroup" id="finetune_group_advanced">
+
+          <child>
+            <object class="GtkButton" id="button_advanced_options">
+              <property name="label" translatable="yes">Advanced Options</property>
+              <property name="visible">False</property>
+              <property name="can_focus">True</property>
+              <property name="receives_default">True</property>
+              <property name="halign">end</property>
+            </object>
+          </child>
+
+        </object>
+      </child>
+
   </object>
 </interface>
\ No newline at end of file

From 20a522607ef66cd4d34c78b8e9cce49e210f101d Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 21:35:40 +0200
Subject: [PATCH 21/62] most things work now

---
 prefs.js | 3 ---
 1 file changed, 3 deletions(-)

diff --git a/prefs.js b/prefs.js
index 82664f41..35031ffc 100644
--- a/prefs.js
+++ b/prefs.js
@@ -206,9 +206,6 @@ const Preferences = class {
             // set the window as notebook, it is being used as parent for dialogs
             this.notebook = window;
 
-            // TODO return for now, many things are still missing
-            return;
-
         } else {
             this._builder.add_from_file(Me.path + '/Settings.ui');
             this.notebook = this._builder.get_object('settings_notebook');

From 87aa7fb62becafd752819f62a5e053be361b1d31 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 21:39:50 +0200
Subject: [PATCH 22/62] migrate box secondary menu options dialog

---
 prefs.js                      |   1 +
 ui/BoxSecondaryMenuOptions.ui | 119 ++++++++++++++++++++++++++++++++++
 2 files changed, 120 insertions(+)
 create mode 100644 ui/BoxSecondaryMenuOptions.ui

diff --git a/prefs.js b/prefs.js
index 35031ffc..592a7a72 100644
--- a/prefs.js
+++ b/prefs.js
@@ -177,6 +177,7 @@ const Preferences = class {
             this._builder.add_from_file(Me.path + '/ui/BoxGroupAppsOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxMiddleClickOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxOverlayShortcut.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxSecondaryMenuOptions.ui');
 
             // pages
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
diff --git a/ui/BoxSecondaryMenuOptions.ui b/ui/BoxSecondaryMenuOptions.ui
new file mode 100644
index 00000000..c58ba17f
--- /dev/null
+++ b/ui/BoxSecondaryMenuOptions.ui
@@ -0,0 +1,119 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkBox" id="box_secondarymenu_options">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="orientation">vertical</property>
+    <property name="hexpand">1</property>
+    <property name="vexpand">1</property>
+    <child>
+      <object class="GtkFrame" id="frame_secondarymenu_options">
+        <property name="visible">True</property>
+        <property name="can_focus">False</property>
+        <property name="label_xalign">0</property>
+        <child>
+          <object class="GtkListBox" id="listbox_secondarymenu_options">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="selection_mode">none</property>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_secondarymenu_appmenu">
+                <property name="width_request">100</property>
+                <property name="height_request">80</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_secondarymenu_appmenu">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="valign">center</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="secondarymenu_appmenu_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">Integrate &lt;i&gt;AppMenu&lt;/i&gt; items</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="secondarymenu_appmenu_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+            <child>
+              <object class="GtkListBoxRow" id="listboxrow_secondarymenu_showdetails">
+                <property name="width_request">100</property>
+                <property name="height_request">80</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkGrid" id="grid_secondarymenu_showdetails">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="valign">center</property>
+                    <property name="margin_start">12</property>
+                    <property name="margin_end">12</property>
+                    <property name="margin_top">12</property>
+                    <property name="margin_bottom">12</property>
+                    <property name="column_spacing">32</property>
+                    <child>
+                      <object class="GtkLabel" id="secondarymenu_showdetails_label">
+                        <property name="visible">True</property>
+                        <property name="can_focus">False</property>
+                        <property name="hexpand">True</property>
+                        <property name="label" translatable="yes">&lt;i&gt;Show Details&lt;/i&gt; menu item</property>
+                        <property name="use_markup">True</property>
+                        <property name="xalign">0</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">0</property>
+                        </layout>
+                      </object>
+                    </child>
+                    <child>
+                      <object class="GtkSwitch" id="secondarymenu_showdetails_switch">
+                        <property name="visible">True</property>
+                        <property name="can_focus">True</property>
+                        <property name="halign">end</property>
+                        <property name="valign">center</property>
+                        <layout>
+                          <property name="row">0</property>
+                          <property name="column">1</property>
+                        </layout>
+                      </object>
+                    </child>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From 3c12a114eb9878ecc2d5ab2efdb8839cfb41c9fe Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 21:47:10 +0200
Subject: [PATCH 23/62] migrate scroll panel options box dialog

---
 prefs.js                    |   1 +
 ui/ScrollPanelOptionsBox.ui | 153 ++++++++++++++++++++++++++++++++++++
 2 files changed, 154 insertions(+)
 create mode 100644 ui/ScrollPanelOptionsBox.ui

diff --git a/prefs.js b/prefs.js
index 592a7a72..584e1041 100644
--- a/prefs.js
+++ b/prefs.js
@@ -178,6 +178,7 @@ const Preferences = class {
             this._builder.add_from_file(Me.path + '/ui/BoxMiddleClickOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxOverlayShortcut.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxSecondaryMenuOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/ScrollPanelOptionsBox.ui');
 
             // pages
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
diff --git a/ui/ScrollPanelOptionsBox.ui b/ui/ScrollPanelOptionsBox.ui
new file mode 100644
index 00000000..95c7fd5d
--- /dev/null
+++ b/ui/ScrollPanelOptionsBox.ui
@@ -0,0 +1,153 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="scroll_panel_options_delay_adjustment">
+    <property name="upper">2000</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">50</property>
+  </object>
+
+  <object class="GtkBox" id="scroll_panel_options_box">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="orientation">vertical</property>
+    <property name="hexpand">1</property>
+    <property name="vexpand">1</property>
+    <child>
+      <object class="GtkListBox" id="scroll_panel_options_listbox">
+        <property name="visible">True</property>
+        <property name="can_focus">False</property>
+        <property name="selection_mode">none</property>
+        <child>
+          <object class="GtkListBoxRow" id="listboxrow_scroll_panel_options_delay">
+            <property name="visible">True</property>
+            <property name="can_focus">True</property>
+            <child>
+              <object class="GtkGrid" id="grid_scroll_panel_options_delay">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="margin_start">12</property>
+                <property name="margin_end">12</property>
+                <property name="margin_top">12</property>
+                <property name="margin_bottom">12</property>
+                <property name="column_spacing">32</property>
+                <child>
+                  <object class="GtkSpinButton" id="scroll_panel_options_delay_spinbutton">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="halign">end</property>
+                    <property name="valign">center</property>
+                    <property name="width_chars">4</property>
+                    <property name="text">50</property>
+                    <property name="adjustment">scroll_panel_options_delay_adjustment</property>
+                    <property name="numeric">True</property>
+                    <property name="value">50</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">1</property>
+                      <property name="row-span">2</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkLabel" id="scroll_panel_options_delay_label">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="label" translatable="yes">Delay between mouse scroll events (ms)</property>
+                    <property name="use_markup">True</property>
+                    <property name="xalign">0</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">0</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkLabel" id="scroll_panel_options_delay_description">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="label" translatable="yes">Use this value to limit the number of captured mouse scroll events.</property>
+                    <property name="wrap">True</property>
+                    <property name="xalign">0</property>
+                    <style>
+                      <class name="dim-label"/>
+                    </style>
+                    <layout>
+                      <property name="row">1</property>
+                      <property name="column">0</property>
+                    </layout>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+        <child>
+          <object class="GtkListBoxRow" id="listboxrow_scroll_panel_options_show_ws_popup">
+            <property name="visible">True</property>
+            <property name="can_focus">True</property>
+            <child>
+              <object class="GtkGrid" id="grid_scroll_panel_options_show_ws_popup">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="margin_start">12</property>
+                <property name="margin_end">12</property>
+                <property name="margin_top">12</property>
+                <property name="margin_bottom">12</property>
+                <property name="column_spacing">32</property>
+                <child>
+                  <object class="GtkLabel" id="scroll_panel_options_show_ws_popup_label">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="label" translatable="yes">Show popup when changing workspace</property>
+                    <property name="use_markup">True</property>
+                    <property name="xalign">0</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">0</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkLabel" id="scroll_panel_options_show_ws_popup_description">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="label" translatable="yes">This affects workspace popup when scrolling on the panel only.</property>
+                    <property name="wrap">True</property>
+                    <property name="xalign">0</property>
+                    <style>
+                      <class name="dim-label"/>
+                    </style>
+                    <layout>
+                      <property name="row">1</property>
+                      <property name="column">0</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkSwitch" id="scroll_panel_options_show_ws_popup_switch">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="halign">end</property>
+                    <property name="valign">center</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">1</property>
+                      <property name="row-span">2</property>
+                    </layout>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From e4190415d05e3eea8ae7dc8d6e06918335219cbc Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 22:08:20 +0200
Subject: [PATCH 24/62] migrate scroll icon options box dialog

---
 prefs.js                   |  1 +
 ui/ScrollIconOptionsBox.ui | 92 ++++++++++++++++++++++++++++++++++++++
 2 files changed, 93 insertions(+)
 create mode 100644 ui/ScrollIconOptionsBox.ui

diff --git a/prefs.js b/prefs.js
index 584e1041..32cf89de 100644
--- a/prefs.js
+++ b/prefs.js
@@ -179,6 +179,7 @@ const Preferences = class {
             this._builder.add_from_file(Me.path + '/ui/BoxOverlayShortcut.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxSecondaryMenuOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/ScrollPanelOptionsBox.ui');
+            this._builder.add_from_file(Me.path + '/ui/ScrollIconOptionsBox.ui');
 
             // pages
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
diff --git a/ui/ScrollIconOptionsBox.ui b/ui/ScrollIconOptionsBox.ui
new file mode 100644
index 00000000..27af04e4
--- /dev/null
+++ b/ui/ScrollIconOptionsBox.ui
@@ -0,0 +1,92 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkAdjustment" id="scroll_icon_options_delay_adjustment">
+    <property name="upper">2000</property>
+    <property name="step_increment">10</property>
+    <property name="page_increment">50</property>
+  </object>
+
+  <object class="GtkBox" id="scroll_icon_options_box">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="orientation">vertical</property>
+    <property name="hexpand">1</property>
+    <property name="vexpand">1</property>
+    <child>
+      <object class="GtkListBox" id="scroll_icon_options_listbox">
+        <property name="visible">True</property>
+        <property name="can_focus">False</property>
+        <property name="selection_mode">none</property>
+        <child>
+          <object class="GtkListBoxRow" id="listboxrow_scroll_icon_options_delay">
+            <property name="visible">True</property>
+            <property name="can_focus">True</property>
+            <child>
+              <object class="GtkGrid" id="grid_scroll_icon_options_delay">
+                <property name="visible">True</property>
+                <property name="can_focus">False</property>
+                <property name="margin_start">12</property>
+                <property name="margin_end">12</property>
+                <property name="margin_top">12</property>
+                <property name="margin_bottom">12</property>
+                <property name="column_spacing">32</property>
+                <child>
+                  <object class="GtkSpinButton" id="scroll_icon_options_delay_spinbutton">
+                    <property name="visible">True</property>
+                    <property name="can_focus">True</property>
+                    <property name="halign">end</property>
+                    <property name="valign">center</property>
+                    <property name="width_chars">4</property>
+                    <property name="text">50</property>
+                    <property name="adjustment">scroll_icon_options_delay_adjustment</property>
+                    <property name="numeric">True</property>
+                    <property name="value">50</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">1</property>
+                      <property name="row-span">2</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkLabel" id="scroll_icon_options_delay_label">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="label" translatable="yes">Delay between mouse scroll events (ms)</property>
+                    <property name="use_markup">True</property>
+                    <property name="xalign">0</property>
+                    <layout>
+                      <property name="row">0</property>
+                      <property name="column">0</property>
+                    </layout>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkLabel" id="scroll_icon_options_delay_description">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="label" translatable="yes">Use this value to limit the number of captured mouse scroll events.</property>
+                    <property name="wrap">True</property>
+                    <property name="xalign">0</property>
+                    <style>
+                      <class name="dim-label"/>
+                    </style>
+                    <layout>
+                      <property name="row">1</property>
+                      <property name="column">0</property>
+                    </layout>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From 721cd3218def822a65ac74c744422d2010ac16f4 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 6 Apr 2022 22:12:19 +0200
Subject: [PATCH 25/62] migrate box advanced options dialog

---
 prefs.js                 |  1 +
 ui/BoxAdvancedOptions.ui | 44 ++++++++++++++++++++++++++++++++++++++++
 2 files changed, 45 insertions(+)
 create mode 100644 ui/BoxAdvancedOptions.ui

diff --git a/prefs.js b/prefs.js
index 32cf89de..fc58f3c5 100644
--- a/prefs.js
+++ b/prefs.js
@@ -180,6 +180,7 @@ const Preferences = class {
             this._builder.add_from_file(Me.path + '/ui/BoxSecondaryMenuOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/ScrollPanelOptionsBox.ui');
             this._builder.add_from_file(Me.path + '/ui/ScrollIconOptionsBox.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxAdvancedOptions.ui');
 
             // pages
             this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
diff --git a/ui/BoxAdvancedOptions.ui b/ui/BoxAdvancedOptions.ui
new file mode 100644
index 00000000..fd71fc04
--- /dev/null
+++ b/ui/BoxAdvancedOptions.ui
@@ -0,0 +1,44 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<interface>
+  <requires lib="gtk" version="4.0"/>
+
+  <object class="GtkBox" id="box_advanced_options">
+    <property name="visible">True</property>
+    <property name="can_focus">False</property>
+    <property name="orientation">vertical</property>
+    <property name="hexpand">1</property>
+    <property name="vexpand">1</property>
+    <child>
+      <object class="GtkFrame" id="frame_advanced_options">
+        <property name="visible">True</property>
+        <property name="can_focus">False</property>
+        <property name="label_xalign">0</property>
+        <child>
+          <object class="GtkListBox" id="listbox_advanced_options">
+            <property name="visible">True</property>
+            <property name="can_focus">False</property>
+            <property name="selection_mode">none</property>
+            <child>
+              <object class="GtkListBoxRow" id="listbox_advanced_nothing">
+                <property name="width_request">100</property>
+                <property name="height_request">80</property>
+                <property name="visible">True</property>
+                <property name="can_focus">True</property>
+                <child>
+                  <object class="GtkLabel" id="advanced_nothing_label">
+                    <property name="visible">True</property>
+                    <property name="can_focus">False</property>
+                    <property name="hexpand">True</property>
+                    <property name="label" translatable="yes">Nothing yet!</property>
+                    <property name="use_markup">True</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+      </object>
+    </child>
+  </object>
+
+</interface>
\ No newline at end of file

From 7c1c1b306be5f85e05bdac2d2ba166b6a5fb8f3c Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Thu, 7 Apr 2022 00:35:37 +0200
Subject: [PATCH 26/62] move preferences dialog create into
 _createPreferencesDialog

---
 prefs.js | 696 ++++++++++++++++++++-----------------------------------
 1 file changed, 252 insertions(+), 444 deletions(-)

diff --git a/prefs.js b/prefs.js
index fc58f3c5..02d7997d 100644
--- a/prefs.js
+++ b/prefs.js
@@ -481,18 +481,51 @@ const Preferences = class {
         });
     }
 
-    _showShowAppsButtonOptions() {
-        let dialog = new Gtk.Dialog({ title: _('Show Applications options'),
+    _createPreferencesDialog(title, content, reset_function = null) {
+        let dialog;
+        
+        if (true) { // Config.PACKAGE_VERSION < '42') {
+            dialog = new Gtk.Dialog({ title: title,
                                         transient_for: this.notebook.get_root(),
                                         use_header_bar: true,
                                         modal: true });
 
-        // GTK+ leaves positive values for application-defined response ids.
-        // Use +1 for the reset action
-        dialog.add_button(_('Reset to defaults'), 1);
+            // GTK+ leaves positive values for application-defined response ids.
+            // Use +1 for the reset action
+            if (reset_function != null)
+                dialog.add_button(_('Reset to defaults'), 1);
+
+            dialog.get_content_area().append(content);
+    
+            dialog.connect('response', (dialog, id) => {
+                if (id == 1) {
+                    // restore default settings
+                    if (reset_function)
+                      reset_function();
+                } else {
+                    // remove the settings content so it doesn't get destroyed;
+                    dialog.get_content_area().remove(content);
+                    dialog.destroy();
+                }
+                return;
+            });
+        } else {
+            dialog = new Adw.PreferencesWindow({ title: title });
+        }
+        return dialog;
+    }
 
+    _showShowAppsButtonOptions() {
         let box = this._builder.get_object('show_applications_options');
-        dialog.get_content_area().append(box);
+
+        let dialog = this._createPreferencesDialog(_('Show Applications options'), box, () =>
+        {
+            // restore default settings
+            this._settings.set_value('show-apps-icon-side-padding', this._settings.get_default_value('show-apps-icon-side-padding'));
+            this._builder.get_object('show_applications_side_padding_spinbutton').set_value(this._settings.get_int('show-apps-icon-side-padding'));
+            this._settings.set_value('show-apps-override-escape', this._settings.get_default_value('show-apps-override-escape'));
+            handleIconChange.call(this, null);
+        });
 
         let fileChooserButton = this._builder.get_object('show_applications_icon_file_filebutton');
         let fileChooser = new Gtk.FileChooserNative({ title: _('Open icon'), transient_for: dialog });
@@ -527,17 +560,9 @@ const Preferences = class {
         fileChooser.connect('response', widget => handleIconChange.call(this, widget.get_file().get_path()));
         handleIconChange.call(this, this._settings.get_string('show-apps-icon-file'));
 
+        // we have to destroy the fileChooser as well
         dialog.connect('response', (dialog, id) => {
-            if (id == 1) {
-                // restore default settings
-                this._settings.set_value('show-apps-icon-side-padding', this._settings.get_default_value('show-apps-icon-side-padding'));
-                this._builder.get_object('show_applications_side_padding_spinbutton').set_value(this._settings.get_int('show-apps-icon-side-padding'));
-                this._settings.set_value('show-apps-override-escape', this._settings.get_default_value('show-apps-override-escape'));
-                handleIconChange.call(this, null);
-            } else {
-                // remove the settings box so it doesn't get destroyed;
-                dialog.get_content_area().remove(box);
-                dialog.destroy();
+            if (id != 1) {
                 fileChooser.destroy();
             }
             return;
@@ -548,17 +573,24 @@ const Preferences = class {
     }
 
     _showDesktopButtonOptions() {
-        let dialog = new Gtk.Dialog({ title: _('Show Desktop options'),
-                                        transient_for: this.notebook.get_root(),
-                                        use_header_bar: true,
-                                        modal: true });
+        let box = this._builder.get_object('box_show_showdesktop_options');
+        
+        let dialog = this._createPreferencesDialog(_('Show Desktop options'), box, () =>
+        {
+            // restore default settings
+            this._settings.set_value('showdesktop-button-width', this._settings.get_default_value('showdesktop-button-width'));
+            this._builder.get_object('show_showdesktop_width_spinbutton').set_value(this._settings.get_int('showdesktop-button-width'));
 
-        // GTK+ leaves positive values for application-defined response ids.
-        // Use +1 for the reset action
-        dialog.add_button(_('Reset to defaults'), 1);
+            this._settings.set_value('desktop-line-use-custom-color', this._settings.get_default_value('desktop-line-use-custom-color'));
 
-        let box = this._builder.get_object('box_show_showdesktop_options');
-        dialog.get_content_area().append(box);
+            this._settings.set_value('show-showdesktop-hover', this._settings.get_default_value('show-showdesktop-hover'));
+
+            this._settings.set_value('show-showdesktop-delay', this._settings.get_default_value('show-showdesktop-delay'));
+            this._builder.get_object('show_showdesktop_delay_spinbutton').set_value(this._settings.get_int('show-showdesktop-delay'));
+
+            this._settings.set_value('show-showdesktop-time', this._settings.get_default_value('show-showdesktop-time'));
+            this._builder.get_object('show_showdesktop_time_spinbutton').set_value(this._settings.get_int('show-showdesktop-time'));
+        });
 
         this._builder.get_object('show_showdesktop_width_spinbutton').set_value(this._settings.get_int('showdesktop-button-width'));
         this._builder.get_object('show_showdesktop_width_spinbutton').connect('value-changed', (widget) => {
@@ -575,27 +607,6 @@ const Preferences = class {
             this._settings.set_int('show-showdesktop-time', widget.get_value());
         });
 
-        dialog.connect('response', (dialog, id) => {
-            if (id == 1) {
-                // restore default settings
-                this._settings.set_value('showdesktop-button-width', this._settings.get_default_value('showdesktop-button-width'));
-                this._builder.get_object('show_showdesktop_width_spinbutton').set_value(this._settings.get_int('showdesktop-button-width'));
-
-                this._settings.set_value('show-showdesktop-hover', this._settings.get_default_value('show-showdesktop-hover'));
-
-                this._settings.set_value('show-showdesktop-delay', this._settings.get_default_value('show-showdesktop-delay'));
-                this._builder.get_object('show_showdesktop_delay_spinbutton').set_value(this._settings.get_int('show-showdesktop-delay'));
-
-                this._settings.set_value('show-showdesktop-time', this._settings.get_default_value('show-showdesktop-time'));
-                this._builder.get_object('show_showdesktop_time_spinbutton').set_value(this._settings.get_int('show-showdesktop-time'));
-            } else {
-                // remove the settings box so it doesn't get destroyed;
-                dialog.get_content_area().remove(box);
-                dialog.destroy();
-            }
-            return;
-        });
-
         dialog.show();
         dialog.set_default_size(1, 1);
     }
@@ -767,18 +778,41 @@ const Preferences = class {
         });
 
         this._builder.get_object('dot_style_options_button').connect('clicked', () => {
+            let box = this._builder.get_object('box_dots_options');
 
-            let dialog = new Gtk.Dialog({ title: _('Running Indicator Options'),
-                                          transient_for: this.notebook.get_root(),
-                                          use_header_bar: true,
-                                          modal: true });
+            let dialog = this._createPreferencesDialog(_('Running Indicator Options'), box, () =>
+            {
+                // restore default settings
+                this._settings.set_value('dot-color-dominant', this._settings.get_default_value('dot-color-dominant'));
+                this._settings.set_value('dot-color-override', this._settings.get_default_value('dot-color-override'));
+                this._settings.set_value('dot-color-unfocused-different', this._settings.get_default_value('dot-color-unfocused-different'));
 
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            dialog.add_button(_('Reset to defaults'), 1);
+                this._settings.set_value('focus-highlight-color', this._settings.get_default_value('focus-highlight-color'));
+                let rgba = new Gdk.RGBA();
+                rgba.parse(this._settings.get_string('focus-highlight-color'));
+                this._builder.get_object('focus_highlight_color_colorbutton').set_rgba(rgba);
 
-            let box = this._builder.get_object('box_dots_options');
-            dialog.get_content_area().append(box);
+                this._settings.set_value('focus-highlight-opacity', this._settings.get_default_value('focus-highlight-opacity'));
+                this._builder.get_object('focus_highlight_opacity_spinbutton').set_value(this._settings.get_int('focus-highlight-opacity'));
+
+                for (let i = 1; i <= MAX_WINDOW_INDICATOR; i++) {
+                    this._settings.set_value('dot-color-' + i, this._settings.get_default_value('dot-color-' + i));
+                    rgba = new Gdk.RGBA();
+                    rgba.parse(this._settings.get_string('dot-color-' + i));
+                    this._builder.get_object('dot_color_' + i + '_colorbutton').set_rgba(rgba);
+
+                    this._settings.set_value('dot-color-unfocused-' + i, this._settings.get_default_value('dot-color-unfocused-' + i));
+                    rgba = new Gdk.RGBA();
+                    rgba.parse(this._settings.get_string('dot-color-unfocused-' + i));
+                    this._builder.get_object('dot_color_unfocused_' + i + '_colorbutton').set_rgba(rgba);
+                }
+
+                this._settings.set_value('dot-size', this._settings.get_default_value('dot-size'));
+                this._builder.get_object('dot_size_spinbutton').set_value(this._settings.get_int('dot-size'));
+
+                this._settings.set_value('focus-highlight', this._settings.get_default_value('focus-highlight'));
+                this._settings.set_value('focus-highlight-dominant', this._settings.get_default_value('focus-highlight-dominant'));
+            });
 
             this._settings.bind('dot-color-dominant',
                             this._builder.get_object('dot_color_dominant_switch'),
@@ -870,47 +904,6 @@ const Preferences = class {
                 this._settings.set_int('dot-size', widget.get_value());
             });
 
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
-                    // restore default settings
-                    this._settings.set_value('dot-color-dominant', this._settings.get_default_value('dot-color-dominant'));
-                    this._settings.set_value('dot-color-override', this._settings.get_default_value('dot-color-override'));
-                    this._settings.set_value('dot-color-unfocused-different', this._settings.get_default_value('dot-color-unfocused-different'));
-
-                    this._settings.set_value('focus-highlight-color', this._settings.get_default_value('focus-highlight-color'));
-                    let rgba = new Gdk.RGBA();
-                    rgba.parse(this._settings.get_string('focus-highlight-color'));
-                    this._builder.get_object('focus_highlight_color_colorbutton').set_rgba(rgba);
-
-                    this._settings.set_value('focus-highlight-opacity', this._settings.get_default_value('focus-highlight-opacity'));
-                    this._builder.get_object('focus_highlight_opacity_spinbutton').set_value(this._settings.get_int('focus-highlight-opacity'));
-
-                    for (let i = 1; i <= MAX_WINDOW_INDICATOR; i++) {
-                        this._settings.set_value('dot-color-' + i, this._settings.get_default_value('dot-color-' + i));
-                        rgba = new Gdk.RGBA();
-                        rgba.parse(this._settings.get_string('dot-color-' + i));
-                        this._builder.get_object('dot_color_' + i + '_colorbutton').set_rgba(rgba);
-
-                        this._settings.set_value('dot-color-unfocused-' + i, this._settings.get_default_value('dot-color-unfocused-' + i));
-                        rgba = new Gdk.RGBA();
-                        rgba.parse(this._settings.get_string('dot-color-unfocused-' + i));
-                        this._builder.get_object('dot_color_unfocused_' + i + '_colorbutton').set_rgba(rgba);
-                    }
-
-                    this._settings.set_value('dot-size', this._settings.get_default_value('dot-size'));
-                    this._builder.get_object('dot_size_spinbutton').set_value(this._settings.get_int('dot-size'));
-                   
-                    this._settings.set_value('focus-highlight', this._settings.get_default_value('focus-highlight'));
-                    this._settings.set_value('focus-highlight-dominant', this._settings.get_default_value('focus-highlight-dominant'));
-
-                } else {
-                    // remove the settings box so it doesn't get destroyed;
-                    dialog.get_content_area().remove(box);
-                    dialog.destroy();
-                }
-                return;
-            });
-
             dialog.show();
             dialog.set_default_size(1, 1);
 
@@ -1114,20 +1107,10 @@ const Preferences = class {
         });
 
         this._builder.get_object('trans_dyn_options_button').connect('clicked', () => {
-            let dialog = new Gtk.Dialog({ title: _('Dynamic opacity options'),
-                                            transient_for: this.notebook.get_root(),
-                                            use_header_bar: true,
-                                            modal: true });
-
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            dialog.add_button(_('Reset to defaults'), 1);
-
             let box = this._builder.get_object('box_dynamic_opacity_options');
-            dialog.get_content_area().append(box);
 
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
+            let dialog = this._createPreferencesDialog(_('Dynamic opacity options'), box, () =>
+            {
                     // restore default settings
                     this._settings.set_value('trans-dynamic-behavior', this._settings.get_default_value('trans-dynamic-behavior'));
 
@@ -1139,12 +1122,6 @@ const Preferences = class {
 
                     this._settings.set_value('trans-dynamic-anim-time', this._settings.get_default_value('trans-dynamic-anim-time'));
                     this._builder.get_object('trans_options_anim_time_spinbutton').set_value(this._settings.get_int('trans-dynamic-anim-time'));
-                } else {
-                    // remove the settings box so it doesn't get destroyed;
-                    dialog.get_content_area().remove(box);
-                    dialog.destroy();
-                }
-                return;
             });
 
             dialog.show();
@@ -1258,49 +1235,33 @@ const Preferences = class {
         });
 
         this._builder.get_object('intellihide_options_button').connect('clicked', () => {
-            let dialog = new Gtk.Dialog({ title: _('Intellihide options'),
-                                          transient_for: this.notebook.get_root(),
-                                          use_header_bar: true,
-                                          modal: true });
-
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            dialog.add_button(_('Reset to defaults'), 1);
-
             let box = this._builder.get_object('box_intellihide_options');
-            dialog.get_content_area().append(box);
 
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
-                    // restore default settings
-                    this._settings.set_value('intellihide-hide-from-windows', this._settings.get_default_value('intellihide-hide-from-windows'));
-                    this._settings.set_value('intellihide-behaviour', this._settings.get_default_value('intellihide-behaviour'));
-                    this._settings.set_value('intellihide-use-pressure', this._settings.get_default_value('intellihide-use-pressure'));
-                    this._settings.set_value('intellihide-show-in-fullscreen', this._settings.get_default_value('intellihide-show-in-fullscreen'));
-                    this._settings.set_value('intellihide-only-secondary', this._settings.get_default_value('intellihide-only-secondary'));
-
-                    this._settings.set_value('intellihide-pressure-threshold', this._settings.get_default_value('intellihide-pressure-threshold'));
-                    this._builder.get_object('intellihide_pressure_threshold_spinbutton').set_value(this._settings.get_int('intellihide-pressure-threshold'));
-                    
-                    this._settings.set_value('intellihide-pressure-time', this._settings.get_default_value('intellihide-pressure-time'));
-                    this._builder.get_object('intellihide_pressure_time_spinbutton').set_value(this._settings.get_int('intellihide-pressure-time'));
+            let dialog = this._createPreferencesDialog(_('Intellihide options'), box, () =>
+            {
+                // restore default settings
+                this._settings.set_value('intellihide-hide-from-windows', this._settings.get_default_value('intellihide-hide-from-windows'));
+                this._settings.set_value('intellihide-behaviour', this._settings.get_default_value('intellihide-behaviour'));
+                this._settings.set_value('intellihide-use-pressure', this._settings.get_default_value('intellihide-use-pressure'));
+                this._settings.set_value('intellihide-show-in-fullscreen', this._settings.get_default_value('intellihide-show-in-fullscreen'));
+                this._settings.set_value('intellihide-only-secondary', this._settings.get_default_value('intellihide-only-secondary'));
+
+                this._settings.set_value('intellihide-pressure-threshold', this._settings.get_default_value('intellihide-pressure-threshold'));
+                this._builder.get_object('intellihide_pressure_threshold_spinbutton').set_value(this._settings.get_int('intellihide-pressure-threshold'));
+                
+                this._settings.set_value('intellihide-pressure-time', this._settings.get_default_value('intellihide-pressure-time'));
+                this._builder.get_object('intellihide_pressure_time_spinbutton').set_value(this._settings.get_int('intellihide-pressure-time'));
 
-                    this._settings.set_value('intellihide-key-toggle-text', this._settings.get_default_value('intellihide-key-toggle-text'));
+                this._settings.set_value('intellihide-key-toggle-text', this._settings.get_default_value('intellihide-key-toggle-text'));
 
-                    this._settings.set_value('intellihide-animation-time', this._settings.get_default_value('intellihide-animation-time'));
-                    this._builder.get_object('intellihide_animation_time_spinbutton').set_value(this._settings.get_int('intellihide-animation-time'));
+                this._settings.set_value('intellihide-animation-time', this._settings.get_default_value('intellihide-animation-time'));
+                this._builder.get_object('intellihide_animation_time_spinbutton').set_value(this._settings.get_int('intellihide-animation-time'));
 
-                    this._settings.set_value('intellihide-close-delay', this._settings.get_default_value('intellihide-close-delay'));
-                    this._builder.get_object('intellihide_close_delay_spinbutton').set_value(this._settings.get_int('intellihide-close-delay'));
+                this._settings.set_value('intellihide-close-delay', this._settings.get_default_value('intellihide-close-delay'));
+                this._builder.get_object('intellihide_close_delay_spinbutton').set_value(this._settings.get_int('intellihide-close-delay'));
 
-                    this._settings.set_value('intellihide-enable-start-delay', this._settings.get_default_value('intellihide-enable-start-delay'));
-                    this._builder.get_object('intellihide_enable_start_delay_spinbutton').set_value(this._settings.get_int('intellihide-enable-start-delay'));
-                } else {
-                    // remove the settings box so it doesn't get destroyed;
-                    dialog.get_content_area().remove(box);
-                    dialog.destroy();
-                }
-                return;
+                this._settings.set_value('intellihide-enable-start-delay', this._settings.get_default_value('intellihide-enable-start-delay'));
+                this._builder.get_object('intellihide_enable_start_delay_spinbutton').set_value(this._settings.get_int('intellihide-enable-start-delay'));
             });
 
             dialog.show();
@@ -1380,19 +1341,70 @@ const Preferences = class {
         });
 
         this._builder.get_object('show_window_previews_button').connect('clicked', () => {
+            let scrolledWindow = this._builder.get_object('box_window_preview_options');
 
-            let dialog = new Gtk.Dialog({ title: _('Window preview options'),
-                                          transient_for: this.notebook.get_root(),
-                                          use_header_bar: true,
-                                          modal: true });
+            let dialog = this._createPreferencesDialog(_('Window preview options'), scrolledWindow, () =>
+            {
+                // restore default settings
+                this._settings.set_value('show-window-previews-timeout', this._settings.get_default_value('show-window-previews-timeout'));
+                this._builder.get_object('preview_timeout_spinbutton').set_value(this._settings.get_int('show-window-previews-timeout'));
 
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            dialog.add_button(_('Reset to defaults'), 1);
+                this._settings.set_value('leave-timeout', this._settings.get_default_value('leave-timeout'));
+                this._builder.get_object('leave_timeout_spinbutton').set_value(this._settings.get_int('leave-timeout'));
 
-            let scrolledWindow = this._builder.get_object('box_window_preview_options');
+                this._settings.set_value('window-preview-hide-immediate-click', this._settings.get_default_value('window-preview-hide-immediate-click'));
+
+                this._settings.set_value('window-preview-animation-time', this._settings.get_default_value('window-preview-animation-time'));
+                this._builder.get_object('animation_time_spinbutton').set_value(this._settings.get_int('window-preview-animation-time'));
+
+                this._settings.set_value('preview-use-custom-opacity', this._settings.get_default_value('preview-use-custom-opacity'));
+                
+                this._settings.set_value('window-preview-use-custom-icon-size', this._settings.get_default_value('window-preview-use-custom-icon-size'));
 
-            dialog.get_content_area().append(scrolledWindow);
+                this._settings.set_value('preview-custom-opacity', this._settings.get_default_value('preview-custom-opacity'));
+                this._builder.get_object('preview_custom_opacity_spinbutton').set_value(this._settings.get_int('preview-custom-opacity'));
+
+                this._settings.set_value('window-preview-title-position', this._settings.get_default_value('window-preview-title-position'));
+                this._setPreviewTitlePosition();
+
+                this._settings.set_value('peek-mode', this._settings.get_default_value('peek-mode'));
+                this._settings.set_value('window-preview-show-title', this._settings.get_default_value('window-preview-show-title'));
+                this._settings.set_value('enter-peek-mode-timeout', this._settings.get_default_value('enter-peek-mode-timeout'));
+                this._builder.get_object('enter_peek_mode_timeout_spinbutton').set_value(this._settings.get_int('enter-peek-mode-timeout'));
+                this._settings.set_value('peek-mode-opacity', this._settings.get_default_value('peek-mode-opacity'));
+                this._builder.get_object('peek_mode_opacity_spinbutton').set_value(this._settings.get_int('peek-mode-opacity'));
+
+                this._settings.set_value('window-preview-size', this._settings.get_default_value('window-preview-size'));
+                this._builder.get_object('preview_size_spinbutton').set_value(this._settings.get_int('window-preview-size'));
+
+                this._settings.set_value('window-preview-fixed-x', this._settings.get_default_value('window-preview-fixed-x'));
+                this._settings.set_value('window-preview-fixed-y', this._settings.get_default_value('window-preview-fixed-y'));
+
+                this._settings.set_value('window-preview-aspect-ratio-x', this._settings.get_default_value('window-preview-aspect-ratio-x'));
+                this._builder.get_object('preview_aspect_ratio_x_combo').set_active_id(this._settings.get_int('window-preview-aspect-ratio-x').toString());
+
+                this._settings.set_value('window-preview-aspect-ratio-y', this._settings.get_default_value('window-preview-aspect-ratio-y'));
+                this._builder.get_object('preview_aspect_ratio_y_combo').set_active_id(this._settings.get_int('window-preview-aspect-ratio-y').toString());
+                
+                this._settings.set_value('window-preview-padding', this._settings.get_default_value('window-preview-padding'));
+                this._builder.get_object('preview_padding_spinbutton').set_value(this._settings.get_int('window-preview-padding'));
+
+                this._settings.set_value('preview-middle-click-close', this._settings.get_default_value('preview-middle-click-close'));
+
+                this._settings.set_value('window-preview-title-font-size', this._settings.get_default_value('window-preview-title-font-size'));
+                this._builder.get_object('preview_title_size_spinbutton').set_value(this._settings.get_int('window-preview-title-font-size'));
+                
+                this._settings.set_value('window-preview-custom-icon-size', this._settings.get_default_value('window-preview-custom-icon-size'));
+                this._builder.get_object('preview_custom_icon_size_spinbutton').set_value(this._settings.get_int('window-preview-custom-icon-size'));
+
+                this._settings.set_value('window-preview-title-font-weight', this._settings.get_default_value('window-preview-title-font-weight'));
+                this._builder.get_object('grid_preview_title_weight_combo').set_active_id(this._settings.get_string('window-preview-title-font-weight'));
+
+                this._settings.set_value('window-preview-title-font-color', this._settings.get_default_value('window-preview-title-font-color'));
+                let rgba = new Gdk.RGBA();
+                rgba.parse(this._settings.get_string('window-preview-title-font-color'));
+                this._builder.get_object('grid_preview_title_font_color_colorbutton').set_rgba(rgba);
+            });
 
             this._builder.get_object('preview_timeout_spinbutton').set_value(this._settings.get_int('show-window-previews-timeout'));
             this._builder.get_object('preview_timeout_spinbutton').connect('value-changed', (widget) => {
@@ -1536,76 +1548,6 @@ const Preferences = class {
                 this._builder.get_object('grid_preview_title_font_color_colorbutton').set_rgba(rgba);
             }).apply(this);
 
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
-                    // restore default settings
-                    this._settings.set_value('show-window-previews-timeout', this._settings.get_default_value('show-window-previews-timeout'));
-                    this._builder.get_object('preview_timeout_spinbutton').set_value(this._settings.get_int('show-window-previews-timeout'));
-
-                    this._settings.set_value('leave-timeout', this._settings.get_default_value('leave-timeout'));
-                    this._builder.get_object('leave_timeout_spinbutton').set_value(this._settings.get_int('leave-timeout'));
-
-                    this._settings.set_value('window-preview-hide-immediate-click', this._settings.get_default_value('window-preview-hide-immediate-click'));
-
-                    this._settings.set_value('window-preview-animation-time', this._settings.get_default_value('window-preview-animation-time'));
-                    this._builder.get_object('animation_time_spinbutton').set_value(this._settings.get_int('window-preview-animation-time'));
-
-                    this._settings.set_value('preview-use-custom-opacity', this._settings.get_default_value('preview-use-custom-opacity'));
-                    
-                    this._settings.set_value('window-preview-use-custom-icon-size', this._settings.get_default_value('window-preview-use-custom-icon-size'));
-
-                    this._settings.set_value('preview-custom-opacity', this._settings.get_default_value('preview-custom-opacity'));
-                    this._builder.get_object('preview_custom_opacity_spinbutton').set_value(this._settings.get_int('preview-custom-opacity'));
-
-                    this._settings.set_value('window-preview-title-position', this._settings.get_default_value('window-preview-title-position'));
-                    this._setPreviewTitlePosition();
-
-                    this._settings.set_value('peek-mode', this._settings.get_default_value('peek-mode'));
-                    this._settings.set_value('window-preview-show-title', this._settings.get_default_value('window-preview-show-title'));
-                    this._settings.set_value('enter-peek-mode-timeout', this._settings.get_default_value('enter-peek-mode-timeout'));
-                    this._builder.get_object('enter_peek_mode_timeout_spinbutton').set_value(this._settings.get_int('enter-peek-mode-timeout'));
-                    this._settings.set_value('peek-mode-opacity', this._settings.get_default_value('peek-mode-opacity'));
-                    this._builder.get_object('peek_mode_opacity_spinbutton').set_value(this._settings.get_int('peek-mode-opacity'));
-
-                    this._settings.set_value('window-preview-size', this._settings.get_default_value('window-preview-size'));
-                    this._builder.get_object('preview_size_spinbutton').set_value(this._settings.get_int('window-preview-size'));
-
-                    this._settings.set_value('window-preview-fixed-x', this._settings.get_default_value('window-preview-fixed-x'));
-                    this._settings.set_value('window-preview-fixed-y', this._settings.get_default_value('window-preview-fixed-y'));
-
-                    this._settings.set_value('window-preview-aspect-ratio-x', this._settings.get_default_value('window-preview-aspect-ratio-x'));
-                    this._builder.get_object('preview_aspect_ratio_x_combo').set_active_id(this._settings.get_int('window-preview-aspect-ratio-x').toString());
-
-                    this._settings.set_value('window-preview-aspect-ratio-y', this._settings.get_default_value('window-preview-aspect-ratio-y'));
-                    this._builder.get_object('preview_aspect_ratio_y_combo').set_active_id(this._settings.get_int('window-preview-aspect-ratio-y').toString());
-                    
-                    this._settings.set_value('window-preview-padding', this._settings.get_default_value('window-preview-padding'));
-                    this._builder.get_object('preview_padding_spinbutton').set_value(this._settings.get_int('window-preview-padding'));
-
-                    this._settings.set_value('preview-middle-click-close', this._settings.get_default_value('preview-middle-click-close'));
-
-                    this._settings.set_value('window-preview-title-font-size', this._settings.get_default_value('window-preview-title-font-size'));
-                    this._builder.get_object('preview_title_size_spinbutton').set_value(this._settings.get_int('window-preview-title-font-size'));
-                    
-                    this._settings.set_value('window-preview-custom-icon-size', this._settings.get_default_value('window-preview-custom-icon-size'));
-                    this._builder.get_object('preview_custom_icon_size_spinbutton').set_value(this._settings.get_int('window-preview-custom-icon-size'));
-
-                    this._settings.set_value('window-preview-title-font-weight', this._settings.get_default_value('window-preview-title-font-weight'));
-                    this._builder.get_object('grid_preview_title_weight_combo').set_active_id(this._settings.get_string('window-preview-title-font-weight'));
-
-                    this._settings.set_value('window-preview-title-font-color', this._settings.get_default_value('window-preview-title-font-color'));
-                    let rgba = new Gdk.RGBA();
-                    rgba.parse(this._settings.get_string('window-preview-title-font-color'));
-                    this._builder.get_object('grid_preview_title_font_color_colorbutton').set_rgba(rgba);
-
-                } else {
-                    // remove the settings box so it doesn't get destroyed;
-                    dialog.get_content_area().remove(scrolledWindow);
-                    dialog.destroy();
-                }
-                return;
-            });
-
             dialog.show();
 
         });
@@ -1675,17 +1617,34 @@ const Preferences = class {
                             Gio.SettingsBindFlags.DEFAULT);    
 
         this._builder.get_object('show_group_apps_options_button').connect('clicked', () => {
-            let dialog = new Gtk.Dialog({ title: _('Ungrouped application options'),
-                                          transient_for: this.notebook.get_root(),
-                                          use_header_bar: true,
-                                          modal: true });
+            let box = this._builder.get_object('box_group_apps_options');
 
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            dialog.add_button(_('Reset to defaults'), 1);
+            let dialog = this._createPreferencesDialog(_('Ungrouped application options'), box, () =>
+            {
+                // restore default settings
+                this._settings.set_value('group-apps-label-font-size', this._settings.get_default_value('group-apps-label-font-size'));
+                this._builder.get_object('group_apps_label_font_size_spinbutton').set_value(this._settings.get_int('group-apps-label-font-size'));
 
-            let box = this._builder.get_object('box_group_apps_options');
-            dialog.get_content_area().append(box);
+                this._settings.set_value('group-apps-label-font-weight', this._settings.get_default_value('group-apps-label-font-weight'));
+                this._builder.get_object('group_apps_label_font_weight_combo').set_active_id(this._settings.get_string('group-apps-label-font-weight'));
+
+                this._settings.set_value('group-apps-label-font-color', this._settings.get_default_value('group-apps-label-font-color'));
+                let rgba = new Gdk.RGBA();
+                rgba.parse(this._settings.get_string('group-apps-label-font-color'));
+                this._builder.get_object('group_apps_label_font_color_colorbutton').set_rgba(rgba);
+
+                this._settings.set_value('group-apps-label-font-color-minimized', this._settings.get_default_value('group-apps-label-font-color-minimized'));
+                let minimizedFontColor = new Gdk.RGBA();
+                minimizedFontColor.parse(this._settings.get_string('group-apps-label-font-color-minimized'));
+                this._builder.get_object('group_apps_label_font_color_minimized_colorbutton').set_rgba(minimizedFontColor);
+
+                this._settings.set_value('group-apps-label-max-width', this._settings.get_default_value('group-apps-label-max-width'));
+                this._builder.get_object('group_apps_label_max_width_spinbutton').set_value(this._settings.get_int('group-apps-label-max-width'));
+
+                this._settings.set_value('group-apps-use-fixed-width', this._settings.get_default_value('group-apps-use-fixed-width'));
+                this._settings.set_value('group-apps-underline-unfocused', this._settings.get_default_value('group-apps-underline-unfocused'));
+                this._settings.set_value('group-apps-use-launchers', this._settings.get_default_value('group-apps-use-launchers'));
+            });
 
             this._builder.get_object('group_apps_label_font_size_spinbutton').set_value(this._settings.get_int('group-apps-label-font-size'));
             this._builder.get_object('group_apps_label_font_size_spinbutton').connect('value-changed', (widget) => {
@@ -1714,39 +1673,6 @@ const Preferences = class {
                 this._settings.set_int('group-apps-label-max-width', widget.get_value());
             });
 
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
-                    // restore default settings
-                    this._settings.set_value('group-apps-label-font-size', this._settings.get_default_value('group-apps-label-font-size'));
-                    this._builder.get_object('group_apps_label_font_size_spinbutton').set_value(this._settings.get_int('group-apps-label-font-size'));
-
-                    this._settings.set_value('group-apps-label-font-weight', this._settings.get_default_value('group-apps-label-font-weight'));
-                    this._builder.get_object('group_apps_label_font_weight_combo').set_active_id(this._settings.get_string('group-apps-label-font-weight'));
-
-                    this._settings.set_value('group-apps-label-font-color', this._settings.get_default_value('group-apps-label-font-color'));
-                    let rgba = new Gdk.RGBA();
-                    rgba.parse(this._settings.get_string('group-apps-label-font-color'));
-                    this._builder.get_object('group_apps_label_font_color_colorbutton').set_rgba(rgba);
-
-                    this._settings.set_value('group-apps-label-font-color-minimized', this._settings.get_default_value('group-apps-label-font-color-minimized'));
-                    let minimizedFontColor = new Gdk.RGBA();
-                    minimizedFontColor.parse(this._settings.get_string('group-apps-label-font-color-minimized'));
-                    this._builder.get_object('group_apps_label_font_color_minimized_colorbutton').set_rgba(minimizedFontColor);
-
-                    this._settings.set_value('group-apps-label-max-width', this._settings.get_default_value('group-apps-label-max-width'));
-                    this._builder.get_object('group_apps_label_max_width_spinbutton').set_value(this._settings.get_int('group-apps-label-max-width'));
-
-                    this._settings.set_value('group-apps-use-fixed-width', this._settings.get_default_value('group-apps-use-fixed-width'));
-                    this._settings.set_value('group-apps-underline-unfocused', this._settings.get_default_value('group-apps-underline-unfocused'));
-                    this._settings.set_value('group-apps-use-launchers', this._settings.get_default_value('group-apps-use-launchers'));
-                } else {
-                    // remove the settings box so it doesn't get destroyed;
-                    dialog.get_content_area().remove(box);
-                    dialog.destroy();
-                }
-                return;
-            });
-
             dialog.show();
             dialog.set_default_size(600, 1);
 
@@ -1770,18 +1696,19 @@ const Preferences = class {
 
         // Create dialog for middle-click options
         this._builder.get_object('middle_click_options_button').connect('clicked', () => {
-
-            let dialog = new Gtk.Dialog({ title: _('Customize middle-click behavior'),
-                                          transient_for: this.notebook.get_root(),
-                                          use_header_bar: true,
-                                          modal: true });
-
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            dialog.add_button(_('Reset to defaults'), 1);
-
             let box = this._builder.get_object('box_middle_click_options');
-            dialog.get_content_area().append(box);
+
+            let dialog = this._createPreferencesDialog(_('Customize middle-click behavior'), box, () =>
+            {
+                // restore default settings for the relevant keys
+                let keys = ['shift-click-action', 'middle-click-action', 'shift-middle-click-action'];
+                keys.forEach(function(val) {
+                    this._settings.set_value(val, this._settings.get_default_value(val));
+                }, this);
+                this._builder.get_object('shift_click_action_combo').set_active_id(this._settings.get_string('shift-click-action'));
+                this._builder.get_object('middle_click_action_combo').set_active_id(this._settings.get_string('middle-click-action'));
+                this._builder.get_object('shift_middle_click_action_combo').set_active_id(this._settings.get_string('shift-middle-click-action'));
+            });
 
             this._builder.get_object('shift_click_action_combo').set_active_id(this._settings.get_string('shift-click-action'));
 
@@ -1802,24 +1729,6 @@ const Preferences = class {
                                 'active-id',
                                 Gio.SettingsBindFlags.DEFAULT);
 
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
-                    // restore default settings for the relevant keys
-                    let keys = ['shift-click-action', 'middle-click-action', 'shift-middle-click-action'];
-                    keys.forEach(function(val) {
-                        this._settings.set_value(val, this._settings.get_default_value(val));
-                    }, this);
-                    this._builder.get_object('shift_click_action_combo').set_active_id(this._settings.get_string('shift-click-action'));
-                    this._builder.get_object('middle_click_action_combo').set_active_id(this._settings.get_string('middle-click-action'));
-                    this._builder.get_object('shift_middle_click_action_combo').set_active_id(this._settings.get_string('shift-middle-click-action'));
-                } else {
-                    // remove the settings box so it doesn't get destroyed;
-                    dialog.get_content_area().remove(box);
-                    dialog.destroy();
-                }
-                return;
-            });
-
             dialog.show();
             dialog.set_default_size(700, 1);
 
@@ -1837,17 +1746,16 @@ const Preferences = class {
 
         // Create dialog for panel scroll options
         this._builder.get_object('scroll_panel_options_button').connect('clicked', () => {
-            let dialog = new Gtk.Dialog({ title: _('Customize panel scroll behavior'),
-                                          transient_for: this.notebook.get_root(),
-                                          use_header_bar: true,
-                                          modal: true });
+            let box = this._builder.get_object('scroll_panel_options_box');
 
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            dialog.add_button(_('Reset to defaults'), 1);
+            let dialog = this._createPreferencesDialog(_('Customize panel scroll behavior'), box, () =>
+            {
+                // restore default settings
+                this._settings.set_value('scroll-panel-delay', this._settings.get_default_value('scroll-panel-delay'));
+                this._builder.get_object('scroll_panel_options_delay_spinbutton').set_value(this._settings.get_int('scroll-panel-delay'));
 
-            let box = this._builder.get_object('scroll_panel_options_box');
-            dialog.get_content_area().append(box);
+                this._settings.set_value('scroll-panel-show-ws-popup', this._settings.get_default_value('scroll-panel-show-ws-popup'));
+            });
 
             this._builder.get_object('scroll_panel_options_delay_spinbutton').set_value(this._settings.get_int('scroll-panel-delay'));
             this._builder.get_object('scroll_panel_options_delay_spinbutton').connect('value-changed', (widget) => {
@@ -1859,21 +1767,6 @@ const Preferences = class {
                             'active',
                             Gio.SettingsBindFlags.DEFAULT);
 
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
-                    // restore default settings
-                    this._settings.set_value('scroll-panel-delay', this._settings.get_default_value('scroll-panel-delay'));
-                    this._builder.get_object('scroll_panel_options_delay_spinbutton').set_value(this._settings.get_int('scroll-panel-delay'));
-
-                    this._settings.set_value('scroll-panel-show-ws-popup', this._settings.get_default_value('scroll-panel-show-ws-popup'));
-                } else {
-                    // remove the settings box so it doesn't get destroyed;
-                    dialog.get_content_area().remove(box);
-                    dialog.destroy();
-                }
-                return;
-            });
-
             dialog.show();
             dialog.set_default_size(640, 1);
 
@@ -1881,36 +1774,20 @@ const Preferences = class {
 
         // Create dialog for icon scroll options
         this._builder.get_object('scroll_icon_options_button').connect('clicked', () => {
-            let dialog = new Gtk.Dialog({ title: _('Customize icon scroll behavior'),
-                                            transient_for: this.notebook.get_root(),
-                                            use_header_bar: true,
-                                            modal: true });
-
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            dialog.add_button(_('Reset to defaults'), 1);
-
             let box = this._builder.get_object('scroll_icon_options_box');
-            dialog.get_content_area().append(box);
+
+            let dialog = this._createPreferencesDialog(_('Customize icon scroll behavior'), box, () =>
+            {
+                // restore default settings
+                this._settings.set_value('scroll-icon-delay', this._settings.get_default_value('scroll-icon-delay'));
+                this._builder.get_object('scroll_icon_options_delay_spinbutton').set_value(this._settings.get_int('scroll-icon-delay'));
+            });
 
             this._builder.get_object('scroll_icon_options_delay_spinbutton').set_value(this._settings.get_int('scroll-icon-delay'));
             this._builder.get_object('scroll_icon_options_delay_spinbutton').connect('value-changed', (widget) => {
                 this._settings.set_int('scroll-icon-delay', widget.get_value());
             });
 
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
-                    // restore default settings
-                    this._settings.set_value('scroll-icon-delay', this._settings.get_default_value('scroll-icon-delay'));
-                    this._builder.get_object('scroll_icon_options_delay_spinbutton').set_value(this._settings.get_int('scroll-icon-delay'));
-                } else {
-                    // remove the settings box so it doesn't get destroyed;
-                    dialog.get_content_area().remove(box);
-                    dialog.destroy();
-                }
-                return;
-            });
-
             dialog.show();
             dialog.set_default_size(640, 1);
 
@@ -1978,32 +1855,15 @@ const Preferences = class {
 
         // Create dialog for number overlay options
         this._builder.get_object('overlay_button').connect('clicked', () => {
-
-            let dialog = new Gtk.Dialog({ title: _('Advanced hotkeys options'),
-                                          transient_for: this.notebook.get_root(),
-                                          use_header_bar: true,
-                                          modal: true });
-
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            dialog.add_button(_('Reset to defaults'), 1);
-
             let box = this._builder.get_object('box_overlay_shortcut');
-            dialog.get_content_area().append(box);
 
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
-                    // restore default settings for the relevant keys
-                    let keys = ['hotkey-prefix-text', 'shortcut-text', 'hotkeys-overlay-combo', 'overlay-timeout', 'shortcut-previews'];
-                    keys.forEach(function(val) {
-                        this._settings.set_value(val, this._settings.get_default_value(val));
-                    }, this);
-                } else {
-                    // remove the settings box so it doesn't get destroyed;
-                    dialog.get_content_area().remove(box);
-                    dialog.destroy();
-                }
-                return;
+            let dialog = this._createPreferencesDialog(_('Advanced hotkeys options'), box, () =>
+            {
+                // restore default settings for the relevant keys
+                let keys = ['hotkey-prefix-text', 'shortcut-text', 'hotkeys-overlay-combo', 'overlay-timeout', 'shortcut-previews'];
+                keys.forEach(function(val) {
+                    this._settings.set_value(val, this._settings.get_default_value(val));
+                }, this);
             });
 
             dialog.show();
@@ -2013,18 +1873,14 @@ const Preferences = class {
         
         // setup dialog for secondary menu options
         this._builder.get_object('secondarymenu_options_button').connect('clicked', () => {
-
-            let dialog = new Gtk.Dialog({ title: _('Secondary Menu Options'),
-                                          transient_for: this.notebook.get_root(),
-                                          use_header_bar: true,
-                                          modal: true });
-
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            dialog.add_button(_('Reset to defaults'), 1);
-
             let box = this._builder.get_object('box_secondarymenu_options');
-            dialog.get_content_area().append(box);
+
+            let dialog = this._createPreferencesDialog(_('Secondary Menu Options'), box, () =>
+            {
+                // restore default settings
+                this._settings.set_value('secondarymenu-contains-appmenu', this._settings.get_default_value('secondarymenu-contains-appmenu'));
+                this._settings.set_value('secondarymenu-contains-showdetails', this._settings.get_default_value('secondarymenu-contains-showdetails'));
+            });
 
             this._settings.bind('secondarymenu-contains-appmenu',
                     this._builder.get_object('secondarymenu_appmenu_switch'),
@@ -2036,19 +1892,6 @@ const Preferences = class {
                     'active',
                     Gio.SettingsBindFlags.DEFAULT);
 
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
-                    // restore default settings
-                    this._settings.set_value('secondarymenu-contains-appmenu', this._settings.get_default_value('secondarymenu-contains-appmenu'));
-                    this._settings.set_value('secondarymenu-contains-showdetails', this._settings.get_default_value('secondarymenu-contains-showdetails'));
-                } else {
-                    // remove the settings box so it doesn't get destroyed;
-                    dialog.get_content_area().remove(box);
-                    dialog.destroy();
-                }
-                return;
-            });
-
             dialog.show();
             dialog.set_default_size(480, 1);
 
@@ -2056,30 +1899,10 @@ const Preferences = class {
 
         // setup dialog for advanced options
         this._builder.get_object('button_advanced_options').connect('clicked', () => {
-
-            let dialog = new Gtk.Dialog({ title: _('Advanced Options'),
-                                          transient_for: this.notebook.get_root(),
-                                          use_header_bar: true,
-                                          modal: true });
-
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            dialog.add_button(_('Reset to defaults'), 1);
-
+            print("nj");
             let box = this._builder.get_object('box_advanced_options');
-            dialog.get_content_area().append(box);
 
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
-                    // restore default settings  
-                                 
-                } else {
-                    // remove the settings box so it doesn't get destroyed;
-                    dialog.get_content_area().remove(box);
-                    dialog.destroy();
-                }
-                return;
-            });
+            let dialog = this._createPreferencesDialog(_('Advanced Options'), box);
 
             dialog.show();
             dialog.set_default_size(480, 1);
@@ -2193,34 +2016,19 @@ const Preferences = class {
         }
 
         this._builder.get_object('animate_appicon_hover_button').connect('clicked', () => {
-            let dialog = new Gtk.Dialog({ title: _('App icon animation options'),
-                                          transient_for: this.notebook.get_root(),
-                                          use_header_bar: true,
-                                          modal: true });
-
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            dialog.add_button(_('Reset to defaults'), 1);
-
+            print("BB");
             let box = this._builder.get_object('animate_appicon_hover_options');
-            dialog.get_content_area().append(box);
 
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
-                    // restore default settings
-                    this._settings.set_value('animate-appicon-hover-animation-type', this._settings.get_default_value('animate-appicon-hover-animation-type'));
-                    this._settings.set_value('animate-appicon-hover-animation-duration', this._settings.get_default_value('animate-appicon-hover-animation-duration'));
-                    this._settings.set_value('animate-appicon-hover-animation-rotation', this._settings.get_default_value('animate-appicon-hover-animation-rotation'));
-                    this._settings.set_value('animate-appicon-hover-animation-travel', this._settings.get_default_value('animate-appicon-hover-animation-travel'));
-                    this._settings.set_value('animate-appicon-hover-animation-zoom', this._settings.get_default_value('animate-appicon-hover-animation-zoom'));
-                    this._settings.set_value('animate-appicon-hover-animation-convexity', this._settings.get_default_value('animate-appicon-hover-animation-convexity'));
-                    this._settings.set_value('animate-appicon-hover-animation-extent', this._settings.get_default_value('animate-appicon-hover-animation-extent'));
-                } else {
-                    // remove the settings box so it doesn't get destroyed;
-                    dialog.get_content_area().remove(box);
-                    dialog.destroy();
-                }
-                return;
+            let dialog = this._createPreferencesDialog(_('App icon animation options'), box, () =>
+            {
+                // restore default settings
+                this._settings.set_value('animate-appicon-hover-animation-type', this._settings.get_default_value('animate-appicon-hover-animation-type'));
+                this._settings.set_value('animate-appicon-hover-animation-duration', this._settings.get_default_value('animate-appicon-hover-animation-duration'));
+                this._settings.set_value('animate-appicon-hover-animation-rotation', this._settings.get_default_value('animate-appicon-hover-animation-rotation'));
+                this._settings.set_value('animate-appicon-hover-animation-travel', this._settings.get_default_value('animate-appicon-hover-animation-travel'));
+                this._settings.set_value('animate-appicon-hover-animation-zoom', this._settings.get_default_value('animate-appicon-hover-animation-zoom'));
+                this._settings.set_value('animate-appicon-hover-animation-convexity', this._settings.get_default_value('animate-appicon-hover-animation-convexity'));
+                this._settings.set_value('animate-appicon-hover-animation-extent', this._settings.get_default_value('animate-appicon-hover-animation-extent'));
             });
 
             dialog.show();

From 53717709156570a3de5e111e40d0577f153b48b9 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Thu, 7 Apr 2022 20:38:04 +0200
Subject: [PATCH 27/62] enable prefs dialog search, fix sensitive flag of
 opacity and gradiant rows

---
 prefs.js            | 17 +++++++++++++++++
 ui/SettingsStyle.ui |  8 ++++----
 2 files changed, 21 insertions(+), 4 deletions(-)

diff --git a/prefs.js b/prefs.js
index 02d7997d..cff63e48 100644
--- a/prefs.js
+++ b/prefs.js
@@ -166,6 +166,9 @@ const Preferences = class {
         this._builder.set_translation_domain(Me.metadata['gettext-domain']);
 
         if (window) {
+            this._window = window;
+            window.set_search_enabled(true);
+
             // dialogs
             this._builder.add_from_file(Me.path + '/ui/AnimateAppIconHoverOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxDotOptions.ui');
@@ -1026,6 +1029,13 @@ const Preferences = class {
                             'sensitive',
                             Gio.SettingsBindFlags.DEFAULT);
 
+        if (this._window) {
+            this._settings.bind('trans-use-custom-opacity',
+                            this._builder.get_object('trans_opacity_box2'),
+                            'sensitive',
+                            Gio.SettingsBindFlags.DEFAULT);
+        }
+
         this._builder.get_object('trans_opacity_override_switch').connect('notify::active', (widget) => {
             if (!widget.get_active())
                 this._builder.get_object('trans_dyn_switch').set_active(false);
@@ -1061,6 +1071,13 @@ const Preferences = class {
                             'sensitive',
                             Gio.SettingsBindFlags.DEFAULT);
 
+        if (this._window) {
+            this._settings.bind('trans-use-custom-gradient',
+                            this._builder.get_object('trans_gradient_box2'),
+                            'sensitive',
+                            Gio.SettingsBindFlags.DEFAULT);
+        }
+
         rgba.parse(this._settings.get_string('trans-gradient-top-color'));
         this._builder.get_object('trans_gradient_color1_colorbutton').set_rgba(rgba);
 
diff --git a/ui/SettingsStyle.ui b/ui/SettingsStyle.ui
index a97a936f..b2ae021b 100644
--- a/ui/SettingsStyle.ui
+++ b/ui/SettingsStyle.ui
@@ -251,7 +251,7 @@
         </child>
 
         <child>
-          <object class="AdwActionRow">
+          <object class="AdwActionRow" id="trans_opacity_box">
             <property name="title" translatable="yes">Panel background opacity (%)</property>
             <child>
               <object class="GtkSpinButton" id="trans_opacity_spinbutton">
@@ -264,7 +264,7 @@
         </child>
 
         <child>
-          <object class="AdwActionRow" id="trans_opacity_box">
+          <object class="AdwActionRow" id="trans_opacity_box2">
             <property name="title" translatable="yes">Dynamic background opacity</property>
             <property name="subtitle" translatable="yes">Change opacity when a window gets close to the panel</property>
             <child>
@@ -309,7 +309,7 @@
         </child>
 
         <child>
-          <object class="AdwActionRow" id="trans_gradient_box"> <!-- TODO this id should be the entire box-->
+          <object class="AdwActionRow" id="trans_gradient_box">
             <property name="title" translatable="yes">Gradient top color and opacity (%)</property>
             <child>
               <object class="GtkColorButton" id="trans_gradient_color1_colorbutton">
@@ -328,7 +328,7 @@
         </child>
 
         <child>
-          <object class="AdwActionRow">
+          <object class="AdwActionRow" id="trans_gradient_box2">
             <property name="title" translatable="yes">Gradient bottom color and opacity (%)</property>
             <child>
               <object class="GtkColorButton" id="trans_gradient_color2_colorbutton">

From e031805d25d00d7ceab196f05d13620977b87c31 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Fri, 8 Apr 2022 23:07:55 +0200
Subject: [PATCH 28/62] fix row order and some strings in behavior page

---
 ui/SettingsBehavior.ui | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/ui/SettingsBehavior.ui b/ui/SettingsBehavior.ui
index d5dbf951..6f50fa8b 100644
--- a/ui/SettingsBehavior.ui
+++ b/ui/SettingsBehavior.ui
@@ -23,9 +23,9 @@
 
         <child>
           <object class="AdwActionRow">
-            <property name="title" translatable="yes">Show running applications</property>
+            <property name="title" translatable="yes">Show favorite applications on secondary panels</property>
             <child>
-              <object class="GtkSwitch" id="show_runnning_apps_switch">
+              <object class="GtkSwitch" id="multimon_multi_show_favorites_switch">
                 <property name="valign">center</property>
               </object>
             </child>
@@ -34,9 +34,9 @@
 
         <child>
           <object class="AdwActionRow">
-            <property name="title" translatable="yes">Show favorite applications on secondary panels</property>
+            <property name="title" translatable="yes">Show running applications</property>
             <child>
-              <object class="GtkSwitch" id="multimon_multi_show_favorites_switch">
+              <object class="GtkSwitch" id="show_runnning_apps_switch">
                 <property name="valign">center</property>
               </object>
             </child>
@@ -45,7 +45,7 @@
 
         <child>
           <object class="AdwActionRow">
-            <property name="title" translatable="yes">Show favorite applications</property>
+            <property name="title" translatable="yes">Show &lt;i&gt;AppMenu&lt;/i&gt; button</property>
             <property name="subtitle">Top Bar &gt; Show App Menu must be enabled in Tweak Tool</property>
             <child>
               <object class="GtkSwitch" id="show_appmenu_switch">

From 9525de6b1d9422f736ff9b4eca772f57c121b570 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Fri, 8 Apr 2022 23:26:06 +0200
Subject: [PATCH 29/62] update pages icons

---
 ui/SettingsAbout.ui    | 2 +-
 ui/SettingsAction.ui   | 2 +-
 ui/SettingsBehavior.ui | 2 +-
 ui/SettingsFineTune.ui | 2 +-
 ui/SettingsPosition.ui | 2 +-
 ui/SettingsStyle.ui    | 2 +-
 6 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/ui/SettingsAbout.ui b/ui/SettingsAbout.ui
index 73c23bdb..caeb2755 100644
--- a/ui/SettingsAbout.ui
+++ b/ui/SettingsAbout.ui
@@ -4,7 +4,7 @@
 
   <object class="AdwPreferencesPage" id="about">
     <property name="title">About</property>
-    <property name="icon_name">document-properties</property>
+    <property name="icon_name">help-about</property>
 
       <!-- group info -->
       <child>
diff --git a/ui/SettingsAction.ui b/ui/SettingsAction.ui
index 3b2ec4c6..c552d1ea 100644
--- a/ui/SettingsAction.ui
+++ b/ui/SettingsAction.ui
@@ -4,7 +4,7 @@
 
   <object class="AdwPreferencesPage" id="action">
     <property name="title">Action</property>
-    <property name="icon_name">document-properties</property>
+    <property name="icon_name">view-pin</property>
 
     <!-- group click action -->
     <child>
diff --git a/ui/SettingsBehavior.ui b/ui/SettingsBehavior.ui
index 6f50fa8b..9ea25601 100644
--- a/ui/SettingsBehavior.ui
+++ b/ui/SettingsBehavior.ui
@@ -3,7 +3,7 @@
   <requires lib="gtk" version="4.0"/>
   <object class="AdwPreferencesPage" id="behavior">
     <property name="title">Behavior</property>
-    <property name="icon_name">document-properties</property>
+    <property name="icon_name">visible</property>
 
     <!-- group applications -->
     <child>
diff --git a/ui/SettingsFineTune.ui b/ui/SettingsFineTune.ui
index 29126ee5..61fd0768 100644
--- a/ui/SettingsFineTune.ui
+++ b/ui/SettingsFineTune.ui
@@ -39,7 +39,7 @@
 
   <object class="AdwPreferencesPage" id="finetune">
     <property name="title">Fine-Tune</property>
-    <property name="icon_name">document-properties</property>
+    <property name="icon_name">color-select</property>
 
       <!-- group font -->
       <child>
diff --git a/ui/SettingsPosition.ui b/ui/SettingsPosition.ui
index fd01180d..d31f9727 100644
--- a/ui/SettingsPosition.ui
+++ b/ui/SettingsPosition.ui
@@ -17,7 +17,7 @@
 
   <object class="AdwPreferencesPage" id="position">
     <property name="title">Position</property>
-    <property name="icon_name">document-properties</property>
+    <property name="icon_name">find-location</property>
 
       <!-- group panel -->
       <child>
diff --git a/ui/SettingsStyle.ui b/ui/SettingsStyle.ui
index b2ae021b..cdf525b4 100644
--- a/ui/SettingsStyle.ui
+++ b/ui/SettingsStyle.ui
@@ -36,7 +36,7 @@
 
   <object class="AdwPreferencesPage" id="style">
     <property name="title">Style</property>
-    <property name="icon_name">document-properties</property>
+    <property name="icon_name">image-adjust-color</property>
 
     <!-- group app icon style -->
     <child>

From 9fe030ec357f4aa2479a327eeb5ddfe90a774964 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 00:04:04 +0200
Subject: [PATCH 30/62] migrate box show desktop options to adw preferences
 group

---
 prefs.js                    |  12 +-
 ui/BoxShowDesktopOptions.ui | 284 +++++++++++-------------------------
 2 files changed, 96 insertions(+), 200 deletions(-)

diff --git a/prefs.js b/prefs.js
index cff63e48..8c8c6dbf 100644
--- a/prefs.js
+++ b/prefs.js
@@ -245,7 +245,10 @@ const Preferences = class {
         let isVertical = position == Pos.LEFT || position == Pos.RIGHT;
         let showDesktopWidthLabel = this._builder.get_object('show_showdesktop_width_label');
 
-        showDesktopWidthLabel.set_text(isVertical ? _('Show Desktop button height (px)') : _('Show Desktop button width (px)'));
+        if(this._window)
+            showDesktopWidthLabel.set_title(isVertical ? _('Show Desktop button height (px)') : _('Show Desktop button width (px)'));
+        else
+            showDesktopWidthLabel.set_text(isVertical ? _('Show Desktop button height (px)') : _('Show Desktop button width (px)'));
 
         this._displayPanelPositionsForMonitor(this._currentMonitorIndex);
     }
@@ -1308,6 +1311,13 @@ const Preferences = class {
                             'sensitive',
                             Gio.SettingsBindFlags.DEFAULT);
 
+        if(this._window) {
+            this._settings.bind('show-showdesktop-hover',
+                            this._builder.get_object('grid_show_showdesktop_hide_options2'),
+                            'sensitive',
+                            Gio.SettingsBindFlags.DEFAULT);
+        }
+
         this._settings.bind('show-appmenu',
                             this._builder.get_object('show_appmenu_switch'),
                             'active',
diff --git a/ui/BoxShowDesktopOptions.ui b/ui/BoxShowDesktopOptions.ui
index 8b976db5..f212d847 100644
--- a/ui/BoxShowDesktopOptions.ui
+++ b/ui/BoxShowDesktopOptions.ui
@@ -22,222 +22,108 @@
   </object>
 
   <object class="GtkBox" id="box_show_showdesktop_options">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
     <property name="orientation">vertical</property>
+    <property name="width-request">600</property>
+    <property name="spacing">8</property>
+
     <child>
-      <object class="GtkListBox" id="listbox_show_showdesktop_options">
-        <property name="visible">True</property>
-        <property name="can_focus">False</property>
-        <property name="selection_mode">none</property>
-        <property name="hexpand">1</property>
-        <property name="vexpand">1</property>
+      <object class="AdwPreferencesGroup">
+        <property name="margin-top">8</property>
+        <property name="margin-start">8</property>
+        <property name="margin-end">8</property>
+
         <child>
-          <object class="GtkListBoxRow" id="listboxrow_show_showdesktop_width">
-            <property name="visible">True</property>
-            <property name="can_focus">True</property>
+          <object class="AdwActionRow" id="show_showdesktop_width_label">
             <child>
-              <object class="GtkGrid" id="grid_show_showdesktop_width">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="margin_start">12</property>
-                <property name="margin_end">12</property>
-                <property name="margin_top">12</property>
-                <property name="margin_bottom">12</property>
-                <property name="row_spacing">4</property>
-                <property name="column_spacing">32</property>
-                <child>
-                  <object class="GtkLabel" id="show_showdesktop_width_label">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="xalign">0</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">0</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkSpinButton" id="show_showdesktop_width_spinbutton">
-                    <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="halign">end</property>
-                    <property name="width_chars">4</property>
-                    <property name="text">1</property>
-                    <property name="adjustment">show_showdesktop_width_adjustment</property>
-                    <property name="numeric">True</property>
-                    <property name="value">1</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">1</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkLabel" id="override_show_desktop_line_color_label">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="label" translatable="yes">Override Show Desktop line color</property>
-                    <property name="xalign">0</property>
-                    <layout>
-                      <property name="row">1</property>
-                      <property name="column">0</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkBox" id="override_show_desktop_line_color_box">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="spacing">12</property>
-                    <property name="halign">end</property>
-                    <child>
-                      <object class="GtkColorButton" id="override_show_desktop_line_color_colorbutton">
-                         <property name="visible">True</property>
-                         <property name="can_focus">True</property>
-                         <property name="receives_default">True</property>
-                         <property name="halign">end</property>
-                         <property name="use_alpha">True</property>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="override_show_desktop_line_color_switch">
-                         <property name="visible">True</property>
-                         <property name="can_focus">True</property>
-                         <property name="halign">end</property>
-                         <property name="valign">center</property>
-                      </object>
-                    </child>
-                    <layout>
-                      <property name="row">1</property>
-                      <property name="column">1</property>
-                    </layout>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="show_showdesktop_width_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">1</property>
+                <property name="adjustment">show_showdesktop_width_adjustment</property>
+                <property name="numeric">True</property>
+                <property name="value">1</property>
               </object>
             </child>
           </object>
         </child>
+
         <child>
-          <object class="GtkListBoxRow" id="listboxrow_show_showdesktop_hide">
-            <property name="visible">True</property>
-            <property name="can_focus">True</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Override Show Desktop line color</property>
             <child>
-              <object class="GtkGrid" id="grid_show_showdesktop_hide">
+              <object class="GtkColorButton" id="override_show_desktop_line_color_colorbutton">>
+                <property name="receives_default">True</property>
+                <property name="valign">center</property>
+                <property name="use_alpha">True</property>
+              </object>
+            </child>
+            <child>
+              <object class="GtkSwitch" id="override_show_desktop_line_color_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <child>
+      <object class="AdwPreferencesGroup">
+        <property name="margin-start">8</property>
+        <property name="margin-end">8</property>
+        <property name="margin-bottom">8</property>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Reveal the desktop when hovering the Show Desktop button</property>
+            <property name="subtitle" translatable="yes"></property>
+            <child>
+              <object class="GtkSwitch" id="show_showdesktop_hide_switch">
                 <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="margin_start">12</property>
-                <property name="margin_end">12</property>
-                <property name="margin_top">12</property>
-                <property name="margin_bottom">12</property>
-                <property name="row_spacing">12</property>
-                <property name="column_spacing">32</property>
-                <child>
-                  <object class="GtkLabel" id="show_showdesktop_hide_label">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="label" translatable="yes">Reveal the desktop when hovering the Show Desktop button</property>
-                    <property name="use_markup">True</property>
-                    <property name="xalign">0</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">0</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkSwitch" id="show_showdesktop_hide_switch">
-                    <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="halign">end</property>
-                    <property name="valign">center</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">1</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkGrid" id="grid_show_showdesktop_hide_options">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="row_spacing">4</property>
-                    <child>
-                      <object class="GtkLabel" id="show_showdesktop_delay_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Delay before revealing the desktop (ms)</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSpinButton" id="show_showdesktop_delay_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="width_chars">4</property>
-                        <property name="text">1</property>
-                        <property name="adjustment">show_showdesktop_delay_adjustment</property>
-                        <property name="numeric">True</property>
-                        <property name="value">1</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="show_showdesktop_time_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Fade duration (ms)</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSpinButton" id="show_showdesktop_time_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="width_chars">4</property>
-                        <property name="text">1</property>
-                        <property name="adjustment">show_showdesktop_time_adjustment</property>
-                        <property name="numeric">True</property>
-                        <property name="value">1</property>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <layout>
-                      <property name="row">1</property>
-                      <property name="column">0</property>
-                      <property name="column-span">2</property>
-                    </layout>
-                  </object>
-                </child>
+                <property name="can_focus">True</property>
+                <property name="halign">end</property>
+                <property name="valign">center</property>
               </object>
             </child>
           </object>
         </child>
+
+        <child>
+          <object class="AdwActionRow" id="grid_show_showdesktop_hide_options">
+            <property name="title" translatable="yes">Delay before revealing the desktop (ms)</property>
+            <child>
+              <object class="GtkSpinButton" id="show_showdesktop_delay_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">1</property>
+                <property name="adjustment">show_showdesktop_delay_adjustment</property>
+                <property name="numeric">True</property>
+                <property name="value">1</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow" id="grid_show_showdesktop_hide_options2">
+            <property name="title" translatable="yes">Fade duration (ms)</property>
+            <child>
+              <object class="GtkSpinButton" id="show_showdesktop_time_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">1</property>
+                <property name="adjustment">show_showdesktop_time_adjustment</property>
+                <property name="numeric">True</property>
+                <property name="value">1</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
       </object>
     </child>
+
   </object>
 
 </interface>
\ No newline at end of file

From 99f776a33870c2f41f30e6cd27d5d215bab745df Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 00:37:24 +0200
Subject: [PATCH 31/62] migrate box advanced options to adw preferences group,
 harmonised box dialog file names

---
 prefs.js                                      |  9 ++--
 ui/BoxAdvancedOptions.ui                      | 42 ++++++-------------
 ...ns.ui => BoxAnimateAppIconHoverOptions.ui} |  0
 ...nOptionsBox.ui => BoxScrollIconOptions.ui} |  0
 ...OptionsBox.ui => BoxScrollPanelOptions.ui} |  0
 ...tions.ui => BoxShowApplicationsOptions.ui} |  0
 ui/BoxShowDesktopOptions.ui                   |  1 -
 7 files changed, 17 insertions(+), 35 deletions(-)
 rename ui/{AnimateAppIconHoverOptions.ui => BoxAnimateAppIconHoverOptions.ui} (100%)
 rename ui/{ScrollIconOptionsBox.ui => BoxScrollIconOptions.ui} (100%)
 rename ui/{ScrollPanelOptionsBox.ui => BoxScrollPanelOptions.ui} (100%)
 rename ui/{ShowApplicationsOptions.ui => BoxShowApplicationsOptions.ui} (100%)

diff --git a/prefs.js b/prefs.js
index 8c8c6dbf..10d7e61c 100644
--- a/prefs.js
+++ b/prefs.js
@@ -170,19 +170,19 @@ const Preferences = class {
             window.set_search_enabled(true);
 
             // dialogs
-            this._builder.add_from_file(Me.path + '/ui/AnimateAppIconHoverOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxAnimateAppIconHoverOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxDotOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxShowDesktopOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxDynamicOpacityOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxIntellihideOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/ShowApplicationsOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxShowApplicationsOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxWindowPreviewOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxGroupAppsOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxMiddleClickOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxOverlayShortcut.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxSecondaryMenuOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/ScrollPanelOptionsBox.ui');
-            this._builder.add_from_file(Me.path + '/ui/ScrollIconOptionsBox.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxScrollPanelOptions.ui');
+            this._builder.add_from_file(Me.path + '/ui/BoxScrollIconOptions.ui');
             this._builder.add_from_file(Me.path + '/ui/BoxAdvancedOptions.ui');
 
             // pages
@@ -1926,7 +1926,6 @@ const Preferences = class {
 
         // setup dialog for advanced options
         this._builder.get_object('button_advanced_options').connect('clicked', () => {
-            print("nj");
             let box = this._builder.get_object('box_advanced_options');
 
             let dialog = this._createPreferencesDialog(_('Advanced Options'), box);
diff --git a/ui/BoxAdvancedOptions.ui b/ui/BoxAdvancedOptions.ui
index fd71fc04..0cfb87d7 100644
--- a/ui/BoxAdvancedOptions.ui
+++ b/ui/BoxAdvancedOptions.ui
@@ -3,40 +3,24 @@
   <requires lib="gtk" version="4.0"/>
 
   <object class="GtkBox" id="box_advanced_options">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
     <property name="orientation">vertical</property>
-    <property name="hexpand">1</property>
-    <property name="vexpand">1</property>
+    <property name="width-request">600</property>
+    <property name="spacing">8</property>
+
     <child>
-      <object class="GtkFrame" id="frame_advanced_options">
-        <property name="visible">True</property>
-        <property name="can_focus">False</property>
-        <property name="label_xalign">0</property>
+      <object class="AdwPreferencesGroup">
+        <property name="margin-top">8</property>
+        <property name="margin-bottom">8</property>
+        <property name="margin-start">8</property>
+        <property name="margin-end">8</property>
+
         <child>
-          <object class="GtkListBox" id="listbox_advanced_options">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="selection_mode">none</property>
-            <child>
-              <object class="GtkListBoxRow" id="listbox_advanced_nothing">
-                <property name="width_request">100</property>
-                <property name="height_request">80</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkLabel" id="advanced_nothing_label">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="label" translatable="yes">Nothing yet!</property>
-                    <property name="use_markup">True</property>
-                  </object>
-                </child>
-              </object>
-            </child>
+          <object class="AdwActionRow" id="show_showdesktop_width_label">
+            <property name="title" translatable="yes">Nothing yet!</property>
+            <property name="subtitle" translatable="yes">For real...</property>
           </object>
         </child>
+
       </object>
     </child>
   </object>
diff --git a/ui/AnimateAppIconHoverOptions.ui b/ui/BoxAnimateAppIconHoverOptions.ui
similarity index 100%
rename from ui/AnimateAppIconHoverOptions.ui
rename to ui/BoxAnimateAppIconHoverOptions.ui
diff --git a/ui/ScrollIconOptionsBox.ui b/ui/BoxScrollIconOptions.ui
similarity index 100%
rename from ui/ScrollIconOptionsBox.ui
rename to ui/BoxScrollIconOptions.ui
diff --git a/ui/ScrollPanelOptionsBox.ui b/ui/BoxScrollPanelOptions.ui
similarity index 100%
rename from ui/ScrollPanelOptionsBox.ui
rename to ui/BoxScrollPanelOptions.ui
diff --git a/ui/ShowApplicationsOptions.ui b/ui/BoxShowApplicationsOptions.ui
similarity index 100%
rename from ui/ShowApplicationsOptions.ui
rename to ui/BoxShowApplicationsOptions.ui
diff --git a/ui/BoxShowDesktopOptions.ui b/ui/BoxShowDesktopOptions.ui
index f212d847..8319b7ee 100644
--- a/ui/BoxShowDesktopOptions.ui
+++ b/ui/BoxShowDesktopOptions.ui
@@ -77,7 +77,6 @@
         <child>
           <object class="AdwActionRow">
             <property name="title" translatable="yes">Reveal the desktop when hovering the Show Desktop button</property>
-            <property name="subtitle" translatable="yes"></property>
             <child>
               <object class="GtkSwitch" id="show_showdesktop_hide_switch">
                 <property name="visible">True</property>

From 85c252d8ed79e6f2c6188aca0699e2113358f308 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 01:00:27 +0200
Subject: [PATCH 32/62] migrate box animate app icon hover options to adw
 preferences group

---
 ui/BoxAdvancedOptions.ui            |  12 +-
 ui/BoxAnimateAppIconHoverOptions.ui | 214 +++++++---------------------
 ui/SettingsFineTune.ui              |   4 -
 3 files changed, 61 insertions(+), 169 deletions(-)

diff --git a/ui/BoxAdvancedOptions.ui b/ui/BoxAdvancedOptions.ui
index 0cfb87d7..d80a52e8 100644
--- a/ui/BoxAdvancedOptions.ui
+++ b/ui/BoxAdvancedOptions.ui
@@ -5,17 +5,17 @@
   <object class="GtkBox" id="box_advanced_options">
     <property name="orientation">vertical</property>
     <property name="width-request">600</property>
-    <property name="spacing">8</property>
+    <property name="spacing">12</property>
 
     <child>
       <object class="AdwPreferencesGroup">
-        <property name="margin-top">8</property>
-        <property name="margin-bottom">8</property>
-        <property name="margin-start">8</property>
-        <property name="margin-end">8</property>
+        <property name="margin-top">12</property>
+        <property name="margin-bottom">12</property>
+        <property name="margin-start">12</property>
+        <property name="margin-end">12</property>
 
         <child>
-          <object class="AdwActionRow" id="show_showdesktop_width_label">
+          <object class="AdwActionRow">
             <property name="title" translatable="yes">Nothing yet!</property>
             <property name="subtitle" translatable="yes">For real...</property>
           </object>
diff --git a/ui/BoxAnimateAppIconHoverOptions.ui b/ui/BoxAnimateAppIconHoverOptions.ui
index 28f7ad14..2babe5ac 100644
--- a/ui/BoxAnimateAppIconHoverOptions.ui
+++ b/ui/BoxAnimateAppIconHoverOptions.ui
@@ -46,37 +46,21 @@
   </object>
 
   <object class="GtkBox" id="animate_appicon_hover_options">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
     <property name="orientation">vertical</property>
-    <property name="hexpand">1</property>
-    <property name="vexpand">1</property>
+    <property name="width-request">600</property>
+    <property name="spacing">12</property>
+
     <child>
-      <object class="GtkListBoxRow" id="animate_appicon_hover_options_type_listboxrow">
-        <property name="visible">True</property>
-        <property name="can_focus">True</property>
-        <property name="activatable">False</property>
+      <object class="AdwPreferencesGroup">
+        <property name="margin-top">12</property>
+        <property name="margin-start">12</property>
+        <property name="margin-end">12</property>
+
         <child>
-          <object class="GtkBox" id="animate_appicon_hover_options_type_box">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="margin_start">12</property>
-            <property name="margin_end">12</property>
-            <property name="margin_top">12</property>
-            <property name="margin_bottom">12</property>
-            <property name="spacing">32</property>
-            <child>
-              <object class="GtkLabel" id="animate_appicon_hover_options_type_label">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="hexpand">True</property>
-                <property name="label" translatable="yes">Animation type</property>
-                <property name="xalign">0</property>
-              </object>
-            </child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Animation type</property>
             <child>
               <object class="GtkComboBoxText" id="animate_appicon_hover_options_type_combo">
-                <property name="visible">True</property>
                 <property name="can_focus">False</property>
                 <property name="valign">center</property>
                 <items>
@@ -88,72 +72,38 @@
             </child>
           </object>
         </child>
+
       </object>
     </child>
+
     <child>
-      <object class="GtkListBoxRow" id="animate_appicon_hover_options_params_listboxrow">
-        <property name="visible">True</property>
-        <property name="can_focus">True</property>
-        <property name="activatable">False</property>
+      <object class="AdwPreferencesGroup">
+        <property name="margin-bottom">12</property>
+        <property name="margin-start">12</property>
+        <property name="margin-end">12</property>
+
         <child>
-          <object class="GtkGrid" id="animate_appicon_hover_options_params_grid">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="margin_start">12</property>
-            <property name="margin_end">12</property>
-            <property name="margin_top">12</property>
-            <property name="margin_bottom">12</property>
-            <property name="row_spacing">24</property>
-            <property name="column_spacing">32</property>
-            <child>
-              <object class="GtkLabel" id="animate_appicon_hover_options_duration_label">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="margin_end">12</property>
-                <property name="label" translatable="yes">Duration</property>
-                <property name="use_markup">True</property>
-                <property name="xalign">0</property>
-                <property name="valign">end</property>
-                <layout>
-                  <property name="row">0</property>
-                  <property name="column">0</property>
-                </layout>
-              </object>
-            </child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Duration</property>
             <child>
               <object class="GtkScale" id="animate_appicon_hover_options_duration_scale">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="valign">end</property>
+                <property name="valign">center</property>
                 <property name="hexpand">True</property>
                 <property name="adjustment">animate_appicon_hover_options_duration_adjustment</property>
                 <property name="round_digits">0</property>
                 <property name="digits">0</property>
                 <property name="value_pos">right</property>
                 <property name="draw_value">True</property>
-                <layout>
-                  <property name="row">0</property>
-                  <property name="column">1</property>
-                </layout>
-              </object>
-            </child>
-            <child>
-              <object class="GtkLabel" id="animate_appicon_hover_options_extent_rotation">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="label" translatable="yes">Rotation</property>
-                <property name="xalign">0</property>
-                <property name="valign">end</property>
-                <layout>
-                  <property name="row">1</property>
-                  <property name="column">0</property>
-                </layout>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Rotation</property>
             <child>
               <object class="GtkScale" id="animate_appicon_hover_options_rotation_scale">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
                 <property name="valign">end</property>
                 <property name="hexpand">True</property>
                 <property name="adjustment">animate_appicon_hover_options_rotation_adjustment</property>
@@ -161,89 +111,50 @@
                 <property name="digits">0</property>
                 <property name="value_pos">right</property>
                 <property name="draw_value">True</property>
-                <layout>
-                  <property name="row">1</property>
-                  <property name="column">1</property>
-                </layout>
-              </object>
-            </child>
-            <child>
-              <object class="GtkLabel" id="animate_appicon_hover_options_travel_label">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="label" translatable="yes">Travel</property>
-                <property name="xalign">0</property>
-                <property name="valign">end</property>
-                <layout>
-                  <property name="row">2</property>
-                  <property name="column">0</property>
-                </layout>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Travel</property>
             <child>
               <object class="GtkScale" id="animate_appicon_hover_options_travel_scale">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="valign">end</property>
+                <property name="valign">center</property>
                 <property name="hexpand">True</property>
                 <property name="adjustment">animate_appicon_hover_options_travel_adjustment</property>
                 <property name="round_digits">0</property>
                 <property name="digits">0</property>
                 <property name="value_pos">right</property>
                 <property name="draw_value">True</property>
-                <layout>
-                  <property name="row">2</property>
-                  <property name="column">1</property>
-                </layout>
-              </object>
-            </child>
-            <child>
-              <object class="GtkLabel" id="animate_appicon_hover_options_zoom_label">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="label" translatable="yes">Zoom</property>
-                <property name="xalign">0</property>
-                <property name="valign">end</property>
-                <layout>
-                  <property name="row">3</property>
-                  <property name="column">0</property>
-                </layout>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Zoom</property>
             <child>
               <object class="GtkScale" id="animate_appicon_hover_options_zoom_scale">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="valign">end</property>
+                <property name="valign">center</property>
                 <property name="hexpand">True</property>
                 <property name="adjustment">animate_appicon_hover_options_zoom_adjustment</property>
                 <property name="round_digits">0</property>
                 <property name="digits">0</property>
                 <property name="value_pos">right</property>
                 <property name="draw_value">True</property>
-                <layout>
-                  <property name="row">3</property>
-                  <property name="column">1</property>
-                </layout>
-              </object>
-            </child>
-            <child>
-              <object class="GtkLabel" id="animate_appicon_hover_options_convexity_label">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="label" translatable="yes">Convexity</property>
-                <property name="xalign">0</property>
-                <property name="valign">end</property>
-                <layout>
-                  <property name="row">4</property>
-                  <property name="column">0</property>
-                </layout>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Convexity</property>
             <child>
               <object class="GtkScale" id="animate_appicon_hover_options_convexity_scale">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
                 <property name="valign">end</property>
                 <property name="hexpand">True</property>
                 <property name="adjustment">animate_appicon_hover_options_convexity_adjustment</property>
@@ -251,46 +162,31 @@
                 <property name="digits">1</property>
                 <property name="value_pos">right</property>
                 <property name="draw_value">True</property>
-                <layout>
-                  <property name="row">4</property>
-                  <property name="column">1</property>
-                </layout>
-              </object>
-            </child>
-            <child>
-              <object class="GtkLabel" id="animate_appicon_hover_options_extent_label">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="label" translatable="yes">Extent</property>
-                <property name="xalign">0</property>
-                <property name="valign">end</property>
-                <layout>
-                  <property name="row">5</property>
-                  <property name="column">0</property>
-                </layout>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Extent</property>
             <child>
               <object class="GtkScale" id="animate_appicon_hover_options_extent_scale">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="valign">end</property>
+                <property name="valign">center</property>
                 <property name="hexpand">True</property>
                 <property name="adjustment">animate_appicon_hover_options_extent_adjustment</property>
                 <property name="round_digits">0</property>
                 <property name="digits">0</property>
                 <property name="value_pos">right</property>
                 <property name="draw_value">True</property>
-                <layout>
-                  <property name="row">5</property>
-                  <property name="column">1</property>
-                </layout>
               </object>
             </child>
           </object>
         </child>
+
       </object>
     </child>
+
   </object>
 
 </interface>
\ No newline at end of file
diff --git a/ui/SettingsFineTune.ui b/ui/SettingsFineTune.ui
index 61fd0768..34eb1a52 100644
--- a/ui/SettingsFineTune.ui
+++ b/ui/SettingsFineTune.ui
@@ -52,8 +52,6 @@
               <property name="subtitle" translatable="yes">(0 = theme default)</property>
               <child>
                 <object class="GtkScale" id="tray_size_scale">
-                  <property name="visible">True</property>
-                  <property name="can_focus">True</property>
                   <property name="valign">baseline</property>
                   <property name="hexpand">True</property>
                   <property name="adjustment">tray_size_adjustment</property>
@@ -73,8 +71,6 @@
               <property name="subtitle" translatable="yes">(0 = theme default)</property>
               <child>
                 <object class="GtkScale" id="leftbox_size_scale">
-                  <property name="visible">True</property>
-                  <property name="can_focus">True</property>
                   <property name="valign">baseline</property>
                   <property name="hexpand">True</property>
                   <property name="adjustment">leftbox_size_adjustment</property>

From fcf1cd10c1ef25ba243d1fad359803fd276ac069 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 01:58:58 +0200
Subject: [PATCH 33/62] migrate box dot options to adw preferences group

---
 prefs.js            |   1 -
 ui/BoxDotOptions.ui | 776 ++++++++++++++------------------------------
 2 files changed, 240 insertions(+), 537 deletions(-)

diff --git a/prefs.js b/prefs.js
index 10d7e61c..1a400351 100644
--- a/prefs.js
+++ b/prefs.js
@@ -2042,7 +2042,6 @@ const Preferences = class {
         }
 
         this._builder.get_object('animate_appicon_hover_button').connect('clicked', () => {
-            print("BB");
             let box = this._builder.get_object('animate_appicon_hover_options');
 
             let dialog = this._createPreferencesDialog(_('App icon animation options'), box, () =>
diff --git a/ui/BoxDotOptions.ui b/ui/BoxDotOptions.ui
index d75e3375..fb95737d 100644
--- a/ui/BoxDotOptions.ui
+++ b/ui/BoxDotOptions.ui
@@ -15,571 +15,275 @@
     <property name="page_increment">5</property>
   </object>
 
-  <object class="GtkBox" id="box_dots_options">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
-    <property name="margin_top">12</property>
-    <property name="margin_bottom">12</property>
-    <property name="orientation">vertical</property>
-    <property name="hexpand">1</property>
-    <property name="vexpand">1</property>
+  <object class="GtkScrolledWindow" id="box_dots_options">
+    <property name="width-request">600</property>
+    <property name="height-request">600</property>
+    <property name="vexpand">True</property>
     <child>
-      <object class="GtkFrame" id="frame_dots_options">
-        <property name="visible">True</property>
-        <property name="can_focus">False</property>
-        <property name="margin_start">12</property>
-        <property name="margin_end">12</property>
-        <property name="margin_top">12</property>
-        <property name="margin_bottom">12</property>
-        <property name="label_xalign">0</property>
+
+      <object class="GtkBox">
+        <property name="orientation">vertical</property>
+        <property name="spacing">12</property>
+
+        <child>
+          <object class="AdwPreferencesGroup">
+            <property name="margin-top">12</property>
+            <property name="margin-start">12</property>
+            <property name="margin-end">12</property>
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Highlight focused application</property>
+                <child>
+                  <object class="GtkSwitch" id="focus_highlight_switch">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwPreferencesGroup" id="grid_focus_highlight_options">
+            <property name="margin-top">12</property>
+            <property name="margin-start">12</property>
+            <property name="margin-end">12</property>
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Icon dominant color</property>
+                <child>
+                  <object class="GtkSwitch" id="focus_highlight_dominant_switch">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+            <child>
+              <object class="AdwActionRow" id="focus_highlight_color_label">
+                <property name="title" translatable="yes">Custom color</property>
+                <child>
+                  <object class="GtkColorButton" id="focus_highlight_color_colorbutton">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Highlight opacity</property>
+                <child>
+                  <object class="GtkSpinButton" id="focus_highlight_opacity_spinbutton">
+                    <property name="valign">center</property>
+                    <property name="text">5</property>
+                    <property name="adjustment">focus_highlight_opacity_adjustment</property>
+                    <property name="value">5</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwPreferencesGroup">
+            <property name="margin-top">12</property>
+            <property name="margin-start">12</property>
+            <property name="margin-end">12</property>
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Indicator size (px)</property>
+                <child>
+                  <object class="GtkSpinButton" id="dot_size_spinbutton">
+                    <property name="valign">center</property>
+                    <property name="text">0</property>
+                    <property name="adjustment">dot_size_adjustment</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Indicator color - Icon Dominant</property>
+                <child>
+                  <object class="GtkSwitch" id="dot_color_dominant_switch">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwPreferencesGroup">
+            <property name="margin-top">12</property>
+            <property name="margin-start">12</property>
+            <property name="margin-end">12</property>
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Indicator color - Override Theme</property>
+                <child>
+                  <object class="GtkSwitch" id="dot_color_override_switch">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwPreferencesGroup" id="grid_dot_color">
+            <property name="margin-top">12</property>
+            <property name="margin-start">12</property>
+            <property name="margin-end">12</property>
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">1 window open (or ungrouped)</property>
+                <child>
+                  <object class="GtkButton" id="dot_color_apply_all_button">
+                    <property name="valign">center</property>
+                    <property name="label" translatable="yes">Apply to all</property>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkColorButton" id="dot_color_1_colorbutton">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">2 windows open</property>
+                <child>
+                  <object class="GtkColorButton" id="dot_color_2_colorbutton">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">3 windows open</property>
+                <child>
+                  <object class="GtkColorButton" id="dot_color_3_colorbutton">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">4+ windows open</property>
+                <child>
+                  <object class="GtkColorButton" id="dot_color_4_colorbutton">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwPreferencesGroup" id="dot_color_unfocused_box">
+            <property name="margin-top">12</property>
+            <property name="margin-start">12</property>
+            <property name="margin-end">12</property>
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Use different for unfocused</property>
+                <child>
+                  <object class="GtkSwitch" id="dot_color_unfocused_different_switch">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+          </object>
+        </child>
+
+        <!-- TODO sensitivity of this group has to be connected to dot_color_override_switch -->
         <child>
-          <object class="GtkListBox" id="listbox_dots_options">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="selection_mode">none</property>
+          <object class="AdwPreferencesGroup" id="grid_dot_color_unfocused">
+            <property name="margin-top">12</property>
+            <property name="margin-bottom">12</property>
+            <property name="margin-start">12</property>
+            <property name="margin-end">12</property>
+
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_focus_highlight">
-                <property name="width_request">100</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">1 window open (or ungrouped)</property>
+                <child>
+                  <object class="GtkButton" id="dot_color_unfocused_apply_all_button">
+                    <property name="valign">center</property>
+                    <property name="label" translatable="yes">Apply to all</property>
+                  </object>
+                </child>
                 <child>
-                  <object class="GtkGrid" id="grid_focus_highlight">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="row_spacing">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="focus_highlight_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Highlight focused application</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="focus_highlight_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkGrid" id="grid_focus_highlight_options">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="margin_start">12</property>
-                        <property name="row_spacing">8</property>
-                        <child>
-                          <object class="GtkLabel" id="focus_highlight_dominant_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Icon dominant color</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkSwitch" id="focus_highlight_dominant_switch">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="halign">end</property>
-                            <property name="valign">center</property>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkLabel" id="focus_highlight_color_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Custom color</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">1</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkColorButton" id="focus_highlight_color_colorbutton">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="receives_default">True</property>
-                            <property name="halign">end</property>
-                            <layout>
-                              <property name="row">1</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkLabel" id="focus_highlight_opacity_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Highlight opacity</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">2</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkSpinButton" id="focus_highlight_opacity_spinbutton">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="halign">end</property>
-                            <property name="text">5</property>
-                            <property name="adjustment">focus_highlight_opacity_adjustment</property>
-                            <property name="value">5</property>
-                            <layout>
-                              <property name="row">2</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
+                  <object class="GtkColorButton" id="dot_color_unfocused_1_colorbutton">
+                    <property name="valign">center</property>
                   </object>
                 </child>
               </object>
             </child>
+
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_dot_size">
-                <property name="width_request">100</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">2 windows open</property>
                 <child>
-                  <object class="GtkGrid" id="grid_dot_size">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="dot_size_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Indicator size (px)</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSpinButton" id="dot_size_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="text">0</property>
-                        <property name="adjustment">dot_size_adjustment</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
+                  <object class="GtkColorButton" id="dot_color_unfocused_2_colorbutton">
+                    <property name="valign">center</property>
                   </object>
                 </child>
               </object>
             </child>
+
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_dot_dominant">
-                <property name="width_request">100</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">3 windows open</property>
                 <child>
-                  <object class="GtkGrid" id="grid_dot_dominant">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="dot_dominant_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Indicator color - Icon Dominant</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="dot_color_dominant_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
+                  <object class="GtkColorButton" id="dot_color_unfocused_3_colorbutton">
+                    <property name="valign">center</property>
                   </object>
                 </child>
               </object>
             </child>
+
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_dot_color">
-                <property name="width_request">100</property>
-                <property name="height_request">80</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">4+ windows open</property>
                 <child>
-                  <object class="GtkBox" id="box_dot_color">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="orientation">vertical</property>
-                    <child>
-                      <object class="GtkBox" id="dot_color_override_box">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <child>
-                          <object class="GtkLabel" id="dot_color_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Indicator color - Override Theme</property>
-                            <property name="xalign">0</property>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkSwitch" id="dot_color_override_switch">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="halign">end</property>
-                            <property name="valign">center</property>
-                          </object>
-                        </child>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkGrid" id="grid_dot_color">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="margin_start">12</property>
-                        <property name="margin_top">12</property>
-                        <property name="margin_bottom">12</property>
-                        <property name="row_spacing">4</property>
-                        <property name="column_spacing">32</property>
-                        <child>
-                          <object class="GtkLabel" id="dot_color_1_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">1 window open (or ungrouped)</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkBox" id="dot_color_1_box">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="halign">end</property>
-                            <child>
-                              <object class="GtkButton" id="dot_color_apply_all_button">
-                                <property name="label" translatable="yes">Apply to all</property>
-                                <property name="visible">True</property>
-                                <property name="can_focus">True</property>
-                                <property name="receives_default">True</property>
-                              </object>
-                            </child>
-                            <child>
-                              <object class="GtkColorButton" id="dot_color_1_colorbutton">
-                                <property name="visible">True</property>
-                                <property name="can_focus">True</property>
-                                <property name="receives_default">True</property>
-                                <property name="halign">end</property>
-                              </object>
-                            </child>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkLabel" id="dot_color_2_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">2 windows open</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">1</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkLabel" id="dot_color_3_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">3 windows open</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">2</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkLabel" id="dot_color_4_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">4+ windows open</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">3</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkColorButton" id="dot_color_2_colorbutton">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="receives_default">True</property>
-                            <property name="halign">end</property>
-                            <layout>
-                              <property name="row">1</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkColorButton" id="dot_color_3_colorbutton">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="receives_default">True</property>
-                            <property name="halign">end</property>
-                            <layout>
-                              <property name="row">2</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkColorButton" id="dot_color_4_colorbutton">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="receives_default">True</property>
-                            <property name="halign">end</property>
-                            <layout>
-                              <property name="row">3</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkBox" id="dot_color_unfocused_box">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="orientation">vertical</property>
-                        <child>
-                          <object class="GtkBox" id="dot_color_unfocused_different_box">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="margin_start">12</property>
-                            <child>
-                              <object class="GtkLabel" id="dot_color_unfocused_label">
-                                <property name="visible">True</property>
-                                <property name="can_focus">False</property>
-                                <property name="hexpand">True</property>
-                                <property name="label" translatable="yes">Use different for unfocused</property>
-                                <property name="xalign">0</property>
-                              </object>
-                            </child>
-                            <child>
-                              <object class="GtkSwitch" id="dot_color_unfocused_different_switch">
-                                <property name="visible">True</property>
-                                <property name="can_focus">True</property>
-                                <property name="halign">end</property>
-                                <property name="valign">center</property>
-                              </object>
-                            </child>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkGrid" id="grid_dot_color_unfocused">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="margin_start">12</property>
-                            <property name="margin_top">12</property>
-                            <property name="margin_bottom">12</property>
-                            <property name="row_spacing">4</property>
-                            <property name="column_spacing">32</property>
-                            <child>
-                              <object class="GtkLabel" id="dot_color_unfocused_1_label">
-                                <property name="visible">True</property>
-                                <property name="can_focus">False</property>
-                                <property name="hexpand">True</property>
-                                <property name="label" translatable="yes">1 window open (or ungrouped)</property>
-                                <property name="xalign">0</property>
-                                <layout>
-                                  <property name="row">0</property>
-                                  <property name="column">0</property>
-                                </layout>
-                              </object>
-                            </child>
-                            <child>
-                              <object class="GtkBox" id="dot_color_unfocused_1_box">
-                                <property name="visible">True</property>
-                                <property name="can_focus">False</property>
-                                <property name="halign">end</property>
-                                <child>
-                                  <object class="GtkButton" id="dot_color_unfocused_apply_all_button">
-                                    <property name="label" translatable="yes">Apply to all</property>
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="receives_default">True</property>
-                                  </object>
-                                </child>
-                                <child>
-                                  <object class="GtkColorButton" id="dot_color_unfocused_1_colorbutton">
-                                    <property name="visible">True</property>
-                                    <property name="can_focus">True</property>
-                                    <property name="receives_default">True</property>
-                                    <property name="halign">end</property>
-                                  </object>
-                                </child>
-                                <layout>
-                                  <property name="row">0</property>
-                                  <property name="column">1</property>
-                                </layout>
-                              </object>
-                            </child>
-                            <child>
-                              <object class="GtkLabel" id="dot_color_unfocused_2_label">
-                                <property name="visible">True</property>
-                                <property name="can_focus">False</property>
-                                <property name="hexpand">True</property>
-                                <property name="label" translatable="yes">2 windows open</property>
-                                <property name="xalign">0</property>
-                                <layout>
-                                  <property name="row">1</property>
-                                  <property name="column">0</property>
-                                </layout>
-                              </object>
-                            </child>
-                            <child>
-                              <object class="GtkColorButton" id="dot_color_unfocused_2_colorbutton">
-                                <property name="visible">True</property>
-                                <property name="can_focus">True</property>
-                                <property name="receives_default">True</property>
-                                <property name="halign">end</property>
-                                <layout>
-                                  <property name="row">1</property>
-                                  <property name="column">1</property>
-                                </layout>
-                              </object>
-                            </child>
-                            <child>
-                              <object class="GtkLabel" id="dot_color_unfocused_3_label">
-                                <property name="visible">True</property>
-                                <property name="can_focus">False</property>
-                                <property name="hexpand">True</property>
-                                <property name="label" translatable="yes">3 windows open</property>
-                                <property name="xalign">0</property>
-                                <layout>
-                                  <property name="row">2</property>
-                                  <property name="column">0</property>
-                                </layout>
-                              </object>
-                            </child>
-                            <child>
-                              <object class="GtkColorButton" id="dot_color_unfocused_3_colorbutton">
-                                <property name="visible">True</property>
-                                <property name="can_focus">True</property>
-                                <property name="receives_default">True</property>
-                                <property name="halign">end</property>
-                                <layout>
-                                  <property name="row">2</property>
-                                  <property name="column">1</property>
-                                </layout>
-                              </object>
-                            </child>
-                            <child>
-                              <object class="GtkLabel" id="dot_color_unfocused_4_label">
-                                <property name="visible">True</property>
-                                <property name="can_focus">False</property>
-                                <property name="hexpand">True</property>
-                                <property name="label" translatable="yes">4+ windows open</property>
-                                <property name="xalign">0</property>
-                                <layout>
-                                  <property name="row">3</property>
-                                  <property name="column">0</property>
-                                </layout>
-                              </object>
-                            </child>
-                            <child>
-                              <object class="GtkColorButton" id="dot_color_unfocused_4_colorbutton">
-                                <property name="visible">True</property>
-                                <property name="can_focus">True</property>
-                                <property name="receives_default">True</property>
-                                <property name="halign">end</property>
-                                <layout>
-                                  <property name="row">3</property>
-                                  <property name="column">1</property>
-                                </layout>
-                              </object>
-                            </child>
-                          </object>
-                        </child>
-                      </object>
-                    </child>
+                  <object class="GtkColorButton" id="dot_color_unfocused_4_colorbutton">
+                    <property name="valign">center</property>
                   </object>
                 </child>
               </object>
             </child>
+
           </object>
         </child>
+
       </object>
+
     </child>
   </object>
 

From 6b0d24f1a5aeea86f9b6a50307efd502cfd08758 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 02:45:30 +0200
Subject: [PATCH 34/62] set GtkScale width

---
 ui/BoxAnimateAppIconHoverOptions.ui | 12 ++++++------
 ui/BoxDotOptions.ui                 |  4 ++--
 ui/SettingsFineTune.ui              | 15 +++++----------
 ui/SettingsPosition.ui              |  4 ++--
 ui/SettingsStyle.ui                 |  6 ++----
 5 files changed, 17 insertions(+), 24 deletions(-)

diff --git a/ui/BoxAnimateAppIconHoverOptions.ui b/ui/BoxAnimateAppIconHoverOptions.ui
index 2babe5ac..26ed9842 100644
--- a/ui/BoxAnimateAppIconHoverOptions.ui
+++ b/ui/BoxAnimateAppIconHoverOptions.ui
@@ -88,7 +88,7 @@
             <child>
               <object class="GtkScale" id="animate_appicon_hover_options_duration_scale">
                 <property name="valign">center</property>
-                <property name="hexpand">True</property>
+                <property name="width-request">300</property>
                 <property name="adjustment">animate_appicon_hover_options_duration_adjustment</property>
                 <property name="round_digits">0</property>
                 <property name="digits">0</property>
@@ -105,7 +105,7 @@
             <child>
               <object class="GtkScale" id="animate_appicon_hover_options_rotation_scale">
                 <property name="valign">end</property>
-                <property name="hexpand">True</property>
+                <property name="width-request">300</property>
                 <property name="adjustment">animate_appicon_hover_options_rotation_adjustment</property>
                 <property name="round_digits">0</property>
                 <property name="digits">0</property>
@@ -122,7 +122,7 @@
             <child>
               <object class="GtkScale" id="animate_appicon_hover_options_travel_scale">
                 <property name="valign">center</property>
-                <property name="hexpand">True</property>
+                <property name="width-request">300</property>
                 <property name="adjustment">animate_appicon_hover_options_travel_adjustment</property>
                 <property name="round_digits">0</property>
                 <property name="digits">0</property>
@@ -139,7 +139,7 @@
             <child>
               <object class="GtkScale" id="animate_appicon_hover_options_zoom_scale">
                 <property name="valign">center</property>
-                <property name="hexpand">True</property>
+                <property name="width-request">300</property>
                 <property name="adjustment">animate_appicon_hover_options_zoom_adjustment</property>
                 <property name="round_digits">0</property>
                 <property name="digits">0</property>
@@ -156,7 +156,7 @@
             <child>
               <object class="GtkScale" id="animate_appicon_hover_options_convexity_scale">
                 <property name="valign">end</property>
-                <property name="hexpand">True</property>
+                <property name="width-request">300</property>
                 <property name="adjustment">animate_appicon_hover_options_convexity_adjustment</property>
                 <property name="round_digits">1</property>
                 <property name="digits">1</property>
@@ -173,7 +173,7 @@
             <child>
               <object class="GtkScale" id="animate_appicon_hover_options_extent_scale">
                 <property name="valign">center</property>
-                <property name="hexpand">True</property>
+                <property name="width-request">300</property>
                 <property name="adjustment">animate_appicon_hover_options_extent_adjustment</property>
                 <property name="round_digits">0</property>
                 <property name="digits">0</property>
diff --git a/ui/BoxDotOptions.ui b/ui/BoxDotOptions.ui
index fb95737d..88c7cff1 100644
--- a/ui/BoxDotOptions.ui
+++ b/ui/BoxDotOptions.ui
@@ -19,8 +19,8 @@
     <property name="width-request">600</property>
     <property name="height-request">600</property>
     <property name="vexpand">True</property>
-    <child>
 
+    <child>
       <object class="GtkBox">
         <property name="orientation">vertical</property>
         <property name="spacing">12</property>
@@ -283,8 +283,8 @@
         </child>
 
       </object>
-
     </child>
+    
   </object>
 
 </interface>
\ No newline at end of file
diff --git a/ui/SettingsFineTune.ui b/ui/SettingsFineTune.ui
index 34eb1a52..2528f606 100644
--- a/ui/SettingsFineTune.ui
+++ b/ui/SettingsFineTune.ui
@@ -52,8 +52,7 @@
               <property name="subtitle" translatable="yes">(0 = theme default)</property>
               <child>
                 <object class="GtkScale" id="tray_size_scale">
-                  <property name="valign">baseline</property>
-                  <property name="hexpand">True</property>
+                  <property name="width-request">300</property>
                   <property name="adjustment">tray_size_adjustment</property>
                   <property name="round_digits">0</property>
                   <property name="digits">0</property>
@@ -71,8 +70,7 @@
               <property name="subtitle" translatable="yes">(0 = theme default)</property>
               <child>
                 <object class="GtkScale" id="leftbox_size_scale">
-                  <property name="valign">baseline</property>
-                  <property name="hexpand">True</property>
+                  <property name="width-request">300</property>
                   <property name="adjustment">leftbox_size_adjustment</property>
                   <property name="round_digits">0</property>
                   <property name="digits">0</property>
@@ -98,8 +96,7 @@
               <property name="subtitle" translatable="yes">(-1 = theme default)</property>
               <child>
                 <object class="GtkScale" id="tray_padding_scale">
-                  <property name="valign">baseline</property>
-                  <property name="hexpand">True</property>
+                  <property name="width-request">300</property>
                   <property name="adjustment">tray_padding_adjustment</property>
                   <property name="round_digits">0</property>
                   <property name="digits">0</property>
@@ -117,8 +114,7 @@
               <property name="subtitle" translatable="yes">(-1 = theme default)</property>
               <child>
                 <object class="GtkScale" id="statusicon_padding_scale">
-                  <property name="valign">baseline</property>
-                  <property name="hexpand">True</property>
+                  <property name="width-request">300</property>
                   <property name="adjustment">statusicon_padding_adjustment</property>
                   <property name="round_digits">0</property>
                   <property name="digits">0</property>
@@ -136,8 +132,7 @@
               <property name="subtitle" translatable="yes">(-1 = theme default)</property>
               <child>
                 <object class="GtkScale" id="leftbox_padding_scale">
-                  <property name="valign">baseline</property>
-                  <property name="hexpand">True</property>
+                  <property name="width-request">300</property>
                   <property name="adjustment">leftbox_padding_adjustment</property>
                   <property name="round_digits">0</property>
                   <property name="digits">0</property>
diff --git a/ui/SettingsPosition.ui b/ui/SettingsPosition.ui
index d31f9727..14de8147 100644
--- a/ui/SettingsPosition.ui
+++ b/ui/SettingsPosition.ui
@@ -173,7 +173,7 @@
               <property name="subtitle" translatable="yes">(default is 48)</property>
               <child>
                 <object class="GtkScale" id="panel_size_scale">
-                  <property name="hexpand">True</property>
+                  <property name="width-request">300</property>
                   <property name="adjustment">panel_size_adjustment</property>
                   <property name="round_digits">0</property>
                   <property name="digits">0</property>
@@ -191,7 +191,7 @@
               <property name="subtitle" translatable="yes">(default is 100)</property>
               <child>
                 <object class="GtkScale" id="panel_length_scale">
-                  <property name="hexpand">True</property>
+                  <property name="width-request">300</property>
                   <property name="adjustment">panel_length_adjustment</property>
                   <property name="round_digits">0</property>
                   <property name="digits">0</property>
diff --git a/ui/SettingsStyle.ui b/ui/SettingsStyle.ui
index cdf525b4..a52f762e 100644
--- a/ui/SettingsStyle.ui
+++ b/ui/SettingsStyle.ui
@@ -49,8 +49,7 @@
             <property name="subtitle" translatable="yes">(default is 8)</property>
             <child>
               <object class="GtkScale" id="appicon_margin_scale">
-                <property name="valign">baseline</property>
-                <property name="hexpand">True</property>
+                <property name="width-request">300</property>
                 <property name="adjustment">appicon_margin_adjustment</property>
                 <property name="round_digits">0</property>
                 <property name="digits">0</property>
@@ -68,8 +67,7 @@
             <property name="subtitle" translatable="yes">(default is 4)</property>
             <child>
               <object class="GtkScale" id="appicon_padding_scale">
-                <property name="valign">baseline</property>
-                <property name="hexpand">True</property>
+                <property name="width-request">300</property>
                 <property name="adjustment">appicon_padding_adjustment</property>
                 <property name="round_digits">0</property>
                 <property name="digits">0</property>

From 62377ce8e410de977b209e61715da755f7158f6f Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 14:24:40 +0200
Subject: [PATCH 35/62] migrate box dynamic opacitry options to adw preferences
 group

---
 ui/BoxDynamicOpacityOptions.ui | 209 ++++++++-------------------------
 1 file changed, 50 insertions(+), 159 deletions(-)

diff --git a/ui/BoxDynamicOpacityOptions.ui b/ui/BoxDynamicOpacityOptions.ui
index bc2e935d..50f891b6 100644
--- a/ui/BoxDynamicOpacityOptions.ui
+++ b/ui/BoxDynamicOpacityOptions.ui
@@ -21,191 +21,82 @@
   </object>
 
   <object class="GtkBox" id="box_dynamic_opacity_options">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
     <property name="orientation">vertical</property>
-    <property name="hexpand">1</property>
-    <property name="vexpand">1</property>
+    <property name="width-request">600</property>
+    <property name="spacing">12</property>
+
     <child>
-      <object class="GtkListBox" id="trans_options_listbox">
-        <property name="visible">True</property>
-        <property name="can_focus">False</property>
-        <property name="selection_mode">none</property>
+      <object class="AdwPreferencesGroup">
+        <property name="margin-top">12</property>
+        <property name="margin-bottom">12</property>
+        <property name="margin-start">12</property>
+        <property name="margin-end">12</property>
+
         <child>
-          <object class="GtkListBoxRow" id="listboxrow_trans_options_window_type">
-            <property name="visible">True</property>
-            <property name="can_focus">True</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">The panel background opacity is affected by</property>
             <child>
-              <object class="GtkGrid" id="trans_options_window_type_box">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="margin_start">12</property>
-                <property name="margin_end">12</property>
-                <property name="margin_top">12</property>
-                <property name="margin_bottom">12</property>
-                <property name="row_spacing">4</property>
-                <child>
-                  <object class="GtkLabel" id="trans_options_window_type_label">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="label" translatable="yes">The panel background opacity is affected by</property>
-                    <property name="xalign">0</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">0</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkComboBoxText" id="trans_options_window_type_combo">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="valign">center</property>
-                    <items>
-                      <item id="ALL_WINDOWS" translatable="yes">All windows</item>
-                      <item id="FOCUSED_WINDOWS" translatable="yes">Focused windows</item>
-                      <item id="MAXIMIZED_WINDOWS" translatable="yes">Maximized windows</item>
-                    </items>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">1</property>
-                    </layout>
-                  </object>
-                </child>
+              <object class="GtkComboBoxText" id="trans_options_window_type_combo">
+                <property name="valign">center</property>
+                <items>
+                  <item id="ALL_WINDOWS" translatable="yes">All windows</item>
+                  <item id="FOCUSED_WINDOWS" translatable="yes">Focused windows</item>
+                  <item id="MAXIMIZED_WINDOWS" translatable="yes">Maximized windows</item>
+                </items>
               </object>
             </child>
           </object>
         </child>
+
         <child>
-          <object class="GtkListBoxRow" id="listboxrow_trans_options_distance">
-            <property name="visible">True</property>
-            <property name="can_focus">True</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Change opacity when a window gets closer than (px)</property>
             <child>
-              <object class="GtkGrid" id="grid_trans_options_distance">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="margin_start">12</property>
-                <property name="margin_end">12</property>
-                <property name="margin_top">12</property>
-                <property name="margin_bottom">12</property>
-                <property name="column_spacing">32</property>
-                <child>
-                  <object class="GtkSpinButton" id="trans_options_distance_spinbutton">
-                    <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="halign">end</property>
-                    <property name="width_chars">4</property>
-                    <property name="text">50</property>
-                    <property name="adjustment">trans_distance_adjustment</property>
-                    <property name="numeric">True</property>
-                    <property name="value">50</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">1</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkLabel" id="trans_options_distance_label">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="label" translatable="yes">Change opacity when a window gets closer than (px)</property>
-                    <property name="use_markup">True</property>
-                    <property name="xalign">0</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">0</property>
-                    </layout>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="trans_options_distance_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">50</property>
+                <property name="adjustment">trans_distance_adjustment</property>
+                <property name="numeric">True</property>
+                <property name="value">50</property>
+                <layout>
+                  <property name="row">0</property>
+                  <property name="column">1</property>
+                </layout>
               </object>
             </child>
           </object>
         </child>
+
         <child>
-          <object class="GtkListBoxRow" id="listboxrow_trans_options_min_opacity">
-            <property name="visible">True</property>
-            <property name="can_focus">True</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Change opacity to (%)</property>
             <child>
-              <object class="GtkBox" id="trans_options_min_opacity_box">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="margin_start">12</property>
-                <property name="margin_end">12</property>
-                <property name="margin_top">12</property>
-                <property name="margin_bottom">12</property>
-                <child>
-                  <object class="GtkLabel" id="trans_options_min_opacity_label">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_end">12</property>
-                    <property name="label" translatable="yes">Change opacity to (%)</property>
-                    <property name="use_markup">True</property>
-                    <property name="xalign">0</property>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkSpinButton" id="trans_options_min_opacity_spinbutton">
-                    <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="halign">end</property>
-                    <property name="text" translatable="yes">0</property>
-                    <property name="adjustment">trans_opacity_min_adjustment</property>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="trans_options_min_opacity_spinbutton">
+                <property name="text" translatable="yes">0</property>
+                <property name="valign">center</property>
+                <property name="adjustment">trans_opacity_min_adjustment</property>
               </object>
             </child>
           </object>
         </child>
+
         <child>
-          <object class="GtkListBoxRow" id="listboxrow_trans_options_anim_time">
-            <property name="visible">True</property>
-            <property name="can_focus">True</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Opacity change animation duration (ms)</property>
             <child>
-              <object class="GtkGrid" id="grid_trans_options_anim_time">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="margin_start">12</property>
-                <property name="margin_end">12</property>
-                <property name="margin_top">12</property>
-                <property name="margin_bottom">12</property>
-                <property name="column_spacing">32</property>
-                <child>
-                  <object class="GtkSpinButton" id="trans_options_anim_time_spinbutton">
-                    <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="halign">end</property>
-                    <property name="width_chars">4</property>
-                    <property name="text">50</property>
-                    <property name="adjustment">trans_anim_time_adjustment</property>
-                    <property name="numeric">True</property>
-                    <property name="value">50</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">1</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkLabel" id="trans_options_anim_time_label">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="label" translatable="yes">Opacity change animation duration (ms)</property>
-                    <property name="use_markup">True</property>
-                    <property name="xalign">0</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">0</property>
-                    </layout>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="trans_options_anim_time_spinbutton">
+                <property name="width_chars">4</property>
+                <property name="text">50</property>
+                <property name="valign">center</property>
+                <property name="adjustment">trans_anim_time_adjustment</property>
+                <property name="numeric">True</property>
+                <property name="value">50</property>
               </object>
             </child>
           </object>
         </child>
+
       </object>
     </child>
   </object>

From bd11400c0f4c007ef5bf8651eb5adec999ab203d Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 14:57:03 +0200
Subject: [PATCH 36/62] harmonise box options margins and padding

---
 ui/BoxAdvancedOptions.ui            | 10 +++++-----
 ui/BoxAnimateAppIconHoverOptions.ui | 12 +++++-------
 ui/BoxDotOptions.ui                 | 28 +++++-----------------------
 ui/BoxDynamicOpacityOptions.ui      | 10 +++++-----
 ui/BoxShowDesktopOptions.ui         | 12 +++++-------
 5 files changed, 25 insertions(+), 47 deletions(-)

diff --git a/ui/BoxAdvancedOptions.ui b/ui/BoxAdvancedOptions.ui
index d80a52e8..3007d952 100644
--- a/ui/BoxAdvancedOptions.ui
+++ b/ui/BoxAdvancedOptions.ui
@@ -5,14 +5,14 @@
   <object class="GtkBox" id="box_advanced_options">
     <property name="orientation">vertical</property>
     <property name="width-request">600</property>
-    <property name="spacing">12</property>
+    <property name="spacing">24</property>
+    <property name="margin-top">32</property>
+    <property name="margin-bottom">32</property>
+    <property name="margin-start">32</property>
+    <property name="margin-end">32</property>
 
     <child>
       <object class="AdwPreferencesGroup">
-        <property name="margin-top">12</property>
-        <property name="margin-bottom">12</property>
-        <property name="margin-start">12</property>
-        <property name="margin-end">12</property>
 
         <child>
           <object class="AdwActionRow">
diff --git a/ui/BoxAnimateAppIconHoverOptions.ui b/ui/BoxAnimateAppIconHoverOptions.ui
index 26ed9842..f59934ce 100644
--- a/ui/BoxAnimateAppIconHoverOptions.ui
+++ b/ui/BoxAnimateAppIconHoverOptions.ui
@@ -48,13 +48,14 @@
   <object class="GtkBox" id="animate_appicon_hover_options">
     <property name="orientation">vertical</property>
     <property name="width-request">600</property>
-    <property name="spacing">12</property>
+    <property name="spacing">24</property>
+    <property name="margin-top">32</property>
+    <property name="margin-bottom">32</property>
+    <property name="margin-start">32</property>
+    <property name="margin-end">32</property>
 
     <child>
       <object class="AdwPreferencesGroup">
-        <property name="margin-top">12</property>
-        <property name="margin-start">12</property>
-        <property name="margin-end">12</property>
 
         <child>
           <object class="AdwActionRow">
@@ -78,9 +79,6 @@
 
     <child>
       <object class="AdwPreferencesGroup">
-        <property name="margin-bottom">12</property>
-        <property name="margin-start">12</property>
-        <property name="margin-end">12</property>
 
         <child>
           <object class="AdwActionRow">
diff --git a/ui/BoxDotOptions.ui b/ui/BoxDotOptions.ui
index 88c7cff1..6ca19c47 100644
--- a/ui/BoxDotOptions.ui
+++ b/ui/BoxDotOptions.ui
@@ -23,13 +23,14 @@
     <child>
       <object class="GtkBox">
         <property name="orientation">vertical</property>
-        <property name="spacing">12</property>
+        <property name="spacing">24</property>
+        <property name="margin-top">32</property>
+        <property name="margin-bottom">32</property>
+        <property name="margin-start">32</property>
+        <property name="margin-end">32</property>
 
         <child>
           <object class="AdwPreferencesGroup">
-            <property name="margin-top">12</property>
-            <property name="margin-start">12</property>
-            <property name="margin-end">12</property>
 
             <child>
               <object class="AdwActionRow">
@@ -47,9 +48,6 @@
 
         <child>
           <object class="AdwPreferencesGroup" id="grid_focus_highlight_options">
-            <property name="margin-top">12</property>
-            <property name="margin-start">12</property>
-            <property name="margin-end">12</property>
 
             <child>
               <object class="AdwActionRow">
@@ -92,9 +90,6 @@
 
         <child>
           <object class="AdwPreferencesGroup">
-            <property name="margin-top">12</property>
-            <property name="margin-start">12</property>
-            <property name="margin-end">12</property>
 
             <child>
               <object class="AdwActionRow">
@@ -125,9 +120,6 @@
 
         <child>
           <object class="AdwPreferencesGroup">
-            <property name="margin-top">12</property>
-            <property name="margin-start">12</property>
-            <property name="margin-end">12</property>
 
             <child>
               <object class="AdwActionRow">
@@ -144,9 +136,6 @@
 
         <child>
           <object class="AdwPreferencesGroup" id="grid_dot_color">
-            <property name="margin-top">12</property>
-            <property name="margin-start">12</property>
-            <property name="margin-end">12</property>
 
             <child>
               <object class="AdwActionRow">
@@ -203,9 +192,6 @@
 
         <child>
           <object class="AdwPreferencesGroup" id="dot_color_unfocused_box">
-            <property name="margin-top">12</property>
-            <property name="margin-start">12</property>
-            <property name="margin-end">12</property>
 
             <child>
               <object class="AdwActionRow">
@@ -224,10 +210,6 @@
         <!-- TODO sensitivity of this group has to be connected to dot_color_override_switch -->
         <child>
           <object class="AdwPreferencesGroup" id="grid_dot_color_unfocused">
-            <property name="margin-top">12</property>
-            <property name="margin-bottom">12</property>
-            <property name="margin-start">12</property>
-            <property name="margin-end">12</property>
 
             <child>
               <object class="AdwActionRow">
diff --git a/ui/BoxDynamicOpacityOptions.ui b/ui/BoxDynamicOpacityOptions.ui
index 50f891b6..e524aeb2 100644
--- a/ui/BoxDynamicOpacityOptions.ui
+++ b/ui/BoxDynamicOpacityOptions.ui
@@ -23,14 +23,14 @@
   <object class="GtkBox" id="box_dynamic_opacity_options">
     <property name="orientation">vertical</property>
     <property name="width-request">600</property>
-    <property name="spacing">12</property>
+    <property name="spacing">24</property>
+    <property name="margin-top">32</property>
+    <property name="margin-bottom">32</property>
+    <property name="margin-start">32</property>
+    <property name="margin-end">32</property>
 
     <child>
       <object class="AdwPreferencesGroup">
-        <property name="margin-top">12</property>
-        <property name="margin-bottom">12</property>
-        <property name="margin-start">12</property>
-        <property name="margin-end">12</property>
 
         <child>
           <object class="AdwActionRow">
diff --git a/ui/BoxShowDesktopOptions.ui b/ui/BoxShowDesktopOptions.ui
index 8319b7ee..e5982182 100644
--- a/ui/BoxShowDesktopOptions.ui
+++ b/ui/BoxShowDesktopOptions.ui
@@ -24,13 +24,14 @@
   <object class="GtkBox" id="box_show_showdesktop_options">
     <property name="orientation">vertical</property>
     <property name="width-request">600</property>
-    <property name="spacing">8</property>
+    <property name="spacing">24</property>
+    <property name="margin-top">32</property>
+    <property name="margin-bottom">32</property>
+    <property name="margin-start">32</property>
+    <property name="margin-end">32</property>
 
     <child>
       <object class="AdwPreferencesGroup">
-        <property name="margin-top">8</property>
-        <property name="margin-start">8</property>
-        <property name="margin-end">8</property>
 
         <child>
           <object class="AdwActionRow" id="show_showdesktop_width_label">
@@ -70,9 +71,6 @@
 
     <child>
       <object class="AdwPreferencesGroup">
-        <property name="margin-start">8</property>
-        <property name="margin-end">8</property>
-        <property name="margin-bottom">8</property>
 
         <child>
           <object class="AdwActionRow">

From 182b21cf4f2cef321862a879768ba77ad4934b2c Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 15:14:55 +0200
Subject: [PATCH 37/62] migrate box group apps options to adw preferences group

---
 ui/BoxGroupAppsOptions.ui | 459 +++++++++-----------------------------
 1 file changed, 101 insertions(+), 358 deletions(-)

diff --git a/ui/BoxGroupAppsOptions.ui b/ui/BoxGroupAppsOptions.ui
index 07cff47f..ffc4d903 100644
--- a/ui/BoxGroupAppsOptions.ui
+++ b/ui/BoxGroupAppsOptions.ui
@@ -16,393 +16,136 @@
   </object>
 
   <object class="GtkBox" id="box_group_apps_options">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
     <property name="orientation">vertical</property>
-    <property name="hexpand">1</property>
-    <property name="vexpand">1</property>
+    <property name="width-request">600</property>
+    <property name="spacing">24</property>
+    <property name="margin-top">32</property>
+    <property name="margin-bottom">32</property>
+    <property name="margin-start">32</property>
+    <property name="margin-end">32</property>
+
     <child>
-      <object class="GtkFrame" id="frame_group_apps_options">
-        <property name="visible">True</property>
-        <property name="can_focus">False</property>
-        <property name="label_xalign">0</property>
+      <object class="AdwPreferencesGroup">
+
         <child>
-          <object class="GtkListBox" id="listbox_group_apps_options">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="selection_mode">none</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Font size (px) of the application titles (default is 14)</property>
             <child>
-              <object class="GtkListBoxRow" id="listbox_group_apps_label_font_size">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_group_apps_label_font_size">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkSpinButton" id="group_apps_label_font_size_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="width_chars">4</property>
-                        <property name="text">0</property>
-                        <property name="adjustment">group_apps_label_font_size_adjustment</property>
-                        <property name="numeric">True</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="group_apps_label_font_size_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Font size (px) of the application titles (default is 14)</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="group_apps_label_font_size_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">0</property>
+                <property name="adjustment">group_apps_label_font_size_adjustment</property>
+                <property name="numeric">True</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Font weight of application titles</property>
             <child>
-              <object class="GtkListBoxRow" id="listbox_group_apps_label_font_weight">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_group_apps_label_font_weight">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="group_apps_label_font_weight_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Font weight of application titles</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkComboBoxText" id="group_apps_label_font_weight_combo">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="valign">center</property>
-                        <items>
-                          <item id="inherit" translatable="yes">inherit from theme</item>
-                          <item id="normal" translatable="yes">normal</item>
-                          <item id="lighter" translatable="yes">lighter</item>
-                          <item id="bold" translatable="yes">bold</item>
-                          <item id="bolder" translatable="yes">bolder</item>
-                        </items>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkComboBoxText" id="group_apps_label_font_weight_combo">
+                <property name="valign">center</property>
+                <items>
+                  <item id="inherit" translatable="yes">inherit from theme</item>
+                  <item id="normal" translatable="yes">normal</item>
+                  <item id="lighter" translatable="yes">lighter</item>
+                  <item id="bold" translatable="yes">bold</item>
+                  <item id="bolder" translatable="yes">bolder</item>
+                </items>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Font color of the application titles</property>
             <child>
-              <object class="GtkListBoxRow" id="listbox_group_apps_label_font_color">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_group_apps_label_font_color">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="group_apps_label_font_color_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Font color of the application titles</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkColorButton" id="group_apps_label_font_color_colorbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="receives_default">True</property>
-                        <property name="halign">end</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkColorButton" id="group_apps_label_font_color_colorbutton">
+                <property name="receives_default">True</property>
+                <property name="valign">center</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Font color of the minimized application titles</property>
             <child>
-              <object class="GtkListBoxRow" id="listbox_group_apps_label_font_color_minimized">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_group_apps_label_font_color_minimized">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="group_apps_label_font_color_minimized_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Font color of the minimized application titles</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkColorButton" id="group_apps_label_font_color_minimized_colorbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="receives_default">True</property>
-                        <property name="halign">end</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkColorButton" id="group_apps_label_font_color_minimized_colorbutton">
+                <property name="receives_default">True</property>
+                <property name="valign">center</property>
               </object>
             </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <child>
+      <object class="AdwPreferencesGroup">
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Maximum width (px) of the application titles</property>
+            <property name="subtitle" translatable="yes">(default is 160)</property>
             <child>
-              <object class="GtkListBoxRow" id="listbox_group_apps_label_max_width">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_group_apps_label_max_width">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="group_apps_label_max_width_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Maximum width (px) of the application titles (default is 160)</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSpinButton" id="group_apps_label_max_width_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="width_chars">4</property>
-                        <property name="text">0</property>
-                        <property name="adjustment">group_apps_label_max_width_adjustment</property>
-                        <property name="numeric">True</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="group_apps_label_max_width_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">0</property>
+                <property name="adjustment">group_apps_label_max_width_adjustment</property>
+                <property name="numeric">True</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Use a fixed width for the application titles</property>
+            <property name="subtitle" translatable="yes">The application titles all have the same width, even if their texts are shorter than the maximum width. The maximum width value is used as the fixed width.</property>
             <child>
-              <object class="GtkListBoxRow" id="listbox_group_apps_use_fixed_width">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_group_apps_use_fixed_width">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="group_apps_use_fixed_width_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Use a fixed width for the application titles</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="group_apps_use_fixed_width_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="group_apps_use_fixed_width_description">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">The application titles all have the same width, even if their texts are shorter than the maximum width. The maximum width value is used as the fixed width.</property>
-                        <property name="wrap">True</property>
-                        <property name="max_width_chars">40</property>
-                        <property name="xalign">0</property>
-                        <style>
-                          <class name="dim-label"/>
-                        </style>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSwitch" id="group_apps_use_fixed_width_switch">
+                <property name="valign">center</property>
               </object>
             </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <child>
+      <object class="AdwPreferencesGroup">
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Display running indicators on unfocused applications</property>
             <child>
-              <object class="GtkListBoxRow" id="listbox_group_apps_underline_unfocused">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_group_apps_underline_unfocused">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="group_apps_underline_unfocused_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Display running indicators on unfocused applications</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="group_apps_underline_unfocused_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSwitch" id="group_apps_underline_unfocused_switch">
+                <property name="valign">center</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Use the favorite icons as application launchers</property>
             <child>
-              <object class="GtkListBoxRow" id="listbox_group_apps_use_launchers">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_group_apps_use_launchers">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="group_apps_use_launchers_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Use the favorite icons as application launchers</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="group_apps_use_launchers_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSwitch" id="group_apps_use_launchers_switch">
+                <property name="valign">center</property>
               </object>
             </child>
           </object>
         </child>
+
       </object>
     </child>
   </object>

From a75fc69f2c2e15f6af93033d9c0f8e43a9893804 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 15:45:47 +0200
Subject: [PATCH 38/62] migrate box intellihide options to adw preferences
 group

---
 prefs.js                    |   7 +
 ui/BoxIntellihideOptions.ui | 632 +++++++++---------------------------
 2 files changed, 160 insertions(+), 479 deletions(-)

diff --git a/prefs.js b/prefs.js
index 1a400351..82522e55 100644
--- a/prefs.js
+++ b/prefs.js
@@ -1203,6 +1203,13 @@ const Preferences = class {
                             'sensitive',
                             Gio.SettingsBindFlags.DEFAULT);
 
+        if (this._window) {
+            this._settings.bind('intellihide-use-pressure',
+                            this._builder.get_object('intellihide_use_pressure_options2'),
+                            'sensitive',
+                            Gio.SettingsBindFlags.DEFAULT);
+        }
+
         this._settings.bind('intellihide-show-in-fullscreen',
                             this._builder.get_object('intellihide_show_in_fullscreen_switch'),
                             'active',
diff --git a/ui/BoxIntellihideOptions.ui b/ui/BoxIntellihideOptions.ui
index 92125bdb..a60dab34 100644
--- a/ui/BoxIntellihideOptions.ui
+++ b/ui/BoxIntellihideOptions.ui
@@ -37,516 +37,190 @@
   </object>
 
   <object class="GtkBox" id="box_intellihide_options">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
     <property name="orientation">vertical</property>
-    <property name="hexpand">1</property>
-    <property name="vexpand">1</property>
+    <property name="width-request">600</property>
+    <property name="spacing">24</property>
+    <property name="margin-top">32</property>
+    <property name="margin-bottom">32</property>
+    <property name="margin-start">32</property>
+    <property name="margin-end">32</property>
+
+    <child>
+      <object class="AdwPreferencesGroup">
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Only hide the panel when it is obstructed by windows</property>
+            <child>
+              <object class="GtkSwitch" id="intellihide_window_hide_switch">
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow" id="intellihide_behaviour_options">
+            <property name="title" translatable="yes">The panel hides from</property>
+            <child>
+              <object class="GtkComboBoxText" id="intellihide_behaviour_combo">
+                <property name="valign">center</property>
+                <items>
+                  <item id="ALL_WINDOWS" translatable="yes">All windows</item>
+                  <item id="FOCUSED_WINDOWS" translatable="yes">Focused windows</item>
+                  <item id="MAXIMIZED_WINDOWS" translatable="yes">Maximized windows</item>
+                </items>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
     <child>
-      <object class="GtkFrame" id="frame_intellihide_options">
-        <property name="visible">True</property>
-        <property name="can_focus">False</property>
-        <property name="label_xalign">0</property>
+      <object class="AdwPreferencesGroup">
+
         <child>
-          <object class="GtkListBox" id="listbox_intellihide_options">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="selection_mode">none</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Require pressure at the edge of the screen to reveal the panel</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_intellihide_mode">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_intellihide_behaviour">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="row_spacing">12</property>
-                    <property name="column_spacing">32</property>
-                    <property name="row_homogeneous">True</property>
-                    <child>
-                      <object class="GtkLabel" id="intellihide_window_hide_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Only hide the panel when it is obstructed by windows </property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="intellihide_window_hide_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkGrid" id="intellihide_behaviour_options">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="margin_start">12</property>
-                        <property name="row_spacing">4</property>
-                        <child>
-                          <object class="GtkLabel" id="intellihide_behaviour_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">The panel hides from</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkComboBoxText" id="intellihide_behaviour_combo">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="valign">center</property>
-                            <items>
-                              <item id="ALL_WINDOWS" translatable="yes">All windows</item>
-                              <item id="FOCUSED_WINDOWS" translatable="yes">Focused windows</item>
-                              <item id="MAXIMIZED_WINDOWS" translatable="yes">Maximized windows</item>
-                            </items>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSwitch" id="intellihide_use_pressure_switch">
+                <property name="valign">center</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow" id="intellihide_use_pressure_options">
+            <property name="title" translatable="yes">Required pressure threshold (px)</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_intellihide_pressure">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_intellihide_pressure">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="row_spacing">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="intellihide_use_pressure_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Require pressure at the edge of the screen to reveal the panel</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="intellihide_use_pressure_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkGrid" id="intellihide_use_pressure_options">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="margin_start">12</property>
-                        <property name="row_spacing">4</property>
-                        <child>
-                          <object class="GtkLabel" id="intellihide_pressure_threshold_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Required pressure threshold (px)</property>
-                            <property name="use_markup">True</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkSpinButton" id="intellihide_pressure_threshold_spinbutton">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="halign">end</property>
-                            <property name="width_chars">4</property>
-                            <property name="text">0</property>
-                            <property name="adjustment">intellihide_pressure_threshold_adjustment</property>
-                            <property name="numeric">True</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkLabel" id="intellihide_pressure_time_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Required pressure timeout (ms)</property>
-                            <property name="use_markup">True</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">1</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkSpinButton" id="intellihide_pressure_time_spinbutton">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="halign">end</property>
-                            <property name="width_chars">4</property>
-                            <property name="text">0</property>
-                            <property name="adjustment">intellihide_pressure_time_adjustment</property>
-                            <property name="numeric">True</property>
-                            <layout>
-                              <property name="row">1</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="intellihide_pressure_threshold_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">0</property>
+                <property name="adjustment">intellihide_pressure_threshold_adjustment</property>
+                <property name="numeric">True</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow" id="intellihide_use_pressure_options2">
+            <property name="title" translatable="yes">Required pressure timeout (ms)</property>
+            <child>
+              <object class="GtkSpinButton" id="intellihide_pressure_time_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">0</property>
+                <property name="adjustment">intellihide_pressure_time_adjustment</property>
+                <property name="numeric">True</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <child>
+      <object class="AdwPreferencesGroup">
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Allow the panel to be revealed while in fullscreen mode</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_intellihide_show_in_fullscreen">
-                <property name="width_request">100</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_intellihide_show_in_fullscreen">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="row_spacing">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="intellihide_show_in_fullscreen_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Allow the panel to be revealed while in fullscreen mode</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="intellihide_show_in_fullscreen_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSwitch" id="intellihide_show_in_fullscreen_switch">
+                <property name="valign">center</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow" id="grid_intellihide_only_secondary">
+            <property name="title" translatable="yes">Only hide secondary panels</property>
+            <property name="subtitle" translatable="yes">(requires multi-monitors option)</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_intellihide_only_secondary">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_intellihide_only_secondary">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="row_spacing">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="intellihide_only_secondary_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Only hide secondary panels (requires multi-monitors option)</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="intellihide_only_secondary_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSwitch" id="intellihide_only_secondary_switch">
+                <property name="valign">center</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Keyboard shortcut to reveal and hold the panel</property>
+            <property name="subtitle" translatable="yes">Syntax: &lt;Shift&gt;, &lt;Ctrl&gt;, &lt;Alt&gt;, &lt;Super&gt;</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_intellihide_toggle">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_intellihide_toggle">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkEntry" id="intellihide_toggle_entry">
-                        <property name="can_focus">True</property>
-                        <property name="valign">center</property>
-                        <property name="width_chars">12</property>
-                        <property name="placeholder_text" translatable="yes">e.g. &lt;Super&gt;i</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                          <property name="row-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="intellihide_toggle_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Keyboard shortcut to reveal and hold the panel</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="intellihide_toggle_description">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="label" translatable="yes">Syntax: &lt;Shift&gt;, &lt;Ctrl&gt;, &lt;Alt&gt;, &lt;Super&gt;</property>
-                        <property name="wrap">True</property>
-                        <property name="max_width_chars">40</property>
-                        <property name="xalign">0</property>
-                        <style>
-                          <class name="dim-label"/>
-                        </style>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkEntry" id="intellihide_toggle_entry">
+                <property name="valign">center</property>
+                <property name="width_chars">12</property>
+                <property name="placeholder_text" translatable="yes">e.g. &lt;Super&gt;i</property>
               </object>
             </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <child>
+      <object class="AdwPreferencesGroup">
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Hide and reveal animation duration (ms)</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_intellihide_animation_time">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_intellihide_animation_time">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="intellihide_animation_time_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Hide and reveal animation duration (ms)</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSpinButton" id="intellihide_animation_time_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="width_chars">4</property>
-                        <property name="text">0</property>
-                        <property name="adjustment">intellihide_animation_time_adjustment</property>
-                        <property name="numeric">True</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="intellihide_animation_time_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">0</property>
+                <property name="adjustment">intellihide_animation_time_adjustment</property>
+                <property name="numeric">True</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Delay before hiding the panel (ms)</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_intellihide_close_delay">
-                <property name="width_request">100</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_intellihide_close_delay">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="intellihide_close_delay_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Delay before hiding the panel (ms)</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSpinButton" id="intellihide_close_delay_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="width_chars">4</property>
-                        <property name="text">10</property>
-                        <property name="adjustment">intellihide_close_delay_adjustment</property>
-                        <property name="numeric">True</property>
-                        <property name="value">10</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="intellihide_close_delay_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">10</property>
+                <property name="adjustment">intellihide_close_delay_adjustment</property>
+                <property name="numeric">True</property>
+                <property name="value">10</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Delay before enabling intellihide on start (ms)</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_intellihide_enable_start_delay">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_intellihide_enable_start_delay">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="row_spacing">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="intellihide_enable_start_delay_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Delay before enabling intellihide on start (ms)</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSpinButton" id="intellihide_enable_start_delay_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="width_chars">4</property>
-                        <property name="text">10</property>
-                        <property name="adjustment">intellihide_enable_hide_delay_adjustment</property>
-                        <property name="numeric">True</property>
-                        <property name="value">10</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="intellihide_enable_start_delay_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">10</property>
+                <property name="adjustment">intellihide_enable_hide_delay_adjustment</property>
+                <property name="numeric">True</property>
+                <property name="value">10</property>
               </object>
             </child>
           </object>
         </child>
+
       </object>
     </child>
+
   </object>
 
 </interface>
\ No newline at end of file

From 401c93b6b1addcb05c747460c97e9ad92a766cc1 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 16:01:15 +0200
Subject: [PATCH 39/62] migrate box middle click options to adw preferences
 group

---
 ui/BoxMiddleClickOptions.ui | 295 +++++++++---------------------------
 1 file changed, 74 insertions(+), 221 deletions(-)

diff --git a/ui/BoxMiddleClickOptions.ui b/ui/BoxMiddleClickOptions.ui
index 1f0c8125..8c76a342 100644
--- a/ui/BoxMiddleClickOptions.ui
+++ b/ui/BoxMiddleClickOptions.ui
@@ -3,243 +3,96 @@
   <requires lib="gtk" version="4.0"/>
 
   <object class="GtkBox" id="box_middle_click_options">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
-    <property name="margin_start">12</property>
-    <property name="margin_end">12</property>
-    <property name="margin_top">12</property>
-    <property name="margin_bottom">12</property>
     <property name="orientation">vertical</property>
-    <property name="hexpand">1</property>
-    <property name="vexpand">1</property>
+    <property name="width-request">600</property>
+    <property name="spacing">24</property>
+    <property name="margin-top">32</property>
+    <property name="margin-bottom">32</property>
+    <property name="margin-start">32</property>
+    <property name="margin-end">32</property>
+
     <child>
-      <object class="GtkFrame" id="frame_middle_click_options">
-        <property name="visible">True</property>
-        <property name="can_focus">False</property>
-        <property name="label_xalign">0</property>
+      <object class="AdwPreferencesGroup">
+
         <child>
-          <object class="GtkListBox" id="listbox_middle_click_options">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="selection_mode">none</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Shift+Click action</property>
+            <property name="subtitle" translatable="yes">When set to minimize, double clicking minimizes all the windows of the application.</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow11">
-                <property name="width_request">100</property>
-                <property name="height_request">80</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="buitin_theme7">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="builtin_theme_description4">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">When set to minimize, double clicking minimizes all the windows of the application.</property>
-                        <property name="wrap">True</property>
-                        <property name="max_width_chars">40</property>
-                        <property name="xalign">0</property>
-                        <style>
-                          <class name="dim-label"/>
-                        </style>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="builtin_theme_label4">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Shift+Click action</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkComboBoxText" id="shift_click_action_combo">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="valign">center</property>
-                        <items>
-                          <item id="RAISE" translatable="yes">Raise windows</item>
-                          <item id="MINIMIZE" translatable="yes">Minimize window</item>
-                          <item id="LAUNCH" translatable="yes">Launch new instance</item>
-                          <item id="CYCLE" translatable="yes">Cycle through windows</item>
-                          <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
-                          <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
-                          <item id="TOGGLE-CYCLE" translatable="yes">Toggle single / Cycle multiple</item>
-                          <item id="QUIT" translatable="yes">Quit</item>
-                        </items>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                          <property name="row-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkComboBoxText" id="shift_click_action_combo">
+                <property name="valign">center</property>
+                <items>
+                  <item id="RAISE" translatable="yes">Raise windows</item>
+                  <item id="MINIMIZE" translatable="yes">Minimize window</item>
+                  <item id="LAUNCH" translatable="yes">Launch new instance</item>
+                  <item id="CYCLE" translatable="yes">Cycle through windows</item>
+                  <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
+                  <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
+                  <item id="TOGGLE-CYCLE" translatable="yes">Toggle single / Cycle multiple</item>
+                  <item id="QUIT" translatable="yes">Quit</item>
+                </items>
               </object>
             </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <child>
+      <object class="AdwPreferencesGroup">
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Middle-Click action</property>
+            <property name="subtitle" translatable="yes">Behavior for Middle-Click.</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_middle_click">
-                <property name="width_request">100</property>
-                <property name="height_request">80</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_middle_click">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="description_middle_click">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Behavior for Middle-Click.</property>
-                        <property name="wrap">True</property>
-                        <property name="max_width_chars">40</property>
-                        <property name="xalign">0</property>
-                        <style>
-                          <class name="dim-label"/>
-                        </style>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="label_middle_click">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Middle-Click action</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkComboBoxText" id="middle_click_action_combo">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="valign">center</property>
-                        <items>
-                          <item id="RAISE" translatable="yes">Raise windows</item>
-                          <item id="MINIMIZE" translatable="yes">Minimize window</item>
-                          <item id="LAUNCH" translatable="yes">Launch new instance</item>
-                          <item id="CYCLE" translatable="yes">Cycle through windows</item>
-                          <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
-                          <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
-                          <item id="QUIT" translatable="yes">Quit</item>
-                        </items>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                          <property name="row-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkComboBoxText" id="middle_click_action_combo">
+                <property name="valign">center</property>
+                <items>
+                  <item id="RAISE" translatable="yes">Raise windows</item>
+                  <item id="MINIMIZE" translatable="yes">Minimize window</item>
+                  <item id="LAUNCH" translatable="yes">Launch new instance</item>
+                  <item id="CYCLE" translatable="yes">Cycle through windows</item>
+                  <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
+                  <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
+                  <item id="QUIT" translatable="yes">Quit</item>
+                </items>
               </object>
             </child>
+          </object>
+        </child>
+
+      </object>
+    </child>
+
+    <child>
+      <object class="AdwPreferencesGroup">
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Shift+Middle-Click action</property>
+            <property name="subtitle" translatable="yes">Behavior for Shift+Middle-Click.</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_shift_middle_click">
-                <property name="width_request">100</property>
-                <property name="height_request">80</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_shift_middle_click">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="description_shift_middle_click">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Behavior for Shift+Middle-Click.</property>
-                        <property name="wrap">True</property>
-                        <property name="max_width_chars">40</property>
-                        <property name="xalign">0</property>
-                        <style>
-                          <class name="dim-label"/>
-                        </style>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="label_shift_middle_click">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Shift+Middle-Click action</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkComboBoxText" id="shift_middle_click_action_combo">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="valign">center</property>
-                        <items>
-                          <item id="RAISE" translatable="yes">Raise windows</item>
-                          <item id="MINIMIZE" translatable="yes">Minimize window</item>
-                          <item id="LAUNCH" translatable="yes">Launch new instance</item>
-                          <item id="CYCLE" translatable="yes">Cycle through windows</item>
-                          <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
-                          <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
-                          <item id="QUIT" translatable="yes">Quit</item>
-                        </items>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                          <property name="row-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkComboBoxText" id="shift_middle_click_action_combo">
+                <property name="valign">center</property>
+                <items>
+                  <item id="RAISE" translatable="yes">Raise windows</item>
+                  <item id="MINIMIZE" translatable="yes">Minimize window</item>
+                  <item id="LAUNCH" translatable="yes">Launch new instance</item>
+                  <item id="CYCLE" translatable="yes">Cycle through windows</item>
+                  <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
+                  <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
+                  <item id="QUIT" translatable="yes">Quit</item>
+                </items>
               </object>
             </child>
           </object>
         </child>
+
       </object>
     </child>
+
   </object>
 
 </interface>
\ No newline at end of file

From c847867dd5557ab17e82fa0600b8eabd1c0db124 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 16:12:13 +0200
Subject: [PATCH 40/62] migrate box overlay shortcut to adw preferences group

---
 ui/BoxOverlayShortcut.ui | 440 +++++++--------------------------------
 1 file changed, 78 insertions(+), 362 deletions(-)

diff --git a/ui/BoxOverlayShortcut.ui b/ui/BoxOverlayShortcut.ui
index 85c678e1..98fcb0a5 100644
--- a/ui/BoxOverlayShortcut.ui
+++ b/ui/BoxOverlayShortcut.ui
@@ -9,389 +9,105 @@
   </object>
 
   <object class="GtkBox" id="box_overlay_shortcut">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
-    <property name="margin_start">12</property>
-    <property name="margin_end">12</property>
-    <property name="margin_top">12</property>
-    <property name="margin_bottom">12</property>
     <property name="orientation">vertical</property>
-    <property name="hexpand">1</property>
-    <property name="vexpand">1</property>
+    <property name="width-request">600</property>
+    <property name="spacing">24</property>
+    <property name="margin-top">32</property>
+    <property name="margin-bottom">32</property>
+    <property name="margin-start">32</property>
+    <property name="margin-end">32</property>
+
     <child>
-      <object class="GtkFrame" id="frame_overlay_show_dock">
-        <property name="visible">True</property>
-        <property name="can_focus">False</property>
-        <property name="label_xalign">0</property>
+      <object class="AdwPreferencesGroup">
+
         <child>
-          <object class="GtkListBox" id="listbox_overlay_shortcut">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="selection_mode">none</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Hotkeys prefix</property>
+            <property name="subtitle" translatable="yes">Hotkeys will either be Super+Number or Super+Alt+Num</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_hotkey_prefix">
-                <property name="width_request">100</property>
-                <property name="height_request">80</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_hotkey_prefix">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkComboBoxText" id="hotkey_prefix_combo">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="valign">center</property>
-                        <items>
-                          <item id="Super" translatable="yes">Super</item>
-                          <item id="SuperAlt" translatable="yes">Super + Alt</item>
-                        </items>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                          <property name="row-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="hotkey_prefix_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Hotkeys prefix</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="hotkey_prefix_description">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="label" translatable="yes">Hotkeys will either be Super+Number or Super+Alt+Num</property>
-                        <property name="wrap">True</property>
-                        <property name="max_width_chars">40</property>
-                        <property name="xalign">0</property>
-                        <style>
-                          <class name="dim-label"/>
-                        </style>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkComboBoxText" id="hotkey_prefix_combo">
+                <property name="valign">center</property>
+                <items>
+                  <item id="Super" translatable="yes">Super</item>
+                  <item id="SuperAlt" translatable="yes">Super + Alt</item>
+                </items>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Number overlay</property>
+            <property name="subtitle" translatable="yes">Temporarily show the application numbers over the icons when using the hotkeys.</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_overlay_shortcut">
-                <property name="width_request">100</property>
-                <property name="height_request">80</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_overlay">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkComboBoxText" id="overlay_combo">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="valign">center</property>
-                        <items>
-                          <item id="NEVER" translatable="yes">Never</item>
-                          <item id="TEMPORARILY" translatable="yes">Show temporarily</item>
-                          <item id="ALWAYS" translatable="yes">Always visible</item>
-                        </items>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                          <property name="row-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="overlay_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Number overlay</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="overlay_description">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="label" translatable="yes">Temporarily show the application numbers over the icons when using the hotkeys.</property>
-                        <property name="wrap">True</property>
-                        <property name="max_width_chars">40</property>
-                        <property name="xalign">0</property>
-                        <style>
-                          <class name="dim-label"/>
-                        </style>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkComboBoxText" id="overlay_combo">
+                <property name="valign">center</property>
+                <items>
+                  <item id="NEVER" translatable="yes">Never</item>
+                  <item id="TEMPORARILY" translatable="yes">Show temporarily</item>
+                  <item id="ALWAYS" translatable="yes">Always visible</item>
+                </items>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Hide timeout (ms)</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_timeout">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_timeout">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="hexpand">True</property>
-                    <property name="row_spacing">6</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkSpinButton" id="timeout_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="adjustment">shortcut_time_adjustment</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="shortcut_timeout_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Hide timeout (ms)</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="timeout_spinbutton">
+                <property name="valign">center</property>
+                <property name="adjustment">shortcut_time_adjustment</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Shortcut to show the overlay for 2 seconds</property>
+            <property name="subtitle" translatable="yes">Syntax: &lt;Shift&gt;, &lt;Ctrl&gt;, &lt;Alt&gt;, &lt;Super&gt;</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_extra_shortcut">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_shortcut">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkEntry" id="shortcut_entry">
-                        <property name="can_focus">True</property>
-                        <property name="valign">center</property>
-                        <property name="width_chars">12</property>
-                        <property name="placeholder_text" translatable="yes">e.g. &lt;Super&gt;q</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                          <property name="row-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="shortcut_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Shortcut to show the overlay for 2 seconds</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="shortcut_description">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="label" translatable="yes">Syntax: &lt;Shift&gt;, &lt;Ctrl&gt;, &lt;Alt&gt;, &lt;Super&gt;</property>
-                        <property name="wrap">True</property>
-                        <property name="max_width_chars">40</property>
-                        <property name="xalign">0</property>
-                        <style>
-                          <class name="dim-label"/>
-                        </style>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkEntry" id="shortcut_entry">
+                <property name="valign">center</property>
+                <property name="width_chars">12</property>
+                <property name="placeholder_text" translatable="yes">e.g. &lt;Super&gt;q</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Show window previews on hotkey</property>
+            <property name="subtitle" translatable="yes">Show previews when the application have multiple instances</property>
             <child>
-              <object class="GtkListBoxRow" id="listbox_shortcut_preview">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_shortcut_preview">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="shortcut_preview_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Show window previews on hotkey</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="shortcut_preview_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                          <property name="row-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="shortcut_preview_description">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Show previews when the application have multiple instances</property>
-                        <property name="wrap">True</property>
-                        <property name="max_width_chars">40</property>
-                        <property name="xalign">0</property>
-                        <style>
-                          <class name="dim-label"/>
-                        </style>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
-              </object>
-            </child>
+                <object class="GtkSwitch" id="shortcut_preview_switch">
+                  <property name="valign">center</property>
+                </object>
+              </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Hotkeys are activated with</property>
+            <property name="subtitle" translatable="yes">Select which keyboard number keys are used to activate the hotkeys</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_shortcut_num_keys">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_shortcut_num_keys">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkComboBoxText" id="shortcut_num_keys_combo">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <items>
-                          <item id="NUM_ROW" translatable="yes">Number row</item>
-                          <item id="NUM_KEYPAD" translatable="yes">Numeric keypad</item>
-                          <item id="BOTH" translatable="yes">Both</item>
-                        </items>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                          <property name="row-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="shortcut_num_keys_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Hotkeys are activated with</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="shortcut_num_keys_description">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="label" translatable="yes">Select which keyboard number keys are used to activate the hotkeys</property>
-                        <property name="wrap">True</property>
-                        <property name="max_width_chars">40</property>
-                        <property name="xalign">0</property>
-                        <style>
-                          <class name="dim-label"/>
-                        </style>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkComboBoxText" id="shortcut_num_keys_combo">
+                <property name="valign">center</property>
+                <items>
+                  <item id="NUM_ROW" translatable="yes">Number row</item>
+                  <item id="NUM_KEYPAD" translatable="yes">Numeric keypad</item>
+                  <item id="BOTH" translatable="yes">Both</item>
+                </items>
               </object>
             </child>
           </object>
         </child>
+
       </object>
     </child>
   </object>

From f32464a3d1fa2d4d3b6de09518ab9bd8e6dada6e Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 16:14:42 +0200
Subject: [PATCH 41/62] migrate box scroll icon options to adw preferences
 group

---
 ui/BoxScrollIconOptions.ui | 88 +++++++++-----------------------------
 1 file changed, 20 insertions(+), 68 deletions(-)

diff --git a/ui/BoxScrollIconOptions.ui b/ui/BoxScrollIconOptions.ui
index 27af04e4..bb457ff4 100644
--- a/ui/BoxScrollIconOptions.ui
+++ b/ui/BoxScrollIconOptions.ui
@@ -9,82 +9,34 @@
   </object>
 
   <object class="GtkBox" id="scroll_icon_options_box">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
     <property name="orientation">vertical</property>
-    <property name="hexpand">1</property>
-    <property name="vexpand">1</property>
+    <property name="width-request">600</property>
+    <property name="spacing">24</property>
+    <property name="margin-top">32</property>
+    <property name="margin-bottom">32</property>
+    <property name="margin-start">32</property>
+    <property name="margin-end">32</property>
+
     <child>
-      <object class="GtkListBox" id="scroll_icon_options_listbox">
-        <property name="visible">True</property>
-        <property name="can_focus">False</property>
-        <property name="selection_mode">none</property>
+      <object class="AdwPreferencesGroup">
+
         <child>
-          <object class="GtkListBoxRow" id="listboxrow_scroll_icon_options_delay">
-            <property name="visible">True</property>
-            <property name="can_focus">True</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Delay between mouse scroll events (ms)</property>
+            <property name="subtitle" translatable="yes">Use this value to limit the number of captured mouse scroll events.</property>
             <child>
-              <object class="GtkGrid" id="grid_scroll_icon_options_delay">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="margin_start">12</property>
-                <property name="margin_end">12</property>
-                <property name="margin_top">12</property>
-                <property name="margin_bottom">12</property>
-                <property name="column_spacing">32</property>
-                <child>
-                  <object class="GtkSpinButton" id="scroll_icon_options_delay_spinbutton">
-                    <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="halign">end</property>
-                    <property name="valign">center</property>
-                    <property name="width_chars">4</property>
-                    <property name="text">50</property>
-                    <property name="adjustment">scroll_icon_options_delay_adjustment</property>
-                    <property name="numeric">True</property>
-                    <property name="value">50</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">1</property>
-                      <property name="row-span">2</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkLabel" id="scroll_icon_options_delay_label">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="label" translatable="yes">Delay between mouse scroll events (ms)</property>
-                    <property name="use_markup">True</property>
-                    <property name="xalign">0</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">0</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkLabel" id="scroll_icon_options_delay_description">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="label" translatable="yes">Use this value to limit the number of captured mouse scroll events.</property>
-                    <property name="wrap">True</property>
-                    <property name="xalign">0</property>
-                    <style>
-                      <class name="dim-label"/>
-                    </style>
-                    <layout>
-                      <property name="row">1</property>
-                      <property name="column">0</property>
-                    </layout>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="scroll_icon_options_delay_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">50</property>
+                <property name="adjustment">scroll_icon_options_delay_adjustment</property>
+                <property name="numeric">True</property>
+                <property name="value">50</property>
               </object>
             </child>
           </object>
         </child>
+
       </object>
     </child>
   </object>

From b95ec25dd8414efbcef53a5e0f21ffecc229a2dc Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 16:17:47 +0200
Subject: [PATCH 42/62] migrate box scroll panel options  to adw preferences
 group

---
 ui/BoxScrollPanelOptions.ui | 149 +++++++-----------------------------
 1 file changed, 26 insertions(+), 123 deletions(-)

diff --git a/ui/BoxScrollPanelOptions.ui b/ui/BoxScrollPanelOptions.ui
index 95c7fd5d..2354b76d 100644
--- a/ui/BoxScrollPanelOptions.ui
+++ b/ui/BoxScrollPanelOptions.ui
@@ -9,143 +9,46 @@
   </object>
 
   <object class="GtkBox" id="scroll_panel_options_box">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
     <property name="orientation">vertical</property>
-    <property name="hexpand">1</property>
-    <property name="vexpand">1</property>
+    <property name="width-request">600</property>
+    <property name="spacing">24</property>
+    <property name="margin-top">32</property>
+    <property name="margin-bottom">32</property>
+    <property name="margin-start">32</property>
+    <property name="margin-end">32</property>
+
     <child>
-      <object class="GtkListBox" id="scroll_panel_options_listbox">
-        <property name="visible">True</property>
-        <property name="can_focus">False</property>
-        <property name="selection_mode">none</property>
+      <object class="AdwPreferencesGroup">
+
         <child>
-          <object class="GtkListBoxRow" id="listboxrow_scroll_panel_options_delay">
-            <property name="visible">True</property>
-            <property name="can_focus">True</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Delay between mouse scroll events (ms)</property>
+            <property name="subtitle" translatable="yes">Use this value to limit the number of captured mouse scroll events.</property>
             <child>
-              <object class="GtkGrid" id="grid_scroll_panel_options_delay">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="margin_start">12</property>
-                <property name="margin_end">12</property>
-                <property name="margin_top">12</property>
-                <property name="margin_bottom">12</property>
-                <property name="column_spacing">32</property>
-                <child>
-                  <object class="GtkSpinButton" id="scroll_panel_options_delay_spinbutton">
-                    <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="halign">end</property>
-                    <property name="valign">center</property>
-                    <property name="width_chars">4</property>
-                    <property name="text">50</property>
-                    <property name="adjustment">scroll_panel_options_delay_adjustment</property>
-                    <property name="numeric">True</property>
-                    <property name="value">50</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">1</property>
-                      <property name="row-span">2</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkLabel" id="scroll_panel_options_delay_label">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="label" translatable="yes">Delay between mouse scroll events (ms)</property>
-                    <property name="use_markup">True</property>
-                    <property name="xalign">0</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">0</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkLabel" id="scroll_panel_options_delay_description">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="label" translatable="yes">Use this value to limit the number of captured mouse scroll events.</property>
-                    <property name="wrap">True</property>
-                    <property name="xalign">0</property>
-                    <style>
-                      <class name="dim-label"/>
-                    </style>
-                    <layout>
-                      <property name="row">1</property>
-                      <property name="column">0</property>
-                    </layout>
-                  </object>
-                </child>
+              <object class="GtkSpinButton" id="scroll_panel_options_delay_spinbutton">
+                <property name="valign">center</property>
+                <property name="width_chars">4</property>
+                <property name="text">50</property>
+                <property name="adjustment">scroll_panel_options_delay_adjustment</property>
+                <property name="numeric">True</property>
+                <property name="value">50</property>
               </object>
             </child>
           </object>
         </child>
+
         <child>
-          <object class="GtkListBoxRow" id="listboxrow_scroll_panel_options_show_ws_popup">
-            <property name="visible">True</property>
-            <property name="can_focus">True</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Show popup when changing workspace</property>
+            <property name="subtitle" translatable="yes">This affects workspace popup when scrolling on the panel only.</property>
             <child>
-              <object class="GtkGrid" id="grid_scroll_panel_options_show_ws_popup">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="margin_start">12</property>
-                <property name="margin_end">12</property>
-                <property name="margin_top">12</property>
-                <property name="margin_bottom">12</property>
-                <property name="column_spacing">32</property>
-                <child>
-                  <object class="GtkLabel" id="scroll_panel_options_show_ws_popup_label">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="label" translatable="yes">Show popup when changing workspace</property>
-                    <property name="use_markup">True</property>
-                    <property name="xalign">0</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">0</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkLabel" id="scroll_panel_options_show_ws_popup_description">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="hexpand">True</property>
-                    <property name="label" translatable="yes">This affects workspace popup when scrolling on the panel only.</property>
-                    <property name="wrap">True</property>
-                    <property name="xalign">0</property>
-                    <style>
-                      <class name="dim-label"/>
-                    </style>
-                    <layout>
-                      <property name="row">1</property>
-                      <property name="column">0</property>
-                    </layout>
-                  </object>
-                </child>
-                <child>
-                  <object class="GtkSwitch" id="scroll_panel_options_show_ws_popup_switch">
-                    <property name="visible">True</property>
-                    <property name="can_focus">True</property>
-                    <property name="halign">end</property>
-                    <property name="valign">center</property>
-                    <layout>
-                      <property name="row">0</property>
-                      <property name="column">1</property>
-                      <property name="row-span">2</property>
-                    </layout>
-                  </object>
-                </child>
+              <object class="GtkSwitch" id="scroll_panel_options_show_ws_popup_switch">
+                <property name="valign">center</property>
               </object>
             </child>
           </object>
         </child>
+
       </object>
     </child>
   </object>

From 7616a1e9041b4c073d30a5dd94a903e4139aa436 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 16:21:39 +0200
Subject: [PATCH 43/62] migrate box secondary menu options to adw preferences
 group

---
 ui/BoxSecondaryMenuOptions.ui | 120 +++++++---------------------------
 1 file changed, 22 insertions(+), 98 deletions(-)

diff --git a/ui/BoxSecondaryMenuOptions.ui b/ui/BoxSecondaryMenuOptions.ui
index c58ba17f..483ddc82 100644
--- a/ui/BoxSecondaryMenuOptions.ui
+++ b/ui/BoxSecondaryMenuOptions.ui
@@ -3,115 +3,39 @@
   <requires lib="gtk" version="4.0"/>
 
   <object class="GtkBox" id="box_secondarymenu_options">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
     <property name="orientation">vertical</property>
-    <property name="hexpand">1</property>
-    <property name="vexpand">1</property>
+    <property name="width-request">600</property>
+    <property name="spacing">24</property>
+    <property name="margin-top">32</property>
+    <property name="margin-bottom">32</property>
+    <property name="margin-start">32</property>
+    <property name="margin-end">32</property>
+
     <child>
-      <object class="GtkFrame" id="frame_secondarymenu_options">
-        <property name="visible">True</property>
-        <property name="can_focus">False</property>
-        <property name="label_xalign">0</property>
+      <object class="AdwPreferencesGroup">
+
         <child>
-          <object class="GtkListBox" id="listbox_secondarymenu_options">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="selection_mode">none</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Integrate &lt;i&gt;AppMenu&lt;/i&gt; items</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_secondarymenu_appmenu">
-                <property name="width_request">100</property>
-                <property name="height_request">80</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_secondarymenu_appmenu">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="valign">center</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="secondarymenu_appmenu_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Integrate &lt;i&gt;AppMenu&lt;/i&gt; items</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="secondarymenu_appmenu_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSwitch" id="secondarymenu_appmenu_switch">
+                <property name="valign">center</property>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">&lt;i&gt;Show Details&lt;/i&gt; menu item</property>
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_secondarymenu_showdetails">
-                <property name="width_request">100</property>
-                <property name="height_request">80</property>
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <child>
-                  <object class="GtkGrid" id="grid_secondarymenu_showdetails">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="valign">center</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="secondarymenu_showdetails_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">&lt;i&gt;Show Details&lt;/i&gt; menu item</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="secondarymenu_showdetails_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                  </object>
-                </child>
+              <object class="GtkSwitch" id="secondarymenu_showdetails_switch">
+                <property name="valign">center</property>
               </object>
             </child>
           </object>
         </child>
+
       </object>
     </child>
   </object>

From 28b2d497325c0f2b0c64b001156ba72fe27c56a4 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 16:30:50 +0200
Subject: [PATCH 44/62] migrate box show applications options to adw
 preferences group

---
 ui/BoxShowApplicationsOptions.ui | 153 +++++++------------------------
 1 file changed, 31 insertions(+), 122 deletions(-)

diff --git a/ui/BoxShowApplicationsOptions.ui b/ui/BoxShowApplicationsOptions.ui
index dd2e605d..fa530d1b 100644
--- a/ui/BoxShowApplicationsOptions.ui
+++ b/ui/BoxShowApplicationsOptions.ui
@@ -9,168 +9,77 @@
   </object>
 
   <object class="GtkBox" id="show_applications_options">
-    <property name="visible">True</property>
-    <property name="can_focus">False</property>
     <property name="orientation">vertical</property>
-    <property name="hexpand">1</property>
-    <property name="vexpand">1</property>
+    <property name="width-request">600</property>
+    <property name="spacing">24</property>
+    <property name="margin-top">32</property>
+    <property name="margin-bottom">32</property>
+    <property name="margin-start">32</property>
+    <property name="margin-end">32</property>
+
     <child>
-      <object class="GtkListBoxRow" id="listbox_show_applications_icon_file">
-        <property name="visible">True</property>
-        <property name="can_focus">True</property>
+      <object class="AdwPreferencesGroup">
+
         <child>
-          <object class="GtkGrid" id="show_applications_icon_file_grid">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="margin_start">12</property>
-            <property name="margin_end">12</property>
-            <property name="margin_top">12</property>
-            <property name="margin_bottom">12</property>
-            <property name="row_spacing">12</property>
-            <property name="column_spacing">32</property>
-            <child>
-              <object class="GtkLabel" id="show_applications_icon_file_label">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="hexpand">True</property>
-                <property name="label" translatable="yes">Current Show Applications icon</property>
-                <property name="use_markup">True</property>
-                <property name="xalign">0</property>
-                <layout>
-                  <property name="row">0</property>
-                  <property name="column">0</property>
-                </layout>
-              </object>
-            </child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Show Applications icon</property>
             <child>
               <object class="GtkImage" id="show_applications_current_icon_image">
                 <property name="width_request">32</property>
                 <property name="height_request">32</property>
-                <property name="visible">True</property>
                 <property name="can_focus">False</property>
-                <property name="halign">end</property>
                 <property name="icon_name">gtk-missing-image</property>
                 <property name="pixel_size">32</property>
-                <layout>
-                  <property name="row">0</property>
-                  <property name="column">1</property>
-                </layout>
               </object>
             </child>
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwPreferencesRow">
             <child>
               <object class="GtkButton" id="show_applications_icon_file_filebutton">
+                <property name="margin-start">8</property>
+                <property name="margin-end">8</property>
+                <property name="margin-top">8</property>
+                <property name="margin-bottom">8</property>
                 <property name="width_request">140</property>
                 <property name="visible">True</property>
-                <layout>
-                  <property name="row">1</property>
-                  <property name="column">1</property>
-                </layout>
-              </object>
-            </child>
-            <child>
-              <object class="GtkLabel" id="show_applications_custom_icon_file_label">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="hexpand">True</property>
-                <property name="label" translatable="yes">Custom Show Applications image icon</property>
-                <property name="use_markup">True</property>
-                <property name="xalign">0</property>
-                <layout>
-                  <property name="row">1</property>
-                  <property name="column">0</property>
-                </layout>
               </object>
             </child>
           </object>
         </child>
+
       </object>
     </child>
+
     <child>
-      <object class="GtkListBoxRow" id="listboxrow_show_applications_side_padding">
-        <property name="visible">True</property>
-        <property name="can_focus">True</property>
+      <object class="AdwPreferencesGroup">
+
         <child>
-          <object class="GtkGrid" id="grid_show_applications_side_padding">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="margin_start">12</property>
-            <property name="margin_end">12</property>
-            <property name="margin_top">12</property>
-            <property name="margin_bottom">12</property>
-            <property name="hexpand">True</property>
-            <property name="row_spacing">6</property>
-            <property name="column_spacing">32</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Show Applications icon side padding (px)</property>
             <child>
               <object class="GtkSpinButton" id="show_applications_side_padding_spinbutton">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="halign">end</property>
+                <property name="valign">center</property>
                 <property name="text" translatable="yes">0</property>
                 <property name="adjustment">show_applications_side_padding_adjustment</property>
-                <layout>
-                  <property name="row">0</property>
-                  <property name="column">1</property>
-                </layout>
-              </object>
-            </child>
-            <child>
-              <object class="GtkLabel" id="show_applications_side_padding_label">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="hexpand">True</property>
-                <property name="label" translatable="yes">Show Applications icon side padding (px)</property>
-                <property name="xalign">0</property>
-                <layout>
-                  <property name="row">0</property>
-                  <property name="column">0</property>
-                </layout>
               </object>
             </child>
           </object>
         </child>
-      </object>
-    </child>
-    <child>
-      <object class="GtkListBoxRow" id="listboxrow_show_applications_esc_key">
-        <property name="visible">True</property>
-        <property name="can_focus">True</property>
+
         <child>
-          <object class="GtkGrid" id="grid_show_applications_esc_key">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="margin_start">12</property>
-            <property name="margin_end">12</property>
-            <property name="margin_top">12</property>
-            <property name="margin_bottom">12</property>
-            <property name="column_spacing">32</property>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Override escape key and return to desktop</property>
             <child>
               <object class="GtkSwitch" id="show_applications_esc_key_switch">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="halign">end</property>
                 <property name="valign">center</property>
-                <layout>
-                  <property name="row">0</property>
-                  <property name="column">1</property>
-                </layout>
-              </object>
-            </child>
-            <child>
-              <object class="GtkLabel" id="show_applications_esc_key_label">
-                <property name="visible">True</property>
-                <property name="can_focus">False</property>
-                <property name="hexpand">True</property>
-                <property name="label" translatable="yes">Override escape key and return to desktop</property>
-                <property name="use_markup">True</property>
-                <property name="xalign">0</property>
-                <layout>
-                  <property name="row">0</property>
-                  <property name="column">0</property>
-                </layout>
               </object>
             </child>
           </object>
         </child>
+
       </object>
     </child>
   </object>

From ff3235222d9258b172554399ef7804be777b63ab Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 17:22:29 +0200
Subject: [PATCH 45/62] migrate box window preview options to adw preferences
 group

---
 ui/BoxWindowPreviewOptions.ui | 1281 +++++++++------------------------
 1 file changed, 360 insertions(+), 921 deletions(-)

diff --git a/ui/BoxWindowPreviewOptions.ui b/ui/BoxWindowPreviewOptions.ui
index bb9358b2..2b9da63f 100644
--- a/ui/BoxWindowPreviewOptions.ui
+++ b/ui/BoxWindowPreviewOptions.ui
@@ -67,979 +67,418 @@
   </object>
 
   <object class="GtkScrolledWindow" id="box_window_preview_options">
-    <property name="visible">True</property>
-    <property name="can_focus">True</property>
-    <property name="min_content_width">460</property>
-    <property name="min_content_height">480</property>
+    <property name="width-request">800</property>
+    <property name="height-request">600</property>
+    <property name="vexpand">True</property>
     <child>
-      <object class="GtkViewport" id="viewport_window_preview_options">
-        <property name="visible">True</property>
-        <property name="can_focus">False</property>
-        <property name="hexpand">True</property>
-        <property name="vexpand">True</property>
-        <property name="hscroll_policy">natural</property>
-        <property name="vscroll_policy">natural</property>
+
+      <object class="GtkBox">
+        <property name="orientation">vertical</property>
+        <property name="width-request">600</property>
+        <property name="spacing">24</property>
+        <property name="margin-top">32</property>
+        <property name="margin-bottom">32</property>
+        <property name="margin-start">32</property>
+        <property name="margin-end">32</property>
+
         <child>
-          <object class="GtkListBox" id="listbox_window_preview_options">
-            <property name="visible">True</property>
-            <property name="can_focus">False</property>
-            <property name="selection_mode">none</property>
+          <object class="AdwPreferencesGroup">
+
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_times">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Time (ms) before showing</property>
+                <property name="subtitle" translatable="yes">(400 is default)</property>
                 <child>
-                  <object class="GtkGrid" id="grid_times">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="row_spacing">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkSpinButton" id="preview_timeout_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="width_chars">4</property>
-                        <property name="text">0</property>
-                        <property name="adjustment">preview_timeout_adjustment</property>
-                        <property name="numeric">True</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="preview_timeout_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Time (ms) before showing (400 is default)</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="animation_time_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Animation time (ms)</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">2</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSpinButton" id="animation_time_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="width_chars">4</property>
-                        <property name="text">0</property>
-                        <property name="adjustment">preview_animation_time_adjustment</property>
-                        <property name="numeric">True</property>
-                        <layout>
-                          <property name="row">2</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkBox" id="preview_hide_box">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="orientation">vertical</property>
-                        <child>
-                          <object class="GtkLabel" id="leave_timeout_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Time (ms) before hiding (100 is default)</property>
-                            <property name="xalign">0</property>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkCheckButton" id="preview_immediate_click_button">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="receives_default">False</property>
-                            <property name="margin_start">12</property>
-                            <property name="margin_top">4</property>
-                            <child>
-                              <object class="GtkLabel" id="preview_immediate_click_label">
-                                <property name="name">4</property>
-                                <property name="visible">True</property>
-                                <property name="can_focus">False</property>
-                                <property name="halign">start</property>
-                                <property name="margin_start">4</property>
-                                <property name="label" translatable="yes">Immediate on application icon click</property>
-                                <property name="use_markup">True</property>
-                              </object>
-                            </child>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSpinButton" id="leave_timeout_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <property name="width_chars">4</property>
-                        <property name="text">25</property>
-                        <property name="adjustment">leave_timeout_adjustment</property>
-                        <property name="numeric">True</property>
-                        <property name="value">25</property>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
+                  <object class="GtkSpinButton" id="preview_timeout_spinbutton">
+                    <property name="valign">center</property>
+                    <property name="width_chars">4</property>
+                    <property name="text">0</property>
+                    <property name="adjustment">preview_timeout_adjustment</property>
+                    <property name="numeric">True</property>
                   </object>
                 </child>
               </object>
             </child>
+
             <child>
-              <object class="GtkListBoxRow" id="listbox_preview_middle_click_close">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Time (ms) before hiding</property>
+                <property name="subtitle" translatable="yes">(100 is default)</property>
                 <child>
-                  <object class="GtkGrid" id="grid_preview_middle_click_close">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
+                  <object class="GtkCheckButton" id="preview_immediate_click_button">
+                    <property name="receives_default">False</property>
                     <child>
-                      <object class="GtkLabel" id="preview_middle_click_close_label">
-                        <property name="visible">True</property>
+                      <object class="GtkLabel" id="preview_immediate_click_label">
+                        <property name="name">4</property>
                         <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Middle click on the preview to close the window</property>
+                        <property name="label" translatable="yes">Immediate on application icon click</property>
                         <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="preview_middle_click_close_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
                       </object>
                     </child>
                   </object>
                 </child>
+                <child>
+                  <object class="GtkSpinButton" id="leave_timeout_spinbutton">
+                    <property name="valign">center</property>
+                    <property name="width_chars">4</property>
+                    <property name="text">25</property>
+                    <property name="adjustment">leave_timeout_adjustment</property>
+                    <property name="numeric">True</property>
+                    <property name="value">25</property>
+                  </object>
+                </child>
               </object>
             </child>
+
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_sizes">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Animation time (ms)</property>
                 <child>
-                  <object class="GtkGrid" id="grid_sizes">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="row_spacing">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="preview_size_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Window previews preferred size (px)</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSpinButton" id="preview_size_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="width_chars">4</property>
-                        <property name="text">100</property>
-                        <property name="adjustment">preview_size_adjustment</property>
-                        <property name="numeric">True</property>
-                        <property name="value">100</property>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="preview_aspect_ratio_y_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Window previews aspect ratio Y (height)</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">2</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="preview_padding_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Window previews padding (px)</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">3</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSpinButton" id="preview_padding_spinbutton">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="width_chars">4</property>
-                        <property name="text">50</property>
-                        <property name="adjustment">preview_padding_adjustment</property>
-                        <property name="numeric">True</property>
-                        <property name="value">50</property>
-                        <layout>
-                          <property name="row">3</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkBox">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="halign">end</property>
-                        <property name="spacing">2</property>
-                        <property name="homogeneous">True</property>
-                        <child>
-                          <object class="GtkComboBoxText" id="preview_aspect_ratio_x_combo">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="halign">end</property>
-                            <property name="valign">center</property>
-                            <items>
-                              <item id="1" translatable="yes">1</item>
-                              <item id="2" translatable="yes">2</item>
-                              <item id="3" translatable="yes">3</item>
-                              <item id="4" translatable="yes">4</item>
-                              <item id="5" translatable="yes">5</item>
-                              <item id="6" translatable="yes">6</item>
-                              <item id="7" translatable="yes">7</item>
-                              <item id="8" translatable="yes">8</item>
-                              <item id="9" translatable="yes">9</item>
-                              <item id="10" translatable="yes">10</item>
-                              <item id="11" translatable="yes">11</item>
-                              <item id="12" translatable="yes">12</item>
-                              <item id="13" translatable="yes">13</item>
-                              <item id="14" translatable="yes">14</item>
-                              <item id="15" translatable="yes">15</item>
-                              <item id="16" translatable="yes">16</item>
-                              <item id="17" translatable="yes">17</item>
-                              <item id="18" translatable="yes">18</item>
-                              <item id="19" translatable="yes">19</item>
-                              <item id="20" translatable="yes">20</item>
-                              <item id="21" translatable="yes">21</item>
-                            </items>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkToggleButton" id="preview_aspect_ratio_x_fixed_togglebutton">
-                            <property name="label" translatable="yes">Fixed</property>
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="receives_default">True</property>
-                            <property name="halign">end</property>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="preview_aspect_ratio_x_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Window previews aspect ratio X (width)</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkBox">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="halign">end</property>
-                        <property name="spacing">2</property>
-                        <property name="homogeneous">True</property>
-                        <child>
-                          <object class="GtkComboBoxText" id="preview_aspect_ratio_y_combo">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="halign">end</property>
-                            <property name="valign">center</property>
-                            <items>
-                              <item id="1" translatable="yes">1</item>
-                              <item id="2" translatable="yes">2</item>
-                              <item id="3" translatable="yes">3</item>
-                              <item id="4" translatable="yes">4</item>
-                              <item id="5" translatable="yes">5</item>
-                              <item id="6" translatable="yes">6</item>
-                              <item id="7" translatable="yes">7</item>
-                              <item id="8" translatable="yes">8</item>
-                              <item id="9" translatable="yes">9</item>
-                              <item id="10" translatable="yes">10</item>
-                              <item id="11" translatable="yes">11</item>
-                              <item id="12" translatable="yes">12</item>
-                              <item id="13" translatable="yes">13</item>
-                              <item id="14" translatable="yes">14</item>
-                              <item id="15" translatable="yes">15</item>
-                              <item id="16" translatable="yes">16</item>
-                              <item id="17" translatable="yes">17</item>
-                              <item id="18" translatable="yes">18</item>
-                              <item id="19" translatable="yes">19</item>
-                              <item id="20" translatable="yes">20</item>
-                              <item id="21" translatable="yes">21</item>
-                            </items>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkToggleButton" id="preview_aspect_ratio_y_fixed_togglebutton">
-                            <property name="label" translatable="yes">Fixed</property>
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="receives_default">True</property>
-                            <property name="halign">end</property>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">2</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
+                  <object class="GtkSpinButton" id="animation_time_spinbutton">
+                    <property name="valign">center</property>
+                    <property name="width_chars">4</property>
+                    <property name="text">0</property>
+                    <property name="adjustment">preview_animation_time_adjustment</property>
+                    <property name="numeric">True</property>
                   </object>
                 </child>
               </object>
             </child>
+
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwPreferencesGroup">
+
             <child>
-              <object class="GtkListBoxRow" id="listboxrow_preview_custom_opacity">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Middle click on the preview to close the window</property>
                 <child>
-                  <object class="GtkGrid" id="grid_preview_custom_opacity">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="preview_custom_opacity_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Use custom opacity for the previews background</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="preview_custom_opacity_description">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">If disabled, the previews background have the same opacity as the panel</property>
-                        <property name="wrap">True</property>
-                        <property name="max_width_chars">40</property>
-                        <property name="xalign">0</property>
-                        <style>
-                          <class name="dim-label"/>
-                        </style>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkBox">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="spacing">8</property>
-                        <child>
-                          <object class="GtkSwitch" id="preview_custom_opacity_switch">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="halign">end</property>
-                            <property name="valign">center</property>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkSpinButton" id="preview_custom_opacity_spinbutton">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="halign">end</property>
-                            <property name="valign">center</property>
-                            <property name="text" translatable="yes">5</property>
-                            <property name="adjustment">preview_opacity_adjustment</property>
-                            <property name="value">5</property>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
+                  <object class="GtkSwitch" id="preview_middle_click_close_switch">
+                    <property name="valign">center</property>
                   </object>
                 </child>
               </object>
             </child>
+
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwPreferencesGroup">
+
             <child>
-              <object class="GtkListBoxRow" id="listbox_preview_title_position">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Window previews preferred size (px)</property>
                 <child>
-                  <object class="GtkBox" id="preview_title_position_box">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="preview_title_position_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Close button and header position</property>
-                        <property name="xalign">0</property>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkBox" id="preview_title_position_butttons_box">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="halign">end</property>
-                        <property name="spacing">32</property>
-                        <child>
-                          <object class="GtkToggleButton" id="preview_title_position_bottom_button">
-                            <property name="label" translatable="yes">Bottom</property>
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="receives_default">False</property>
-                            <property name="halign">center</property>
-                            <property name="valign">center</property>
-                            <property name="active">True</property>
-                            <signal name="toggled" handler="preview_title_position_bottom_button_toggled_cb" swapped="no"/>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkToggleButton" id="preview_title_position_top_button">
-                            <property name="label" translatable="yes">Top</property>
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="receives_default">False</property>
-                            <property name="halign">center</property>
-                            <property name="valign">center</property>
-                            <property name="group">preview_title_position_bottom_button</property>
-                            <signal name="toggled" handler="preview_title_position_top_button_toggled_cb" swapped="no"/>
-                          </object>
-                        </child>
-                      </object>
-                    </child>
+                  <object class="GtkSpinButton" id="preview_size_spinbutton">
+                    <property name="valign">center</property>
+                    <property name="width_chars">4</property>
+                    <property name="text">100</property>
+                    <property name="adjustment">preview_size_adjustment</property>
+                    <property name="numeric">True</property>
+                    <property name="value">100</property>
                   </object>
                 </child>
               </object>
             </child>
+
             <child>
-              <object class="GtkListBoxRow" id="listbox_preview_show_title">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Window previews aspect ratio X (width)</property>
                 <child>
-                  <object class="GtkGrid" id="grid_preview_show_title">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="preview_show_title_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Display window preview headers</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="preview_show_title_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkGrid" id="grid_preview_custom_icon_size">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="margin_top">12</property>
-                        <property name="column_spacing">32</property>
-                        <child>
-                          <object class="GtkBox">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="spacing">8</property>
-                            <child>
-                              <object class="GtkSwitch" id="preview_custom_icon_size_switch">
-                                <property name="visible">True</property>
-                                <property name="can_focus">True</property>
-                                <property name="halign">end</property>
-                                <property name="valign">center</property>
-                              </object>
-                            </child>
-                            <child>
-                              <object class="GtkSpinButton" id="preview_custom_icon_size_spinbutton">
-                                <property name="visible">True</property>
-                                <property name="can_focus">True</property>
-                                <property name="halign">end</property>
-                                <property name="width_chars">4</property>
-                                <property name="text">6</property>
-                                <property name="adjustment">preview_custom_icon_size_adjustment</property>
-                                <property name="numeric">True</property>
-                                <property name="value">6</property>
-                              </object>
-                            </child>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkLabel" id="preview_custom_icon_size_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Icon size (px) of the window preview</property>
-                            <property name="use_markup">True</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">1</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkLabel" id="preview_custom_icon_size_description">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">If disabled, the previews icon size will be based on headerbar size</property>
-                            <property name="wrap">True</property>
-                            <property name="max_width_chars">40</property>
-                            <property name="xalign">0</property>
-                            <style>
-                              <class name="dim-label"/>
-                            </style>
-                            <layout>
-                              <property name="row">1</property>
-                              <property name="column">0</property>
-                              <property name="column-span">2</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkGrid" id="grid_preview_title_size">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="margin_top">12</property>
-                        <property name="column_spacing">32</property>
-                        <child>
-                          <object class="GtkSpinButton" id="preview_title_size_spinbutton">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="halign">end</property>
-                            <property name="width_chars">4</property>
-                            <property name="text">6</property>
-                            <property name="adjustment">preview_title_font_size_adjustment</property>
-                            <property name="numeric">True</property>
-                            <property name="value">6</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkLabel" id="preview_title_size_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Font size (px) of the preview titles</property>
-                            <property name="use_markup">True</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">2</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkGrid" id="grid_preview_title_weight">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="margin_top">12</property>
-                        <property name="column_spacing">32</property>
-                        <child>
-                          <object class="GtkLabel" id="grid_preview_title_weight_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Font weight of the preview titles</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkComboBoxText" id="grid_preview_title_weight_combo">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="halign">end</property>
-                            <property name="valign">center</property>
-                            <items>
-                              <item id="inherit" translatable="yes">inherit from theme</item>
-                              <item id="normal" translatable="yes">normal</item>
-                              <item id="lighter" translatable="yes">lighter</item>
-                              <item id="bold" translatable="yes">bold</item>
-                              <item id="bolder" translatable="yes">bolder</item>
-                            </items>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">3</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkGrid" id="grid_preview_title_font_color">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="margin_top">12</property>
-                        <property name="column_spacing">32</property>
-                        <child>
-                          <object class="GtkLabel" id="grid_preview_title_font_color_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Font color of the preview titles</property>
-                            <property name="use_markup">True</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkColorButton" id="grid_preview_title_font_color_colorbutton">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="receives_default">True</property>
-                            <property name="halign">end</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">4</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
+                  <object class="GtkComboBoxText" id="preview_aspect_ratio_x_combo">
+                    <property name="valign">center</property>
+                    <items>
+                      <item id="1" translatable="yes">1</item>
+                      <item id="2" translatable="yes">2</item>
+                      <item id="3" translatable="yes">3</item>
+                      <item id="4" translatable="yes">4</item>
+                      <item id="5" translatable="yes">5</item>
+                      <item id="6" translatable="yes">6</item>
+                      <item id="7" translatable="yes">7</item>
+                      <item id="8" translatable="yes">8</item>
+                      <item id="9" translatable="yes">9</item>
+                      <item id="10" translatable="yes">10</item>
+                      <item id="11" translatable="yes">11</item>
+                      <item id="12" translatable="yes">12</item>
+                      <item id="13" translatable="yes">13</item>
+                      <item id="14" translatable="yes">14</item>
+                      <item id="15" translatable="yes">15</item>
+                      <item id="16" translatable="yes">16</item>
+                      <item id="17" translatable="yes">17</item>
+                      <item id="18" translatable="yes">18</item>
+                      <item id="19" translatable="yes">19</item>
+                      <item id="20" translatable="yes">20</item>
+                      <item id="21" translatable="yes">21</item>
+                    </items>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkToggleButton" id="preview_aspect_ratio_x_fixed_togglebutton">
+                    <property name="label" translatable="yes">Fixed</property>
+                    <property name="receives_default">True</property>
+                    <property name="valign">center</property>
                   </object>
                 </child>
               </object>
             </child>
+
             <child>
-              <object class="GtkListBoxRow" id="listbox_peek_mode">
-                <property name="visible">True</property>
-                <property name="can_focus">True</property>
-                <property name="margin_bottom">6</property>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Window previews aspect ratio Y (height)</property>
                 <child>
-                  <object class="GtkGrid" id="grid_peek_mode">
-                    <property name="visible">True</property>
-                    <property name="can_focus">False</property>
-                    <property name="margin_start">12</property>
-                    <property name="margin_end">12</property>
-                    <property name="margin_top">12</property>
-                    <property name="margin_bottom">12</property>
-                    <property name="column_spacing">32</property>
-                    <child>
-                      <object class="GtkLabel" id="peek_mode_label">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">Enable window peeking</property>
-                        <property name="use_markup">True</property>
-                        <property name="xalign">0</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">0</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkSwitch" id="peek_mode_switch">
-                        <property name="visible">True</property>
-                        <property name="can_focus">True</property>
-                        <property name="halign">end</property>
-                        <property name="valign">center</property>
-                        <layout>
-                          <property name="row">0</property>
-                          <property name="column">1</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkLabel" id="peek_mode_description">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="hexpand">True</property>
-                        <property name="label" translatable="yes">When hovering over a window preview for some time, the window gets distinguished.</property>
-                        <property name="wrap">True</property>
-                        <property name="max_width_chars">40</property>
-                        <property name="xalign">0</property>
-                        <style>
-                          <class name="dim-label"/>
-                        </style>
-                        <layout>
-                          <property name="row">1</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkGrid" id="grid_enter_peek_mode_timeout">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="margin_top">12</property>
-                        <property name="column_spacing">32</property>
-                        <child>
-                          <object class="GtkLabel" id="enter_peek_mode_timeout_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Enter window peeking mode timeout (ms)</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkSpinButton" id="enter_peek_mode_timeout_spinbutton">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="halign">end</property>
-                            <property name="width_chars">4</property>
-                            <property name="text" translatable="yes">50</property>
-                            <property name="adjustment">enter_peek_mode_timeout_adjustment</property>
-                            <property name="numeric">True</property>
-                            <property name="value">50</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkLabel" id="enter_peek_mode_timeout_description">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Time of inactivity while hovering over a window preview needed to enter the window peeking mode.</property>
-                            <property name="wrap">True</property>
-                            <property name="max_width_chars">40</property>
-                            <property name="xalign">0</property>
-                            <style>
-                              <class name="dim-label"/>
-                            </style>
-                            <layout>
-                              <property name="row">1</property>
-                              <property name="column">0</property>
-                              <property name="column-span">2</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">2</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
-                    <child>
-                      <object class="GtkGrid" id="grid_peek_mode_opacity">
-                        <property name="visible">True</property>
-                        <property name="can_focus">False</property>
-                        <property name="margin_top">12</property>
-                        <property name="column_spacing">32</property>
-                        <child>
-                          <object class="GtkLabel" id="peek_mode_opacity_label">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">Window peeking mode opacity</property>
-                            <property name="xalign">0</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">0</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkSpinButton" id="peek_mode_opacity_spinbutton">
-                            <property name="visible">True</property>
-                            <property name="can_focus">True</property>
-                            <property name="halign">end</property>
-                            <property name="width_chars">4</property>
-                            <property name="text" translatable="yes">0</property>
-                            <property name="adjustment">peek_mode_opacity_adjustment</property>
-                            <property name="numeric">True</property>
-                            <layout>
-                              <property name="row">0</property>
-                              <property name="column">1</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <child>
-                          <object class="GtkLabel" id="peek_mode_opacity_description">
-                            <property name="visible">True</property>
-                            <property name="can_focus">False</property>
-                            <property name="hexpand">True</property>
-                            <property name="label" translatable="yes">All windows except for the peeked one have their opacity set to the same value.</property>
-                            <property name="wrap">True</property>
-                            <property name="max_width_chars">40</property>
-                            <property name="xalign">0</property>
-                            <style>
-                              <class name="dim-label"/>
-                            </style>
-                            <layout>
-                              <property name="row">1</property>
-                              <property name="column">0</property>
-                              <property name="column-span">2</property>
-                            </layout>
-                          </object>
-                        </child>
-                        <layout>
-                          <property name="row">3</property>
-                          <property name="column">0</property>
-                          <property name="column-span">2</property>
-                        </layout>
-                      </object>
-                    </child>
+                  <object class="GtkComboBoxText" id="preview_aspect_ratio_y_combo">
+                    <property name="valign">center</property>
+                    <items>
+                      <item id="1" translatable="yes">1</item>
+                      <item id="2" translatable="yes">2</item>
+                      <item id="3" translatable="yes">3</item>
+                      <item id="4" translatable="yes">4</item>
+                      <item id="5" translatable="yes">5</item>
+                      <item id="6" translatable="yes">6</item>
+                      <item id="7" translatable="yes">7</item>
+                      <item id="8" translatable="yes">8</item>
+                      <item id="9" translatable="yes">9</item>
+                      <item id="10" translatable="yes">10</item>
+                      <item id="11" translatable="yes">11</item>
+                      <item id="12" translatable="yes">12</item>
+                      <item id="13" translatable="yes">13</item>
+                      <item id="14" translatable="yes">14</item>
+                      <item id="15" translatable="yes">15</item>
+                      <item id="16" translatable="yes">16</item>
+                      <item id="17" translatable="yes">17</item>
+                      <item id="18" translatable="yes">18</item>
+                      <item id="19" translatable="yes">19</item>
+                      <item id="20" translatable="yes">20</item>
+                      <item id="21" translatable="yes">21</item>
+                    </items>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkToggleButton" id="preview_aspect_ratio_y_fixed_togglebutton">
+                    <property name="label" translatable="yes">Fixed</property>
+                    <property name="receives_default">True</property>
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Window previews padding (px)</property>
+                <child>
+                  <object class="GtkSpinButton" id="preview_padding_spinbutton">
+                    <property name="valign">center</property>
+                    <property name="width_chars">4</property>
+                    <property name="text">50</property>
+                    <property name="adjustment">preview_padding_adjustment</property>
+                    <property name="numeric">True</property>
+                    <property name="value">50</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwPreferencesGroup">
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Use custom opacity for the previews background</property>
+                <property name="subtitle" translatable="yes">If disabled, the previews background have the same opacity as the panel.</property>
+                <child>
+                  <object class="GtkSwitch" id="preview_custom_opacity_switch">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkSpinButton" id="preview_custom_opacity_spinbutton">
+                    <property name="valign">center</property>
+                    <property name="text" translatable="yes">5</property>
+                    <property name="adjustment">preview_opacity_adjustment</property>
+                    <property name="value">5</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwPreferencesGroup">
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Close button and header position</property>
+                <child>
+                  <object class="GtkToggleButton" id="preview_title_position_bottom_button">
+                    <property name="label" translatable="yes">Bottom</property>
+                    <property name="receives_default">False</property>
+                    <property name="valign">center</property>
+                    <property name="active">True</property>
+                    <signal name="toggled" handler="preview_title_position_bottom_button_toggled_cb" swapped="no"/>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkToggleButton" id="preview_title_position_top_button">
+                    <property name="label" translatable="yes">Top</property>
+                    <property name="receives_default">False</property>
+                    <property name="valign">center</property>
+                    <property name="group">preview_title_position_bottom_button</property>
+                    <signal name="toggled" handler="preview_title_position_top_button_toggled_cb" swapped="no"/>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwPreferencesGroup">
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Display window preview headers</property>
+                <child>
+                  <object class="GtkSwitch" id="preview_show_title_switch">>
+                    <property name="valign">center</property>
                   </object>
                 </child>
               </object>
             </child>
+
+            <child>
+              <object class="AdwActionRow" id="grid_preview_custom_icon_size">
+                <property name="title" translatable="yes">Icon size (px) of the window preview</property>
+                <property name="subtitle" translatable="yes">If disabled, the previews icon size will be based on headerbar size</property>
+                <child>
+                  <object class="GtkSwitch" id="preview_custom_icon_size_switch">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+                <child>
+                  <object class="GtkSpinButton" id="preview_custom_icon_size_spinbutton">
+                    <property name="valign">center</property>
+                    <property name="width_chars">4</property>
+                    <property name="text">6</property>
+                    <property name="adjustment">preview_custom_icon_size_adjustment</property>
+                    <property name="numeric">True</property>
+                    <property name="value">6</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+            <child>
+              <object class="AdwActionRow" id="grid_preview_title_size">
+                <property name="title" translatable="yes">Font size (px) of the preview titles</property>
+                <child>
+                  <object class="GtkSpinButton" id="preview_title_size_spinbutton">
+                    <property name="valign">center</property>
+                    <property name="width_chars">4</property>
+                    <property name="text">6</property>
+                    <property name="adjustment">preview_title_font_size_adjustment</property>
+                    <property name="numeric">True</property>
+                    <property name="value">6</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+            <child>
+              <object class="AdwActionRow" id="grid_preview_title_weight">
+                <property name="title" translatable="yes">Font weight of the preview titles</property>
+                <child>
+                  <object class="GtkComboBoxText" id="grid_preview_title_weight_combo">
+                    <property name="valign">center</property>
+                    <items>
+                      <item id="inherit" translatable="yes">inherit from theme</item>
+                      <item id="normal" translatable="yes">normal</item>
+                      <item id="lighter" translatable="yes">lighter</item>
+                      <item id="bold" translatable="yes">bold</item>
+                      <item id="bolder" translatable="yes">bolder</item>
+                    </items>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+            <child>
+              <object class="AdwActionRow" id="grid_preview_title_font_color">
+                <property name="title" translatable="yes">Font color of the preview titles</property>
+                <child>
+                  <object class="GtkColorButton" id="grid_preview_title_font_color_colorbutton">
+                    <property name="receives_default">True</property>
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+          </object>
+        </child>
+
+        <child>
+          <object class="AdwPreferencesGroup">
+
+            <child>
+              <object class="AdwActionRow">
+                <property name="title" translatable="yes">Enable window peeking</property>
+                <property name="subtitle" translatable="yes">When hovering over a window preview for some time, the window gets distinguished.</property>
+                <child>
+                  <object class="GtkSwitch" id="peek_mode_switch">
+                    <property name="valign">center</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+            <child>
+              <object class="AdwActionRow" id="grid_enter_peek_mode_timeout">
+                <property name="title" translatable="yes">Enter window peeking mode timeout (ms)</property>
+                <property name="subtitle" translatable="yes">Time of inactivity while hovering over a window preview needed to enter the window peeking mode.</property>
+                <child>
+                  <object class="GtkSpinButton" id="enter_peek_mode_timeout_spinbutton">
+                    <property name="valign">center</property>
+                    <property name="width_chars">4</property>
+                    <property name="text" translatable="yes">50</property>
+                    <property name="adjustment">enter_peek_mode_timeout_adjustment</property>
+                    <property name="numeric">True</property>
+                    <property name="value">50</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
+            <child>
+              <object class="AdwActionRow" id="grid_peek_mode_opacity">
+                <property name="title" translatable="yes">Window peeking mode opacity</property>
+                <property name="subtitle" translatable="yes">All windows except for the peeked one have their opacity set to the same value.</property>
+                <child>
+                  <object class="GtkSpinButton" id="peek_mode_opacity_spinbutton">
+                    <property name="valign">center</property>
+                    <property name="width_chars">4</property>
+                    <property name="text" translatable="yes">0</property>
+                    <property name="adjustment">peek_mode_opacity_adjustment</property>
+                    <property name="numeric">True</property>
+                  </object>
+                </child>
+              </object>
+            </child>
+
           </object>
         </child>
+
       </object>
+
     </child>
   </object>
 

From 0ef521d39d543b5b22553ddf4e4209a9a8c568e7 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 17:30:05 +0200
Subject: [PATCH 46/62] use deault width or preferences window

---
 prefs.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/prefs.js b/prefs.js
index 82522e55..74f743f1 100644
--- a/prefs.js
+++ b/prefs.js
@@ -2348,7 +2348,8 @@ function init() {
 }
 
 function fillPreferencesWindow(window) {
-    window.set_default_size(680, 740);
+    // use default width or window
+    window.set_default_size(0, 740);
 
     let preferences = new Preferences(window);
 }

From 5c200d7577cea405a6ba73731c2f75a8d12f2982 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 18:03:32 +0200
Subject: [PATCH 47/62] fix sensitive change of grid_dot_color_unfocused

---
 prefs.js            | 1 +
 ui/BoxDotOptions.ui | 1 -
 2 files changed, 1 insertion(+), 1 deletion(-)

diff --git a/prefs.js b/prefs.js
index 74f743f1..c2dc4539 100644
--- a/prefs.js
+++ b/prefs.js
@@ -836,6 +836,7 @@ const Preferences = class {
             });
             this._builder.get_object('dot_color_override_switch').connect('state-set', (widget) => {
                 if (widget.get_active()) this._settings.set_boolean('dot-color-dominant', false);
+                else if (this._window) this._settings.set_boolean('dot-color-unfocused-different', false);
             });
 
             this._settings.bind('dot-color-unfocused-different',
diff --git a/ui/BoxDotOptions.ui b/ui/BoxDotOptions.ui
index 6ca19c47..18c81ecb 100644
--- a/ui/BoxDotOptions.ui
+++ b/ui/BoxDotOptions.ui
@@ -207,7 +207,6 @@
           </object>
         </child>
 
-        <!-- TODO sensitivity of this group has to be connected to dot_color_override_switch -->
         <child>
           <object class="AdwPreferencesGroup" id="grid_dot_color_unfocused">
 

From 2daa798050c8b8d6519bfc63b1a0324692acbf71 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Sat, 9 Apr 2022 20:27:33 +0200
Subject: [PATCH 48/62] fix taskbar_display_listbox background mismatch

---
 prefs.js               | 6 ++++++
 ui/SettingsPosition.ui | 3 ++-
 2 files changed, 8 insertions(+), 1 deletion(-)

diff --git a/prefs.js b/prefs.js
index c2dc4539..6bcaa86a 100644
--- a/prefs.js
+++ b/prefs.js
@@ -210,6 +210,12 @@ const Preferences = class {
             let pageAbout = this._builder.get_object('about');
             window.add(pageAbout);
 
+            let listbox = this._builder.get_object('taskbar_display_listbox');
+            let provider = new Gtk.CssProvider();
+            provider.load_from_data('list { background-color: transparent; }');
+            let context = listbox.get_style_context();
+            context.add_provider(provider, Gtk.STYLE_PROVIDER_PRIORITY_APPLICATION);
+
             // set the window as notebook, it is being used as parent for dialogs
             this.notebook = window;
 
diff --git a/ui/SettingsPosition.ui b/ui/SettingsPosition.ui
index 14de8147..304bf1f3 100644
--- a/ui/SettingsPosition.ui
+++ b/ui/SettingsPosition.ui
@@ -231,9 +231,10 @@
               <property name="title" translatable="yes">Taskbar Display</property>
               <child>
                 <object class="GtkListBox" id="taskbar_display_listbox">
+                  <property name="margin-top">6</property>
+                  <property name="margin-bottom">6</property>
                   <property name="visible">True</property>
                   <property name="can_focus">False</property>
-                  <property name="margin_bottom">6</property>
                   <property name="selection_mode">none</property>
                 </object>
               </child>

From a3af647b4d7b06926d2518f74cd63bab552601ab Mon Sep 17 00:00:00 2001
From: Philipp <57151725+philippun1@users.noreply.github.com>
Date: Tue, 12 Apr 2022 16:39:57 +0200
Subject: [PATCH 49/62] Update ui/SettingsPosition.ui

Co-authored-by: Andrew Zaech <azaech021@gmail.com>
---
 ui/SettingsPosition.ui | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ui/SettingsPosition.ui b/ui/SettingsPosition.ui
index 304bf1f3..5a8c379f 100644
--- a/ui/SettingsPosition.ui
+++ b/ui/SettingsPosition.ui
@@ -17,7 +17,7 @@
 
   <object class="AdwPreferencesPage" id="position">
     <property name="title">Position</property>
-    <property name="icon_name">find-location</property>
+    <property name="icon_name">find-location-symbolic</property>
 
       <!-- group panel -->
       <child>

From e46a5feca55c37daa2e00622d0a7b37120421d0f Mon Sep 17 00:00:00 2001
From: Philipp <57151725+philippun1@users.noreply.github.com>
Date: Tue, 12 Apr 2022 16:40:11 +0200
Subject: [PATCH 50/62] Update ui/SettingsPosition.ui

Co-authored-by: Andrew Zaech <azaech021@gmail.com>
---
 ui/SettingsPosition.ui | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/ui/SettingsPosition.ui b/ui/SettingsPosition.ui
index 5a8c379f..6c1a0973 100644
--- a/ui/SettingsPosition.ui
+++ b/ui/SettingsPosition.ui
@@ -28,7 +28,8 @@
             <object class="AdwActionRow">
               <property name="title" translatable="yes">Display the main panel on</property>
               <child>
-                <object class="GtkSwitch" id="multimon_multi_switch">
+                <object class="GtkComboBoxText" id="multimon_primary_combo">
+                  <property name="can_focus">False</property>
                   <property name="valign">center</property>
                 </object>
               </child>

From 7b7473e40767dada7e6c3acb1a7515f2b8c3ec77 Mon Sep 17 00:00:00 2001
From: Philipp <57151725+philippun1@users.noreply.github.com>
Date: Tue, 12 Apr 2022 16:40:18 +0200
Subject: [PATCH 51/62] Update ui/SettingsPosition.ui

Co-authored-by: Andrew Zaech <azaech021@gmail.com>
---
 ui/SettingsPosition.ui | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/ui/SettingsPosition.ui b/ui/SettingsPosition.ui
index 6c1a0973..7ea97756 100644
--- a/ui/SettingsPosition.ui
+++ b/ui/SettingsPosition.ui
@@ -40,8 +40,7 @@
             <object class="AdwActionRow">
               <property name="title" translatable="yes">Display panels on all monitors</property>
               <child>
-                <object class="GtkComboBoxText" id="multimon_primary_combo">
-                  <property name="can_focus">False</property>
+                <object class="GtkSwitch" id="multimon_multi_switch">
                   <property name="valign">center</property>
                 </object>
               </child>

From e96196e262c7892fca9ba72ae1a486dd39041073 Mon Sep 17 00:00:00 2001
From: Philipp <57151725+philippun1@users.noreply.github.com>
Date: Tue, 12 Apr 2022 16:40:26 +0200
Subject: [PATCH 52/62] Update ui/SettingsAbout.ui

Co-authored-by: Andrew Zaech <azaech021@gmail.com>
---
 ui/SettingsAbout.ui | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ui/SettingsAbout.ui b/ui/SettingsAbout.ui
index caeb2755..e5bcfbdc 100644
--- a/ui/SettingsAbout.ui
+++ b/ui/SettingsAbout.ui
@@ -4,7 +4,7 @@
 
   <object class="AdwPreferencesPage" id="about">
     <property name="title">About</property>
-    <property name="icon_name">help-about</property>
+    <property name="icon_name">help-about-symbolic</property>
 
       <!-- group info -->
       <child>

From c2befa5e926228ed564cfe04cf33cff4cf7253a6 Mon Sep 17 00:00:00 2001
From: Philipp <57151725+philippun1@users.noreply.github.com>
Date: Tue, 12 Apr 2022 16:40:33 +0200
Subject: [PATCH 53/62] Update ui/SettingsAction.ui

Co-authored-by: Andrew Zaech <azaech021@gmail.com>
---
 ui/SettingsAction.ui | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ui/SettingsAction.ui b/ui/SettingsAction.ui
index c552d1ea..6d40ab86 100644
--- a/ui/SettingsAction.ui
+++ b/ui/SettingsAction.ui
@@ -4,7 +4,7 @@
 
   <object class="AdwPreferencesPage" id="action">
     <property name="title">Action</property>
-    <property name="icon_name">view-pin</property>
+    <property name="icon_name">view-pin-symbolic</property>
 
     <!-- group click action -->
     <child>

From 0c9f09f81ab674c52d5acd68d9e05b5a599c6700 Mon Sep 17 00:00:00 2001
From: Philipp <57151725+philippun1@users.noreply.github.com>
Date: Tue, 12 Apr 2022 16:40:49 +0200
Subject: [PATCH 54/62] Update ui/SettingsBehavior.ui

Co-authored-by: Andrew Zaech <azaech021@gmail.com>
---
 ui/SettingsBehavior.ui | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ui/SettingsBehavior.ui b/ui/SettingsBehavior.ui
index 9ea25601..d363ffae 100644
--- a/ui/SettingsBehavior.ui
+++ b/ui/SettingsBehavior.ui
@@ -3,7 +3,7 @@
   <requires lib="gtk" version="4.0"/>
   <object class="AdwPreferencesPage" id="behavior">
     <property name="title">Behavior</property>
-    <property name="icon_name">visible</property>
+    <property name="icon_name">preferences-system-symbolic</property>
 
     <!-- group applications -->
     <child>

From 72784bfebf7105e489a57d66aa6c1a07db001a45 Mon Sep 17 00:00:00 2001
From: Philipp <57151725+philippun1@users.noreply.github.com>
Date: Tue, 12 Apr 2022 16:40:58 +0200
Subject: [PATCH 55/62] Update ui/SettingsFineTune.ui

Co-authored-by: Andrew Zaech <azaech021@gmail.com>
---
 ui/SettingsFineTune.ui | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ui/SettingsFineTune.ui b/ui/SettingsFineTune.ui
index 2528f606..7e529f2e 100644
--- a/ui/SettingsFineTune.ui
+++ b/ui/SettingsFineTune.ui
@@ -39,7 +39,7 @@
 
   <object class="AdwPreferencesPage" id="finetune">
     <property name="title">Fine-Tune</property>
-    <property name="icon_name">color-select</property>
+    <property name="icon_name">preferences-other-symbolic</property>
 
       <!-- group font -->
       <child>

From c048935ead41ad0f4cb03d52e9d9a511638e4291 Mon Sep 17 00:00:00 2001
From: Philipp <57151725+philippun1@users.noreply.github.com>
Date: Tue, 12 Apr 2022 16:41:06 +0200
Subject: [PATCH 56/62] Update ui/SettingsStyle.ui

Co-authored-by: Andrew Zaech <azaech021@gmail.com>
---
 ui/SettingsStyle.ui | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ui/SettingsStyle.ui b/ui/SettingsStyle.ui
index a52f762e..299600b2 100644
--- a/ui/SettingsStyle.ui
+++ b/ui/SettingsStyle.ui
@@ -36,7 +36,7 @@
 
   <object class="AdwPreferencesPage" id="style">
     <property name="title">Style</property>
-    <property name="icon_name">image-adjust-color</property>
+    <property name="icon_name">applications-graphics-symbolic</property>
 
     <!-- group app icon style -->
     <child>

From a55845b331dcec023ff6fc86be30ae7a01012c68 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Wed, 13 Apr 2022 20:08:27 +0200
Subject: [PATCH 57/62] use default gtk focus

---
 ui/BoxAnimateAppIconHoverOptions.ui | 1 -
 ui/BoxShowApplicationsOptions.ui    | 1 -
 ui/BoxShowDesktopOptions.ui         | 1 -
 ui/BoxWindowPreviewOptions.ui       | 1 -
 ui/SettingsAction.ui                | 8 --------
 ui/SettingsFineTune.ui              | 2 --
 ui/SettingsPosition.ui              | 5 -----
 ui/SettingsStyle.ui                 | 2 --
 8 files changed, 21 deletions(-)

diff --git a/ui/BoxAnimateAppIconHoverOptions.ui b/ui/BoxAnimateAppIconHoverOptions.ui
index f59934ce..f49e2d72 100644
--- a/ui/BoxAnimateAppIconHoverOptions.ui
+++ b/ui/BoxAnimateAppIconHoverOptions.ui
@@ -62,7 +62,6 @@
             <property name="title" translatable="yes">Animation type</property>
             <child>
               <object class="GtkComboBoxText" id="animate_appicon_hover_options_type_combo">
-                <property name="can_focus">False</property>
                 <property name="valign">center</property>
                 <items>
                   <item id="SIMPLE" translatable="yes">Simple</item>
diff --git a/ui/BoxShowApplicationsOptions.ui b/ui/BoxShowApplicationsOptions.ui
index fa530d1b..ee183a5b 100644
--- a/ui/BoxShowApplicationsOptions.ui
+++ b/ui/BoxShowApplicationsOptions.ui
@@ -27,7 +27,6 @@
               <object class="GtkImage" id="show_applications_current_icon_image">
                 <property name="width_request">32</property>
                 <property name="height_request">32</property>
-                <property name="can_focus">False</property>
                 <property name="icon_name">gtk-missing-image</property>
                 <property name="pixel_size">32</property>
               </object>
diff --git a/ui/BoxShowDesktopOptions.ui b/ui/BoxShowDesktopOptions.ui
index e5982182..be5d21c1 100644
--- a/ui/BoxShowDesktopOptions.ui
+++ b/ui/BoxShowDesktopOptions.ui
@@ -78,7 +78,6 @@
             <child>
               <object class="GtkSwitch" id="show_showdesktop_hide_switch">
                 <property name="visible">True</property>
-                <property name="can_focus">True</property>
                 <property name="halign">end</property>
                 <property name="valign">center</property>
               </object>
diff --git a/ui/BoxWindowPreviewOptions.ui b/ui/BoxWindowPreviewOptions.ui
index 2b9da63f..87cecff4 100644
--- a/ui/BoxWindowPreviewOptions.ui
+++ b/ui/BoxWindowPreviewOptions.ui
@@ -110,7 +110,6 @@
                     <child>
                       <object class="GtkLabel" id="preview_immediate_click_label">
                         <property name="name">4</property>
-                        <property name="can_focus">False</property>
                         <property name="label" translatable="yes">Immediate on application icon click</property>
                         <property name="use_markup">True</property>
                       </object>
diff --git a/ui/SettingsAction.ui b/ui/SettingsAction.ui
index 6d40ab86..790e1185 100644
--- a/ui/SettingsAction.ui
+++ b/ui/SettingsAction.ui
@@ -21,7 +21,6 @@
                 <property name="valign">center</property>
                 <child>
                   <object class="GtkImage" id="middle_click_image">
-                    <property name="can_focus">False</property>
                     <property name="icon_name">emblem-system-symbolic</property>
                   </object>
                 </child>
@@ -32,7 +31,6 @@
             </child>
             <child>
               <object class="GtkComboBoxText" id="click_action_combo">
-                <property name="can_focus">False</property>
                 <property name="valign">center</property>
                 <items>
                   <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
@@ -62,14 +60,12 @@
             <child>
               <object class="GtkButton" id="scroll_panel_options_button">
                 <property name="visible">True</property>
-                <property name="can_focus">True</property>
                 <property name="receives_default">True</property>
                 <property name="halign">end</property>
                 <property name="valign">center</property>
                 <child>
                   <object class="GtkImage" id="scroll_panel_options_button_image">
                     <property name="visible">True</property>
-                    <property name="can_focus">False</property>
                     <property name="icon_name">emblem-system-symbolic</property>
                   </object>
                 </child>
@@ -81,7 +77,6 @@
             <child>
               <object class="GtkComboBoxText" id="scroll_panel_combo">
                 <property name="visible">True</property>
-                <property name="can_focus">False</property>
                 <property name="valign">center</property>
                 <property name="hexpand">True</property>
                 <items>
@@ -106,7 +101,6 @@
                 <child>
                   <object class="GtkImage" id="scroll_icon_options_button_image">
                     <property name="visible">True</property>
-                    <property name="can_focus">False</property>
                     <property name="icon_name">emblem-system-symbolic</property>
                   </object>
                 </child>
@@ -117,7 +111,6 @@
             </child>
             <child>
               <object class="GtkComboBoxText" id="scroll_icon_combo">
-                <property name="can_focus">False</property>
                 <property name="valign">center</property>
                 <property name="hexpand">True</property>
                 <items>
@@ -148,7 +141,6 @@
                 <property name="valign">center</property>
                 <child>
                   <object class="GtkImage" id="image_overlay">
-                    <property name="can_focus">False</property>
                     <property name="icon_name">emblem-system-symbolic</property>
                   </object>
                 </child>
diff --git a/ui/SettingsFineTune.ui b/ui/SettingsFineTune.ui
index 7e529f2e..5306ec54 100644
--- a/ui/SettingsFineTune.ui
+++ b/ui/SettingsFineTune.ui
@@ -245,7 +245,6 @@
                   <property name="valign">center</property>
                   <child>
                     <object class="GtkImage" id="secondarymenu_options_button_image">
-                      <property name="can_focus">False</property>
                       <property name="icon_name">emblem-system-symbolic</property>
                     </object>
                   </child>
@@ -268,7 +267,6 @@
             <object class="GtkButton" id="button_advanced_options">
               <property name="label" translatable="yes">Advanced Options</property>
               <property name="visible">False</property>
-              <property name="can_focus">True</property>
               <property name="receives_default">True</property>
               <property name="halign">end</property>
             </object>
diff --git a/ui/SettingsPosition.ui b/ui/SettingsPosition.ui
index 7ea97756..b7a1b31c 100644
--- a/ui/SettingsPosition.ui
+++ b/ui/SettingsPosition.ui
@@ -29,7 +29,6 @@
               <property name="title" translatable="yes">Display the main panel on</property>
               <child>
                 <object class="GtkComboBoxText" id="multimon_primary_combo">
-                  <property name="can_focus">False</property>
                   <property name="valign">center</property>
                 </object>
               </child>
@@ -62,7 +61,6 @@
                   <property name="valign">center</property>
                   <child>
                     <object class="GtkImage" id="image_intellihide_options">
-                      <property name="can_focus">False</property>
                       <property name="icon_name">emblem-system-symbolic</property>
                     </object>
                   </child>
@@ -107,7 +105,6 @@
                   </child>
                   <child>
                     <object class="GtkComboBoxText" id="taskbar_position_monitor_combo">
-                      <property name="can_focus">False</property>
                       <property name="halign">end</property>
                       <property name="valign">center</property>
                       <property name="hexpand">True</property>
@@ -207,7 +204,6 @@
               <property name="title" translatable="yes">Anchor</property>
               <child>
                 <object class="GtkComboBoxText" id="panel_anchor_combo">
-                  <property name="can_focus">False</property>
                   <property name="valign">center</property>
                   <items>
                     <item id="START" translatable="yes">Start</item>
@@ -234,7 +230,6 @@
                   <property name="margin-top">6</property>
                   <property name="margin-bottom">6</property>
                   <property name="visible">True</property>
-                  <property name="can_focus">False</property>
                   <property name="selection_mode">none</property>
                 </object>
               </child>
diff --git a/ui/SettingsStyle.ui b/ui/SettingsStyle.ui
index 299600b2..a84a2bbb 100644
--- a/ui/SettingsStyle.ui
+++ b/ui/SettingsStyle.ui
@@ -92,7 +92,6 @@
                 <property name="valign">center</property>
                 <child>
                   <object class="GtkImage" id="animate_appicon_hover_options_image">
-                    <property name="can_focus">False</property>
                     <property name="icon_name">emblem-system-symbolic</property>
                   </object>
                 </child>
@@ -271,7 +270,6 @@
                 <property name="valign">center</property>
                 <child>
                   <object class="GtkImage" id="image_trans_dyn_options">
-                    <property name="can_focus">False</property>
                     <property name="icon_name">emblem-system-symbolic</property>
                   </object>
                 </child>

From 0f2442c200ea83858b54a26ac076f9de82a2022a Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Mon, 18 Apr 2022 16:51:35 +0200
Subject: [PATCH 58/62] removed prefs.js backwards compatibility to gnome 41

---
 prefs.js | 166 +++++++++++++++++++++++--------------------------------
 1 file changed, 70 insertions(+), 96 deletions(-)

diff --git a/prefs.js b/prefs.js
index 6bcaa86a..5525fc07 100644
--- a/prefs.js
+++ b/prefs.js
@@ -158,71 +158,64 @@ function mergeObjects(main, bck) {
 
 const Preferences = class {
 
-    constructor() {
+    constructor(window) {
         this._settings = ExtensionUtils.getSettings('org.gnome.shell.extensions.dash-to-panel');
         this._rtl = (Gtk.Widget.get_default_direction() == Gtk.TextDirection.RTL);
         this._builder = new Gtk.Builder();
         this._builder.set_scope(new BuilderScope(this));
         this._builder.set_translation_domain(Me.metadata['gettext-domain']);
 
-        if (window) {
-            this._window = window;
-            window.set_search_enabled(true);
-
-            // dialogs
-            this._builder.add_from_file(Me.path + '/ui/BoxAnimateAppIconHoverOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxDotOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxShowDesktopOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxDynamicOpacityOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxIntellihideOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxShowApplicationsOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxWindowPreviewOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxGroupAppsOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxMiddleClickOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxOverlayShortcut.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxSecondaryMenuOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxScrollPanelOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxScrollIconOptions.ui');
-            this._builder.add_from_file(Me.path + '/ui/BoxAdvancedOptions.ui');
-
-            // pages
-            this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
-            let pagePosition = this._builder.get_object('position');
-            window.add(pagePosition);
-
-            this._builder.add_from_file(Me.path + '/ui/SettingsStyle.ui');
-            let pageStyle = this._builder.get_object('style');
-            window.add(pageStyle);
-
-            this._builder.add_from_file(Me.path + '/ui/SettingsBehavior.ui');
-            let pageBehavior = this._builder.get_object('behavior');
-            window.add(pageBehavior);
-
-            this._builder.add_from_file(Me.path + '/ui/SettingsAction.ui');
-            let pageAction = this._builder.get_object('action');
-            window.add(pageAction);
-
-            this._builder.add_from_file(Me.path + '/ui/SettingsFineTune.ui');
-            let pageFineTune = this._builder.get_object('finetune');
-            window.add(pageFineTune);
-
-            this._builder.add_from_file(Me.path + '/ui/SettingsAbout.ui');
-            let pageAbout = this._builder.get_object('about');
-            window.add(pageAbout);
-
-            let listbox = this._builder.get_object('taskbar_display_listbox');
-            let provider = new Gtk.CssProvider();
-            provider.load_from_data('list { background-color: transparent; }');
-            let context = listbox.get_style_context();
-            context.add_provider(provider, Gtk.STYLE_PROVIDER_PRIORITY_APPLICATION);
-
-            // set the window as notebook, it is being used as parent for dialogs
-            this.notebook = window;
-
-        } else {
-            this._builder.add_from_file(Me.path + '/Settings.ui');
-            this.notebook = this._builder.get_object('settings_notebook');
-        }
+        window.set_search_enabled(true);
+
+        // dialogs
+        this._builder.add_from_file(Me.path + '/ui/BoxAnimateAppIconHoverOptions.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxDotOptions.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxShowDesktopOptions.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxDynamicOpacityOptions.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxIntellihideOptions.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxShowApplicationsOptions.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxWindowPreviewOptions.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxGroupAppsOptions.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxMiddleClickOptions.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxOverlayShortcut.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxSecondaryMenuOptions.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxScrollPanelOptions.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxScrollIconOptions.ui');
+        this._builder.add_from_file(Me.path + '/ui/BoxAdvancedOptions.ui');
+
+        // pages
+        this._builder.add_from_file(Me.path + '/ui/SettingsPosition.ui');
+        let pagePosition = this._builder.get_object('position');
+        window.add(pagePosition);
+
+        this._builder.add_from_file(Me.path + '/ui/SettingsStyle.ui');
+        let pageStyle = this._builder.get_object('style');
+        window.add(pageStyle);
+
+        this._builder.add_from_file(Me.path + '/ui/SettingsBehavior.ui');
+        let pageBehavior = this._builder.get_object('behavior');
+        window.add(pageBehavior);
+
+        this._builder.add_from_file(Me.path + '/ui/SettingsAction.ui');
+        let pageAction = this._builder.get_object('action');
+        window.add(pageAction);
+
+        this._builder.add_from_file(Me.path + '/ui/SettingsFineTune.ui');
+        let pageFineTune = this._builder.get_object('finetune');
+        window.add(pageFineTune);
+
+        this._builder.add_from_file(Me.path + '/ui/SettingsAbout.ui');
+        let pageAbout = this._builder.get_object('about');
+        window.add(pageAbout);
+
+        let listbox = this._builder.get_object('taskbar_display_listbox');
+        let provider = new Gtk.CssProvider();
+        provider.load_from_data('list { background-color: transparent; }');
+        let context = listbox.get_style_context();
+        context.add_provider(provider, Gtk.STYLE_PROVIDER_PRIORITY_APPLICATION);
+
+        // set the window as notebook, it is being used as parent for dialogs
+        this.notebook = window;
 
         // Timeout to delay the update of the settings
         this._panel_size_timeout = 0;
@@ -251,10 +244,7 @@ const Preferences = class {
         let isVertical = position == Pos.LEFT || position == Pos.RIGHT;
         let showDesktopWidthLabel = this._builder.get_object('show_showdesktop_width_label');
 
-        if(this._window)
-            showDesktopWidthLabel.set_title(isVertical ? _('Show Desktop button height (px)') : _('Show Desktop button width (px)'));
-        else
-            showDesktopWidthLabel.set_text(isVertical ? _('Show Desktop button height (px)') : _('Show Desktop button width (px)'));
+        showDesktopWidthLabel.set_title(isVertical ? _('Show Desktop button height (px)') : _('Show Desktop button width (px)'));
 
         this._displayPanelPositionsForMonitor(this._currentMonitorIndex);
     }
@@ -842,7 +832,7 @@ const Preferences = class {
             });
             this._builder.get_object('dot_color_override_switch').connect('state-set', (widget) => {
                 if (widget.get_active()) this._settings.set_boolean('dot-color-dominant', false);
-                else if (this._window) this._settings.set_boolean('dot-color-unfocused-different', false);
+                else this._settings.set_boolean('dot-color-unfocused-different', false);
             });
 
             this._settings.bind('dot-color-unfocused-different',
@@ -1039,12 +1029,10 @@ const Preferences = class {
                             'sensitive',
                             Gio.SettingsBindFlags.DEFAULT);
 
-        if (this._window) {
-            this._settings.bind('trans-use-custom-opacity',
-                            this._builder.get_object('trans_opacity_box2'),
-                            'sensitive',
-                            Gio.SettingsBindFlags.DEFAULT);
-        }
+        this._settings.bind('trans-use-custom-opacity',
+                        this._builder.get_object('trans_opacity_box2'),
+                        'sensitive',
+                        Gio.SettingsBindFlags.DEFAULT);
 
         this._builder.get_object('trans_opacity_override_switch').connect('notify::active', (widget) => {
             if (!widget.get_active())
@@ -1081,12 +1069,10 @@ const Preferences = class {
                             'sensitive',
                             Gio.SettingsBindFlags.DEFAULT);
 
-        if (this._window) {
-            this._settings.bind('trans-use-custom-gradient',
-                            this._builder.get_object('trans_gradient_box2'),
-                            'sensitive',
-                            Gio.SettingsBindFlags.DEFAULT);
-        }
+        this._settings.bind('trans-use-custom-gradient',
+                        this._builder.get_object('trans_gradient_box2'),
+                        'sensitive',
+                        Gio.SettingsBindFlags.DEFAULT);
 
         rgba.parse(this._settings.get_string('trans-gradient-top-color'));
         this._builder.get_object('trans_gradient_color1_colorbutton').set_rgba(rgba);
@@ -1210,12 +1196,10 @@ const Preferences = class {
                             'sensitive',
                             Gio.SettingsBindFlags.DEFAULT);
 
-        if (this._window) {
-            this._settings.bind('intellihide-use-pressure',
-                            this._builder.get_object('intellihide_use_pressure_options2'),
-                            'sensitive',
-                            Gio.SettingsBindFlags.DEFAULT);
-        }
+        this._settings.bind('intellihide-use-pressure',
+                        this._builder.get_object('intellihide_use_pressure_options2'),
+                        'sensitive',
+                        Gio.SettingsBindFlags.DEFAULT);
 
         this._settings.bind('intellihide-show-in-fullscreen',
                             this._builder.get_object('intellihide_show_in_fullscreen_switch'),
@@ -1325,12 +1309,10 @@ const Preferences = class {
                             'sensitive',
                             Gio.SettingsBindFlags.DEFAULT);
 
-        if(this._window) {
-            this._settings.bind('show-showdesktop-hover',
-                            this._builder.get_object('grid_show_showdesktop_hide_options2'),
-                            'sensitive',
-                            Gio.SettingsBindFlags.DEFAULT);
-        }
+        this._settings.bind('show-showdesktop-hover',
+                        this._builder.get_object('grid_show_showdesktop_hide_options2'),
+                        'sensitive',
+                        Gio.SettingsBindFlags.DEFAULT);
 
         this._settings.bind('show-appmenu',
                             this._builder.get_object('show_appmenu_switch'),
@@ -2360,11 +2342,3 @@ function fillPreferencesWindow(window) {
 
     let preferences = new Preferences(window);
 }
-
-function buildPrefsWidget() {
-    Gtk.Window.list_toplevels()[0].set_default_size(680, 740);
-    
-    let preferences = new Preferences();
-    
-    return preferences.notebook;
-}

From 6215a2f4000b6989d4053d963595588b51d7afdc Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Mon, 18 Apr 2022 23:14:24 +0200
Subject: [PATCH 59/62] Add 'Toggle single / Cycle multiple' option to all
 click methods

---
 ui/BoxMiddleClickOptions.ui | 2 ++
 ui/SettingsAction.ui        | 1 +
 2 files changed, 3 insertions(+)

diff --git a/ui/BoxMiddleClickOptions.ui b/ui/BoxMiddleClickOptions.ui
index 8c76a342..023845e6 100644
--- a/ui/BoxMiddleClickOptions.ui
+++ b/ui/BoxMiddleClickOptions.ui
@@ -56,6 +56,7 @@
                   <item id="CYCLE" translatable="yes">Cycle through windows</item>
                   <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
                   <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
+                  <item id="TOGGLE-CYCLE" translatable="yes">Toggle single / Cycle multiple</item>
                   <item id="QUIT" translatable="yes">Quit</item>
                 </items>
               </object>
@@ -83,6 +84,7 @@
                   <item id="CYCLE" translatable="yes">Cycle through windows</item>
                   <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
                   <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
+                  <item id="TOGGLE-CYCLE" translatable="yes">Toggle single / Cycle multiple</item>
                   <item id="QUIT" translatable="yes">Quit</item>
                 </items>
               </object>
diff --git a/ui/SettingsAction.ui b/ui/SettingsAction.ui
index 790e1185..b22053f1 100644
--- a/ui/SettingsAction.ui
+++ b/ui/SettingsAction.ui
@@ -36,6 +36,7 @@
                   <item id="CYCLE-MIN" translatable="yes">Cycle windows + minimize</item>
                   <item id="CYCLE" translatable="yes">Cycle through windows</item>
                   <item id="TOGGLE-SHOWPREVIEW" translatable="yes">Toggle single / Preview multiple</item>
+                  <item id="TOGGLE-CYCLE" translatable="yes">Toggle single / Cycle multiple</item>
                   <item id="MINIMIZE" translatable="yes">Toggle windows</item>
                   <item id="RAISE" translatable="yes">Raise windows</item>
                   <item id="LAUNCH" translatable="yes">Launch new instance</item>

From dbce12a35956187d7a241025428c70eacc23b414 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Mon, 18 Apr 2022 23:18:21 +0200
Subject: [PATCH 60/62] Toggle for notification counter badge

---
 ui/SettingsBehavior.ui | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/ui/SettingsBehavior.ui b/ui/SettingsBehavior.ui
index d363ffae..18db9436 100644
--- a/ui/SettingsBehavior.ui
+++ b/ui/SettingsBehavior.ui
@@ -80,6 +80,19 @@
           </object>
         </child>
 
+        <child>
+          <object class="AdwActionRow">
+            <property name="title" translatable="yes">Show notification counter badge</property>
+            <child>
+              <object class="GtkSwitch" id="show_notification_badge_switch">
+                <property name="visible">True</property>
+                <property name="halign">end</property>
+                <property name="valign">center</property>
+              </object>
+            </child>
+          </object>
+        </child>
+
       </object>
     </child>
 

From d4a0ec1bfae38c87db6dd25466abc79b1871d887 Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Mon, 18 Apr 2022 23:25:55 +0200
Subject: [PATCH 61/62] remove version check in _createPreferencesDialog

---
 prefs.js | 53 +++++++++++++++++++++++++----------------------------
 1 file changed, 25 insertions(+), 28 deletions(-)

diff --git a/prefs.js b/prefs.js
index 5525fc07..e7c02e06 100644
--- a/prefs.js
+++ b/prefs.js
@@ -486,34 +486,31 @@ const Preferences = class {
     _createPreferencesDialog(title, content, reset_function = null) {
         let dialog;
         
-        if (true) { // Config.PACKAGE_VERSION < '42') {
-            dialog = new Gtk.Dialog({ title: title,
-                                        transient_for: this.notebook.get_root(),
-                                        use_header_bar: true,
-                                        modal: true });
-
-            // GTK+ leaves positive values for application-defined response ids.
-            // Use +1 for the reset action
-            if (reset_function != null)
-                dialog.add_button(_('Reset to defaults'), 1);
-
-            dialog.get_content_area().append(content);
-    
-            dialog.connect('response', (dialog, id) => {
-                if (id == 1) {
-                    // restore default settings
-                    if (reset_function)
-                      reset_function();
-                } else {
-                    // remove the settings content so it doesn't get destroyed;
-                    dialog.get_content_area().remove(content);
-                    dialog.destroy();
-                }
-                return;
-            });
-        } else {
-            dialog = new Adw.PreferencesWindow({ title: title });
-        }
+        dialog = new Gtk.Dialog({ title: title,
+                                    transient_for: this.notebook.get_root(),
+                                    use_header_bar: true,
+                                    modal: true });
+
+        // GTK+ leaves positive values for application-defined response ids.
+        // Use +1 for the reset action
+        if (reset_function != null)
+            dialog.add_button(_('Reset to defaults'), 1);
+
+        dialog.get_content_area().append(content);
+
+        dialog.connect('response', (dialog, id) => {
+            if (id == 1) {
+                // restore default settings
+                if (reset_function)
+                    reset_function();
+            } else {
+                // remove the settings content so it doesn't get destroyed;
+                dialog.get_content_area().remove(content);
+                dialog.destroy();
+            }
+            return;
+        });
+
         return dialog;
     }
 

From 212ca617521da1d217607efba2290a5cbf9ae05f Mon Sep 17 00:00:00 2001
From: Philipp Unger <philipp.unger.1988@gmail.com>
Date: Thu, 28 Apr 2022 23:28:19 +0200
Subject: [PATCH 62/62] add new ui files to Makefile

---
 Makefile | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/Makefile b/Makefile
index 0081302b..e1c23e12 100644
--- a/Makefile
+++ b/Makefile
@@ -3,6 +3,8 @@
 UUID = dash-to-panel@jderose9.github.com
 BASE_MODULES = extension.js stylesheet.css metadata.json COPYING README.md
 EXTRA_MODULES = appIcons.js panel.js panelManager.js proximity.js intellihide.js progress.js panelPositions.js panelSettings.js panelStyle.js overview.js taskbar.js transparency.js windowPreview.js prefs.js utils.js Settings.ui desktopIconsIntegration.js
+UI_MODULES = ui/BoxAdvancedOptions.ui ui/BoxAnimateAppIconHoverOptions.ui ui/BoxDotOptions.ui ui/BoxDynamicOpacityOptions.ui ui/BoxGroupAppsOptions.ui ui/BoxIntellihideOptions.ui ui/BoxMiddleClickOptions.ui ui/BoxOverlayShortcut.ui ui/BoxScrollIconOptions.ui ui/BoxScrollPanelOptions.ui ui/BoxSecondaryMenuOptions.ui ui/BoxShowApplicationsOptions.ui ui/BoxShowDesktopOptions.ui ui/BoxWindowPreviewOptions.ui ui/SettingsAbout.ui ui/SettingsAction.ui ui/SettingsBehavior.ui ui/SettingsFineTune.ui ui/SettingsPosition.ui ui/SettingsStyle.ui
+
 EXTRA_IMAGES = highlight_stacked_bg.svg highlight_stacked_bg_2.svg highlight_stacked_bg_3.svg
 
 TOLOCALIZE =  prefs.js appIcons.js
@@ -77,6 +79,8 @@ _build: all
 	-rm -fR ./_build
 	mkdir -p _build
 	cp $(BASE_MODULES) $(EXTRA_MODULES) _build
+	mkdir -p _build/ui
+	cp $(UI_MODULES) _build/ui
 
 	mkdir -p _build/img
 	cd img ; cp $(EXTRA_IMAGES) ../_build/img/
